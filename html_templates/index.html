<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!--
    BASE64 content generated with:
      base64 -i logo/BeetPx\ logo\ \(x5\).png
    -->
    <link
      rel="icon"
      type="image/png"
      sizes="80x80"
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs4c6QAAAVdJREFUeJzt3MFNw0AQQFFAdMCRymiCrjlSQyiAPVh5o7Uh/x2jCIevlQd7Y55vnx+3pwfy9vX7te/3+9/34h/psRUQFRAVEL2uXlydQP8z+X1bgaiAqICogKiAqICogKiAqIBoeSXyF61uNR3VlciJCogKiAqItgyR6RP80T2M6c+y0gpEBUQFRAVE40Pk6gNj+hitQFRAVEBUQERDZPqveiGDQLQCUQFRAVEB0eEhsmNgHD2GXGGstCdyogKiAqICosNDZMctpOnPMn3clVYgKiAqICogGt8T2TEw5NZVeyIXU0BUQFRAtOXbWdN7E2dd2ay0AlEBUQFRAdGWPZHpfzWyet9ZT9m3AlEBUQFRAdFpDxtO31Y6SysQFRAVEBUQ0RCRE/yOZzh2aAWiAqICogKi8W9nTf+8Kw2MlVYgKiAqICogWg6RKz1EeHWtQFRAVEBUQPQDHRdHQWx83G0AAAAASUVORK5CYII="
    />

    <!-- TODO: Allow a game title injection as build script params -->
    <title>BeetPx game</title>

    <!--
    Keep styles embedded in HTML here, because external CSS file is loaded by Vite in a way which can make GUI flicker.
    -->
    <style>
      :root {
        /* TODO: re-implement loading, again */
        /* TODO: use another color */
        --loading-bg-color: #ff00ff;

        --gui-bg-color: #5f574f;
      }

      * {
        margin: 0;
        box-sizing: border-box;
        image-rendering: pixelated;
      }

      html {
        width: 100vw;
        height: 100vh;
      }

      body {
        width: 100vw;
        height: 100vh;
        overflow: hidden;

        background-color: var(--gui-bg-color);
      }

      * {
        /*
        This prevents panning on touch-drag:
          https://developer.mozilla.org/en-US/docs/Web/API/Pointer_events#touch-action_css_property
        */
        touch-action: none;
      }

      #unsupported_aspect_ratio {
        position: absolute;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;

        padding: 0.2em;

        color: #c2c3c7;
        font-size: 24px;
      }

      #game_display {
        width: 100vw;
        height: 100vh;

        /*
        We need this bg color to be set on the element which is zoomed in when in a full
          screen and we cannot do this for the entire <body>, because Safari ignores
          body's bg color on full screen, and includes only the zoomed in element.
        */
        background-color: var(--gui-bg-color);

        border-color: #c2c3c7;
        border-style: solid;
        border-width: 0;

        gap: 0 0;
      }

      #game_canvas {
        /*  for debug border, to not affect canvas' size */
        box-sizing: content-box;

        width: 100%;
        height: 100%;
      }

      .debug #game_canvas {
        border: 1px solid red;
        margin: -1px;
      }

      #game_canvas {
        grid-area: canv;
      }

      .gui_sprite {
        background-image: url(.beetpx/gui.png);
      }

      #dpad_up {
        grid-area: dp_u;
      }

      #dpad_down {
        grid-area: dp_d;
      }

      #dpad_left {
        grid-area: dp_l;
      }

      #dpad_right {
        grid-area: dp_r;
      }

      #dpad_center {
        grid-area: dp_c;
      }

      #button_a {
        grid-area: btn_a;
      }

      #button_b {
        grid-area: btn_b;
      }

      #button_menu {
        grid-area: menu;
      }

      #button_mute {
        grid-area: mute;
      }

      #button_fullscreen {
        grid-area: fs;
      }

      /*
       * LAYOUT for a SUPER THIN screen
       */

      #unsupported_aspect_ratio {
        display: block;

        margin: 0;
        text-align: center;
        line-height: 1em;
        overflow-wrap: break-word;
      }

      #game_display {
        display: none;
      }

      /*
       * LAYOUT for a REALLY VERTICAL screen
       */
      @media (min-aspect-ratio: 310/600) {
        #unsupported_aspect_ratio {
          display: none;
        }

        #game_display {
          display: grid;

          border-width: 1vw;
          border-bottom-width: 2vw;

          grid-template-areas:
            "canv canv canv canv canv canv canv canv   canv  canv  canv  canv canv"
            "   .    .    .    .    .    .    .    .      .     .     .     .    ."
            "   .    . dp_u    .    . menu menu    .      .     . btn_b btn_b    ."
            "   . dp_l dp_c dp_r    .    .    .    .      .     . btn_b btn_b    ."
            "   . dp_l dp_c dp_r    . mute    .    .      .     . btn_b btn_b    ."
            "   .    . dp_d   .     . mute    .    .  btn_a btn_a     .     .    ."
            "   .    . dp_d   .     .    .    .    .  btn_a btn_a     .     .    ."
            "   .    .    .   .     .   fs    .    .  btn_a btn_a     .     .    ."
            "   .    .    .   .     .    .    .    .      .     .     .     .    .";
          grid-template-columns:
            4vw
            8vw
            8vw
            8vw
            13vw
            8vw
            8vw
            5vw
            8vw
            8vw
            8vw
            8vw
            4vw;
          grid-template-rows:
            98vw
            1fr
            8vw
            4vw
            4vw
            4vw
            4vw
            8vw
            1fr;
        }

        .gui_sprite {
          background-size: 80vw;
        }

        #dpad_up {
          background-position: -8vw 0;
        }

        #dpad_down {
          background-position: -8vw -16vw;
        }

        #dpad_left {
          background-position: 0 -8vw;
        }

        #dpad_right {
          background-position: -16vw -8vw;
        }

        #dpad_center {
          background-position: -8vw -8vw;
        }

        #button_a {
          background-position: -32vw 0;
        }

        #button_b {
          background-position: -56vw 0;
        }

        #button_menu {
          background-position: -24vw -24vw;
        }

        #button_mute {
          background-position: -48vw -24vw;
        }

        #button_fullscreen {
          background-position: -64vw -24vw;
        }
      }

      /*
       * LAYOUT for a SLIGHTLY VERTICAL screen
       */
      @media (min-aspect-ratio: 310/450) {
        #unsupported_aspect_ratio {
          display: none;
        }

        #game_display {
          display: grid;

          border-width: 1vw;
          border-bottom-width: 2vw;

          grid-template-areas:
            "canv canv canv canv canv canv canv canv  canv  canv  canv  canv canv"
            "   .    .    .    .    .    .    .    .     .     .     .     .    ."
            "   .    . dp_u    .    . mute    . menu     .     . btn_b btn_b    ."
            "   . dp_l dp_c dp_r    .    .    .    . btn_a btn_a btn_b btn_b    ."
            "   .    . dp_d   .     .   fs    .    . btn_a btn_a     .     .    ."
            "   .    .    .   .     .    .    .    .     .     .     .     .    .";
          grid-template-columns:
            2vw
            8vw
            8vw
            8vw
            8vw
            8vw
            6vw
            16vw
            8vw
            8vw
            8vw
            8vw
            2vw;
          grid-template-rows:
            98vw
            2vw
            8vw
            8vw
            8vw
            1fr;
        }

        .gui_sprite {
          background-size: 80vw;
        }

        #dpad_up {
          background-position: -8vw 0;
        }

        #dpad_down {
          background-position: -8vw -16vw;
        }

        #dpad_left {
          background-position: 0 -8vw;
        }

        #dpad_right {
          background-position: -16vw -8vw;
        }

        #dpad_center {
          background-position: -8vw -8vw;
        }

        #button_a {
          background-position: -32vw 0;
        }

        #button_b {
          background-position: -56vw 0;
        }

        #button_menu {
          background-position: -24vw -24vw;
        }

        #button_mute {
          background-position: -48vw -24vw;
        }

        #button_fullscreen {
          background-position: -64vw -24vw;
        }
      }

      /*
       * LAYOUT for a TALLER SQUARE screen
       */
      @media (min-aspect-ratio: 310/400) {
        #unsupported_aspect_ratio {
          display: none;
        }

        #game_display {
          display: grid;

          border-width: 1vh;
          border-bottom-width: 2vh;

          grid-template-areas:
            ". canv canv canv canv canv canv canv canv  canv  canv  canv  canv canv ."
            ".    .    .    .    .    .    .    .    .     .     .     .     .    . ."
            ".    .    . dp_u    .    . mute    . menu     .     . btn_b btn_b    . ."
            ".    . dp_l dp_c dp_r    .    .    .    . btn_a btn_a btn_b btn_b    . ."
            ".    .    . dp_d   .     .   fs    .    . btn_a btn_a     .     .    . ."
            ".    .    .    .   .     .    .    .    .     .     .     .     .    . .";
          grid-template-columns:
            1fr
            2vh
            6vh
            6vh
            6vh
            6vh
            6vh
            5vh
            12vh
            6vh
            6vh
            6vh
            6vh
            2vh
            1fr;
          grid-template-rows:
            75vh
            2vh
            6vh
            6vh
            6vh
            1fr;
        }

        .gui_sprite {
          background-size: 60vh;
        }

        #dpad_up {
          background-position: -6vh 0;
        }

        #dpad_down {
          background-position: -6vh -12vh;
        }

        #dpad_left {
          background-position: 0 -6vh;
        }

        #dpad_right {
          background-position: -12vh -6vh;
        }

        #dpad_center {
          background-position: -6vh -6vh;
        }

        #button_a {
          background-position: -24vh 0;
        }

        #button_b {
          background-position: -42vh 0;
        }

        #button_menu {
          background-position: -18vh -18vh;
        }

        #button_mute {
          background-position: -36vh -18vh;
        }

        #button_fullscreen {
          background-position: -48vh -18vh;
        }
      }

      /*
       * LAYOUT for a KINDA SQUARE screen
       */
      @media (min-aspect-ratio: 310/310) {
        #unsupported_aspect_ratio {
          display: none;
        }

        #game_display {
          display: grid;

          border-width: 1vh;
          border-bottom-width: 2vh;

          grid-template-areas:
            ".    .    . canv canv canv canv  canv  canv  canv     .     . ."
            ".   fs    . canv canv canv canv  canv  canv  canv     .     . ."
            ".    .    . canv canv canv canv  canv  canv  canv     .     . ."
            ". mute    . canv canv canv canv  canv  canv  canv     .     . ."
            ".    .    . canv canv canv canv  canv  canv  canv     .     . ."
            ".    .    .    .    .    .    .     .     .     .     .     . ."
            ".    . dp_u dp_u    .    . menu  menu     . btn_b btn_b btn_b ."
            ". dp_l dp_c dp_c dp_r    .    . btn_a btn_a btn_b btn_b btn_b ."
            ".    . dp_d dp_d   .     .    . btn_a btn_a     .     .     . ."
            ".    .    .    .   .     .    .     .     .     .     .     . .";
          grid-template-columns:
            1fr
            7vh
            2vh
            5vh
            7vh
            31vh
            11vh
            3vh
            11vh
            5vh
            2vh
            7vh
            1fr;
          grid-template-rows:
            4vh
            7vh
            7vh
            7vh
            48vh
            2vh
            7vh
            7vh
            7vh
            1fr;
        }

        .gui_sprite {
          background-size: 70vh;
        }

        #dpad_up {
          background-position: -7vh 0;
        }

        #dpad_down {
          background-position: -7vh -14vh;
        }

        #dpad_left {
          background-position: 0 -7vh;
        }

        #dpad_right {
          background-position: -14vh -7vh;
        }

        #dpad_center {
          background-position: -7vh -7vh;
        }

        #button_a {
          background-position: -28vh 0;
        }

        #button_b {
          background-position: -49vh 0;
        }

        #button_menu {
          background-position: -21vh -21vh;
        }

        #button_mute {
          background-position: -42vh -21vh;
        }

        #button_fullscreen {
          background-position: -56vh -21vh;
        }
      }

      /*
       * LAYOUT for a WIDER SQUARE screen
       */
      @media (min-aspect-ratio: 310/250) {
        #unsupported_aspect_ratio {
          display: none;
        }

        #game_display {
          display: grid;

          border-width: 1vh;
          border-bottom-width: 2vh;

          grid-template-areas:
            ".    .    .    . canv canv  canv     .     .     . ."
            ".    .   fs    . canv canv  canv     .     .     . ."
            ".    .    .    . canv canv  canv     .  menu  menu ."
            ".    . mute    . canv canv  canv     .     .     . ."
            ".    .    .    . canv canv  canv     .     .     . ."
            ".    .    .    . canv canv  canv     . btn_b btn_b ."
            ".    . dp_u    . canv canv  canv     . btn_b btn_b ."
            ".    . dp_u    .    .    .     .     . btn_b btn_b ."
            ". dp_l dp_c dp_r dp_r    . btn_a btn_a btn_a     . ."
            ".    . dp_d    .   .     . btn_a btn_a btn_a     . ."
            ".    .    .    .   .     .     .     .     .     . .";
          grid-template-columns:
            1fr
            10vh
            10vh
            2vh
            8vh
            58vh
            8vh
            2vh
            10vh
            10vh
            1fr;
          grid-template-rows:
            4vh
            10vh
            10vh
            10vh
            22vh
            10vh
            8vh
            2vh
            10vh
            10vh
            1fr;
        }

        .gui_sprite {
          background-size: 100vh;
        }

        #dpad_up {
          background-position: -10vh 0;
        }

        #dpad_down {
          background-position: -10vh -20vh;
        }

        #dpad_left {
          background-position: 0 -10vh;
        }

        #dpad_right {
          background-position: -20vh -10vh;
        }

        #dpad_center {
          background-position: -10vh -10vh;
        }

        #button_a {
          background-position: -40vh 0;
        }

        #button_b {
          background-position: -70vh 0;
        }

        #button_menu {
          background-position: -30vh -30vh;
        }

        #button_mute {
          background-position: -60vh -30vh;
        }

        #button_fullscreen {
          background-position: -80vh -30vh;
        }
      }

      /*
       * LAYOUT for a SLIGHTLY HORIZONTAL screen
       */
      @media (min-aspect-ratio: 480/250) {
        #unsupported_aspect_ratio {
          display: none;
        }

        #game_display {
          display: grid;

          border-width: 1vh;
          border-bottom-width: 2vh;

          grid-template-areas:
            ".    .    .    . . . canv .      .     .     .     . ."
            ". mute    .   fs . . canv .      .     .  menu  menu ."
            ".    .    .    . . . canv .      .     .     .     . ."
            ".    .    .    . . . canv .      .     . btn_b btn_b ."
            ".    . dp_u    . . . canv .      .     . btn_b btn_b ."
            ". dp_l dp_c dp_r . . canv . btn_a btn_a      .     . ."
            ".    . dp_d    . . . canv . btn_a btn_a      .     . ."
            ".    .    .    . . . canv .     .     .      .     . .";
          grid-template-columns:
            1fr
            10vh
            10vh
            10vh
            10vh
            1fr
            97vh
            1fr
            10vh
            10vh
            10vh
            10vh
            1fr;
          grid-template-rows:
            10vh
            10vh
            1fr
            10vh
            10vh
            10vh
            10vh
            15vh;
        }

        .gui_sprite {
          background-size: 100vh;
        }

        #dpad_up {
          background-position: -10vh 0;
        }

        #dpad_down {
          background-position: -10vh -20vh;
        }

        #dpad_left {
          background-position: 0 -10vh;
        }

        #dpad_right {
          background-position: -20vh -10vh;
        }

        #dpad_center {
          background-position: -10vh -10vh;
        }

        #button_a {
          background-position: -40vh 0;
        }

        #button_b {
          background-position: -70vh 0;
        }

        #button_menu {
          background-position: -30vh -30vh;
        }

        #button_mute {
          background-position: -60vh -30vh;
        }

        #button_fullscreen {
          background-position: -80vh -30vh;
        }
      }

      /*
       * LAYOUT for a REALLY HORIZONTAL screen
       */
      @media (min-aspect-ratio: 610/250) {
        #unsupported_aspect_ratio {
          display: none;
        }

        #game_display {
          display: grid;

          border-width: 1vh;
          border-bottom-width: 2vh;

          grid-template-areas:
            ".    .    .    . . . canv .      .     .     .     . ."
            ". mute    .   fs . . canv .      .     .  menu  menu ."
            ".    .    .    . . . canv .      .     .     .     . ."
            ".    .    .    . . . canv .      .     . btn_b btn_b ."
            ".    . dp_u    . . . canv .      .     . btn_b btn_b ."
            ". dp_l dp_c dp_r . . canv . btn_a btn_a      .     . ."
            ".    . dp_d    . . . canv . btn_a btn_a      .     . ."
            ".    .    .    . . . canv .     .     .      .     . .";
          grid-template-columns:
            15vh
            10vh
            10vh
            10vh
            10vh
            1fr
            97vh
            1fr
            10vh
            10vh
            10vh
            10vh
            15vh;
          grid-template-rows:
            10vh
            10vh
            1fr
            10vh
            10vh
            10vh
            10vh
            15vh;
        }

        .gui_sprite {
          background-size: 100vh;
        }

        #dpad_up {
          background-position: -10vh 0;
        }

        #dpad_down {
          background-position: -10vh -20vh;
        }

        #dpad_left {
          background-position: 0 -10vh;
        }

        #dpad_right {
          background-position: -20vh -10vh;
        }

        #dpad_center {
          background-position: -10vh -10vh;
        }

        #button_a {
          background-position: -40vh 0;
        }

        #button_b {
          background-position: -70vh 0;
        }

        #button_menu {
          background-position: -30vh -30vh;
        }

        #button_mute {
          background-position: -60vh -30vh;
        }

        #button_fullscreen {
          background-position: -80vh -30vh;
        }
      }
    </style>
  </head>
  <body>
    <div id="unsupported_aspect_ratio">unsupported aspect ratio</div>
    <main id="game_display">
      <canvas id="game_canvas" width="256" height="256"></canvas>
      <div id="dpad_up" class="gui_sprite"></div>
      <div id="dpad_down" class="gui_sprite"></div>
      <div id="dpad_left" class="gui_sprite"></div>
      <div id="dpad_right" class="gui_sprite"></div>
      <div id="dpad_center" class="gui_sprite"></div>
      <div id="button_a" class="gui_sprite"></div>
      <div id="button_b" class="gui_sprite"></div>
      <div id="button_menu" class="gui_sprite"></div>
      <div id="button_mute" class="gui_sprite"></div>
      <div id="button_fullscreen" class="gui_sprite"></div>
    </main>
  </body>

  <script type="module" src="src/beetpx_entrypoint.ts"></script>
</html>
