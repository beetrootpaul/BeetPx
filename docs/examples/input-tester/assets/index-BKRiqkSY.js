var Eu=Object.defineProperty;var Cu=(i,e,t)=>e in i?Eu(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var b=(i,e,t)=>(Cu(i,typeof e!="symbol"?e+"":e,t),t),Fr=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)};var a=(i,e,t)=>(Fr(i,e,"read from private field"),t?t.call(i):e.get(i)),d=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},_=(i,e,t,s)=>(Fr(i,e,"write to private field"),s?s.call(i,t):e.set(i,t),t);var u=(i,e,t)=>(Fr(i,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();class tt{constructor(e,t,s){b(this,"type","rgb");b(this,"r");b(this,"g");b(this,"b");b(this,"cssHex");this.r=Math.min(Math.max(0,Math.round(e)),255),this.g=Math.min(Math.max(0,Math.round(t)),255),this.b=Math.min(Math.max(0,Math.round(s)),255),this.cssHex="#"+e.toString(16).padStart(2,"0")+t.toString(16).padStart(2,"0")+s.toString(16).padStart(2,"0")}static of(e,t,s){return new tt(e,t,s)}static fromCssHex(e){if(!/^#[0-9a-fA-F]{6}$/.test(e))throw Error("Hexadecimal representation of the color doesn't contain exactly 6 hexadecimal digits, preceded by a single '#'");return new tt(parseInt(e.slice(1,3),16),parseInt(e.slice(3,5),16),parseInt(e.slice(5,7),16))}isSameAs(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}asArray(){return[this.r,this.g,this.b]}}class at{}b(at,"black",tt.fromCssHex("#000000")),b(at,"storm",tt.fromCssHex("#1D2B53")),b(at,"wine",tt.fromCssHex("#7E2553")),b(at,"moss",tt.fromCssHex("#008751")),b(at,"tan",tt.fromCssHex("#AB5236")),b(at,"slate",tt.fromCssHex("#5F574F")),b(at,"silver",tt.fromCssHex("#C2C3C7")),b(at,"white",tt.fromCssHex("#FFF1E8")),b(at,"ember",tt.fromCssHex("#FF004D")),b(at,"orange",tt.fromCssHex("#FFA300")),b(at,"lemon",tt.fromCssHex("#FFEC27")),b(at,"lime",tt.fromCssHex("#00E436")),b(at,"sky",tt.fromCssHex("#29ADFF")),b(at,"dusk",tt.fromCssHex("#83769C")),b(at,"pink",tt.fromCssHex("#FF77A8")),b(at,"peach",tt.fromCssHex("#FFCCAA"));var Cn;const cs=class cs{constructor(e){b(this,"type","sprite_mapping");d(this,Cn,void 0);_(this,Cn,e)}static from(e){const t=new Map(e.map(([s,n])=>[s.cssHex,n]));return new cs((s,n,r)=>{if(!s)return s;const o=t.get(s.cssHex);return typeof o>"u"?s:o})}static of(e){return new cs(e)}getMappedColor(e,t,s){return a(this,Cn).call(this,e,t,s)}};Cn=new WeakMap,b(cs,"noMapping",new cs((e,t,s)=>e));let Qe=cs;var Tn;const Oe=class Oe{constructor(e){d(this,Tn,void 0);if(e<0||e>65535)throw Error("BpxPatter: bits representation of the pattern is out of range of valid values. The value should be in range of 0b0000_0000_0000_0000 to 0b1111_1111_1111_1111.");_(this,Tn,e)}static from(e){e=e.replace(/\s/g,"");const t=e.search(/[^#-]/);if(t>=0)throw Error(`BpxPattern.from: Unexpected character found: "${e[t]}"`);if(e.length!==16)throw Error(`BpxPattern.from: Unexpected amount of # and - symbols. There should be 16 of them (4 rows x 4 columns), but instead there is: ${e.length}`);let s=0;for(let n=0;n<16;++n)e[n]==="#"&&(s|=1<<15-n);return new Oe(s)}static of(e){return new Oe(e)}hasPrimaryColorAt(e,t){const s=e%4,n=t%4,r=4*4-(n*4+s)-1;return!!(a(this,Tn)&1<<r)}};Tn=new WeakMap,b(Oe,"primaryOnly",Oe.of(65535)),b(Oe,"secondaryOnly",Oe.of(0));let Qr=Oe;function Ks(i,e,t){return i<e?e<t?e:i<t?t:i:e>t?e:i>t?t:i}function Vr(i,e,t,s){const n=i+(e-i)*t;return s!=null&&s.clamp?Ks(i,n,e):n}function yi(i,e){return e===0?0:(i%e+e)%e}function lh(i,e){return(Math.atan2(e,i)/Math.PI/2+1)%1}function oh(i){return Math.cos(i*Math.PI*2)}function hh(i){return Math.sin(i*Math.PI*2)}class U{constructor(e,t){this.x=e,this.y=t}static unitFromAngle(e){return new U(oh(e),hh(e))}static of(e,t){return new U(e,t??e)}static min(e,t){return new U(Math.min(e.x,t.x),Math.min(e.y,t.y))}static max(e,t){return new U(Math.max(e.x,t.x),Math.max(e.y,t.y))}static minMax(e,t){return[U.min(e,t),U.max(e,t)]}static lerp(e,t,s,n){return new U(Vr(e.x,t.x,s,n),Vr(e.y,t.y,s,n))}asArray(){return[this.x,this.y]}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const e=this.magnitude();return new U(this.x/e,this.y/e)}sign(){return new U(Math.sign(this.x),Math.sign(this.y))}abs(){return new U(Math.abs(this.x),Math.abs(this.y))}floor(){return new U(Math.floor(this.x),Math.floor(this.y))}ceil(){return new U(Math.ceil(this.x),Math.ceil(this.y))}round(){return new U(Math.round(this.x),Math.round(this.y))}toAngle(){return lh(this.x,this.y)}eq(e){return typeof e!="number"?this.x===e.x&&this.y===e.y:this.x===e&&this.y===e}gt(e){return typeof e!="number"?this.x>e.x&&this.y>e.y:this.x>e&&this.y>e}gte(e){return typeof e!="number"?this.x>=e.x&&this.y>=e.y:this.x>=e&&this.y>=e}lt(e){return typeof e!="number"?this.x<e.x&&this.y<e.y:this.x<e&&this.y<e}lte(e){return typeof e!="number"?this.x<=e.x&&this.y<=e.y:this.x<=e&&this.y<=e}clamp(e,t){return new U(Ks(e.x,this.x,t.x),Ks(e.y,this.y,t.y))}mod(e,t){return typeof e!="number"?new U(yi(this.x,e.x),yi(this.y,e.y)):new U(yi(this.x,e),yi(this.y,t??e))}add(e,t){return typeof e!="number"?new U(this.x+e.x,this.y+e.y):new U(this.x+e,this.y+(t??e))}sub(e,t){return typeof e!="number"?new U(this.x-e.x,this.y-e.y):new U(this.x-e,this.y-(t??e))}mul(e,t){return typeof e!="number"?new U(this.x*e.x,this.y*e.y):new U(this.x*e,this.y*(t??e))}div(e,t){return typeof e!="number"?new U(this.x/e.x,this.y/e.y):new U(this.x/e,this.y/(t??e))}*[Symbol.iterator](){yield this.x,yield this.y}[Symbol.toPrimitive](e){switch(e){case"default":case"string":return`(${this.x},${this.y})`;case"number":return NaN}}get[Symbol.toStringTag](){return"BpxVector2d"}__printDebug(){return`(${this.x},${this.y})`}}class Sr{constructor(e){b(this,"asciiRows");b(this,"size");this.asciiRows=e.split(`
`).map(s=>s.replace(/\s/g,"")).filter(s=>s.length>0);let t=0;for(const s of this.asciiRows){const n=s.search(/[^#-]/);if(n>=0)throw Error(`DrawPixels.draw: Unexpected character found: "${s[n]}"`);t=Math.max(t,s.length)}this.size=U.of(t,this.asciiRows.length)}static from(e){return new Sr(e)}}function Nl(i){throw Error("Somehow reached the unreachable code ¯\\_(ツ)_/¯")}function Bl(i){return i}function tr(i){return Array.from({length:i},(e,t)=>t)}var Rn,bt,Mn;const hi=class hi{constructor(e){d(this,bt,void 0);d(this,Mn,void 0);_(this,bt,e),_(this,Mn,[...new Set(Array.from(e.glyphs.values()).filter(t=>t.type==="sprite").map(t=>t.sprite.imageUrl))])}static of(e){return new hi({ascent:e.ascent??8,descent:e.descent??8,lineGap:e.lineGap??1,mapGrapheme:e.mapGrapheme??Bl,glyphs:e.glyphs??new Map})}static basedOn(e,t){const s=t(a(e,bt));return new hi(s)}get spriteSheetUrls(){return a(this,Mn)}get ascent(){return a(this,bt).ascent}get descent(){return a(this,bt).descent}get lineGap(){return a(this,bt).lineGap}arrangeGlyphsFor(e,t,s){var l;s??(s={});const n=[];let r=U.of(0,0),o=0,h=`
`;const c=a(hi,Rn).segment(e)[Symbol.iterator]();for(let f=c.next();!f.done;f=c.next()){const m=a(this,bt).mapGrapheme(f.value.segment),g=f.value.index;if(m===`
`){n.push({type:"line_break",lineNumber:o}),h=`
`,r=U.of(0,r.y+a(this,bt).ascent+a(this,bt).descent+a(this,bt).lineGap),o+=1;continue}if(m==="["){let D;for(const[R,I]of Object.entries(s)){const B=`[${R}]`;if(e.slice(g,g+B.length)===B){D=I;const x=[...a(hi,Rn).segment(B)].length-1;tr(x).forEach(()=>{c.next()});break}}if(D){t=D;continue}}const p=a(this,bt).glyphs.get(m);if(!p)continue;const y=((l=p.kerning)==null?void 0:l[h])??0,N=t;if(p.type==="sprite"){n.push({type:"sprite",char:m,sprite:p.sprite,spriteColorMapping:Qe.of(D=>p.isTextColor(D)?N:null),lineNumber:o,leftTop:r.add(0,a(this,bt).ascent).sub(0,p.sprite.size.y).add(p.offset??U.of(0,0)).add(y,0)}),h=m,r=r.add(p.advance+y,0);continue}if(p.type==="pixels"){n.push({type:"pixels",char:m,pixels:p.pixels,color:N,lineNumber:o,leftTop:r.add(0,this.ascent).sub(0,p.pixels.size.y).add(p.offset??U.of(0,0)).add(y,0)}),h=m,r=r.add(p.advance+y,0);continue}if(p.type==="whitespace"){h=m,r=r.add(p.advance+y,0);continue}Nl()}return n}};Rn=new WeakMap,bt=new WeakMap,Mn=new WeakMap,d(hi,Rn,new Intl.Segmenter("en",{granularity:"grapheme",localeMatcher:"best fit"}));let ln=hi;class _n{constructor(e,t,s,n,r){b(this,"type","static");b(this,"imageUrl");b(this,"size");b(this,"xy");t<0&&(t=-t,n-=t),s<0&&(s=-s,r-=s),this.imageUrl=e,this.xy=U.of(n,r).round(),this.size=U.of(n+t,r+s).round().sub(this.xy)}static from(e,t,s,n,r){return new _n(e,t,s,n,r)}clipBy(e,t){const s=this.xy.clamp(e,t),n=this.xy.add(this.size).clamp(e,t).sub(s);return new _n(this.imageUrl,n.x,n.y,s.x,s.y)}}var S,E;const rr=class rr{constructor(){d(this,S);b(this,"ascent",5);b(this,"descent",0);b(this,"lineGap",1);b(this,"glyphs",new Map([[" ",{type:"whitespace",advance:4}],["0",u(this,S,E).call(this,0,3)],["1",u(this,S,E).call(this,1,3)],["2",u(this,S,E).call(this,2,3)],["3",u(this,S,E).call(this,3,3)],["4",u(this,S,E).call(this,4,3)],["5",u(this,S,E).call(this,5,3)],["6",u(this,S,E).call(this,6,3)],["7",u(this,S,E).call(this,7,3)],["8",u(this,S,E).call(this,8,3)],["9",u(this,S,E).call(this,9,3)],["-",u(this,S,E).call(this,13,2)],["+",u(this,S,E).call(this,11,2)],["=",u(this,S,E).call(this,13,3)],["(",u(this,S,E).call(this,8,2)],[")",u(this,S,E).call(this,9,2)],["[",u(this,S,E).call(this,11,5)],["]",u(this,S,E).call(this,13,5)],["{",u(this,S,E).call(this,11,7)],["}",u(this,S,E).call(this,13,7)],["<",u(this,S,E).call(this,12,3)],[">",u(this,S,E).call(this,14,3)],["~",u(this,S,E).call(this,14,7)],["!",u(this,S,E).call(this,1,2)],["?",u(this,S,E).call(this,15,3)],["@",u(this,S,E).call(this,0,4)],["#",u(this,S,E).call(this,3,2)],["$",u(this,S,E).call(this,4,2)],["%",u(this,S,E).call(this,5,2)],["^",u(this,S,E).call(this,14,5)],["&",u(this,S,E).call(this,6,2)],["*",u(this,S,E).call(this,10,2)],["_",u(this,S,E).call(this,15,5)],[".",u(this,S,E).call(this,14,2)],[",",u(this,S,E).call(this,12,2)],[":",u(this,S,E).call(this,10,3)],[";",u(this,S,E).call(this,11,3)],["`",u(this,S,E).call(this,0,6)],["'",u(this,S,E).call(this,7,2)],['"',u(this,S,E).call(this,2,2)],["/",u(this,S,E).call(this,15,2)],["|",u(this,S,E).call(this,12,7)],["\\",u(this,S,E).call(this,12,5)],["a",u(this,S,E).call(this,1,6)],["b",u(this,S,E).call(this,2,6)],["c",u(this,S,E).call(this,3,6)],["d",u(this,S,E).call(this,4,6)],["e",u(this,S,E).call(this,5,6)],["f",u(this,S,E).call(this,6,6)],["g",u(this,S,E).call(this,7,6)],["h",u(this,S,E).call(this,8,6)],["i",u(this,S,E).call(this,9,6)],["j",u(this,S,E).call(this,10,6)],["k",u(this,S,E).call(this,11,6)],["l",u(this,S,E).call(this,12,6)],["m",u(this,S,E).call(this,13,6)],["n",u(this,S,E).call(this,14,6)],["o",u(this,S,E).call(this,15,6)],["p",u(this,S,E).call(this,0,7)],["q",u(this,S,E).call(this,1,7)],["r",u(this,S,E).call(this,2,7)],["s",u(this,S,E).call(this,3,7)],["t",u(this,S,E).call(this,4,7)],["u",u(this,S,E).call(this,5,7)],["v",u(this,S,E).call(this,6,7)],["w",u(this,S,E).call(this,7,7)],["x",u(this,S,E).call(this,8,7)],["y",u(this,S,E).call(this,9,7)],["z",u(this,S,E).call(this,10,7)],["⬅",u(this,S,E).call(this,11,8,7)],["➡",u(this,S,E).call(this,1,9,7)],["⬆",u(this,S,E).call(this,4,9,7)],["⬇",u(this,S,E).call(this,3,8,7)],["⭐",u(this,S,E).call(this,2,9,7)],["❤️",u(this,S,E).call(this,7,8,7)],["❎",u(this,S,E).call(this,7,9,7)],["⭕",u(this,S,E).call(this,14,8,7)],["♪",u(this,S,E).call(this,13,8,7)]]))}mapGrapheme(e){return e.toLowerCase()}};S=new WeakSet,E=function(e,t,s=3){const n=_n.from(rr.spriteSheetUrl,s,5,e*8,t*8);return{type:"sprite",sprite:n,isTextColor:r=>(r==null?void 0:r.cssHex)===at.white.cssHex,advance:n.size.x+1}},b(rr,"spriteSheetUrl",".beetpx/pico-8-font.png");let tl=rr;var O,P;class Tu{constructor(){d(this,O);b(this,"ascent",4);b(this,"descent",0);b(this,"lineGap",2);b(this,"glyphs",new Map([[" ",u(this,O,P).call(this,`
        ----
        ----
        ----
        ----
      `)],[".",u(this,O,P).call(this,`
        -
        -
        -
        #
      `)],[":",u(this,O,P).call(this,`
        #
        -
        -
        #
      `)],["!",u(this,O,P).call(this,`
        #
        #
        #
        -
        #
      `)],["?",u(this,O,P).call(this,`
        -#-
        #-#
        --#
        -#-
        -#-
      `)],["'",u(this,O,P).call(this,`
        #
        #
        -
        -
        -
      `)],['"',u(this,O,P).call(this,`
        #-#
        #-#
        ---
        ---
        ---
      `)],["*",u(this,O,P).call(this,`
        #-#
        -#-
        #-#
        ---
      `)],["/",u(this,O,P).call(this,`
        --#
        -#-
        -#-
        #--
      `)],["+",u(this,O,P).call(this,`
        ---
        -#-
        ###
        -#-
      `)],["-",u(this,O,P).call(this,`
        ---
        ---
        ###
        ---
      `)],["0",u(this,O,P).call(this,`
        -#-
        #-#
        #-#
        -#-
      `)],["1",u(this,O,P).call(this,`
        -#-
        ##-
        -#-
        -#-
      `)],["2",u(this,O,P).call(this,`
        ##-
        -##
        #--
        ###
      `)],["3",u(this,O,P).call(this,`
        ###
        -##
        --#
        ###
      `)],["4",u(this,O,P).call(this,`
        #-#
        #-#
        ###
        --#
      `)],["5",u(this,O,P).call(this,`
        ###
        ##-
        --#
        ##-
      `)],["6",u(this,O,P).call(this,`
        -#-
        #--
        ###
        -#-
      `)],["7",u(this,O,P).call(this,`
        ###
        --#
        -#-
        #--
      `)],["8",u(this,O,P).call(this,`
        ###
        -#-
        #-#
        -#-
      `)],["9",u(this,O,P).call(this,`
        ###
        ###
        --#
        ##-
      `)],["%",u(this,O,P).call(this,`
        #--#
        --#-
        -#--
        #--#
      `)],["$",u(this,O,P).call(this,`
        -##
        ##-
        -##
        ##-
      `)],["(",u(this,O,P).call(this,`
        -#
        #-
        #-
        -#
      `)],[")",u(this,O,P).call(this,`
        #-
        -#
        -#
        #-
      `)],["[",u(this,O,P).call(this,`
        ##
        #-
        #-
        ##
      `)],["]",u(this,O,P).call(this,`
        ##
        -#
        -#
        ##
      `)],["{",u(this,O,P).call(this,`
        -#
        ##
        ##
        -#
      `)],["}",u(this,O,P).call(this,`
        #-
        ##
        ##
        #-
      `)],["<",u(this,O,P).call(this,`
        ---
        -##
        #--
        -##
      `)],[">",u(this,O,P).call(this,`
        ##-
        --#
        ##-
        ---
      `)],["a",u(this,O,P).call(this,`
        ##-
        #-#
        ###
        #-#
      `)],["b",u(this,O,P).call(this,`
        #--
        ##-
        #-#
        ###
      `)],["c",u(this,O,P).call(this,`
        -##
        #--
        #--
        -##
      `)],["d",u(this,O,P).call(this,`
        ##-
        #-#
        #-#
        ##-
      `)],["e",u(this,O,P).call(this,`
        ###
        ##-
        #--
        ###
      `)],["f",u(this,O,P).call(this,`
        ###
        #--
        ##-
        #--
      `)],["g",u(this,O,P).call(this,`
        -##
        #--
        #-#
        -##
      `)],["h",u(this,O,P).call(this,`
        #--
        ##-
        #-#
        #-#
      `)],["i",u(this,O,P).call(this,`
        #
        #
        #
        #
      `)],["j",u(this,O,P).call(this,`
        ##
        -#
        -#
        #-
      `)],["k",u(this,O,P).call(this,`
        #-#
        ##-
        #-#
        #-#
      `)],["l",u(this,O,P).call(this,`
        #-
        #-
        #-
        ##
      `)],["m",u(this,O,P).call(this,`
        #-#
        ###
        #-#
        #-#
      `)],["n",u(this,O,P).call(this,`
        ##-
        #-#
        #-#
        #-#
      `)],["o",u(this,O,P).call(this,`
        -##
        #-#
        #-#
        ##-
      `)],["p",u(this,O,P).call(this,`
        ###
        #-#
        ##-
        #--
      `)],["q",u(this,O,P).call(this,`
        -#-
        #-#
        ###
        -#-
      `)],["r",u(this,O,P).call(this,`
        ##-
        #-#
        ##-
        #-#
      `)],["s",u(this,O,P).call(this,`
        -##
        ##-
        --#
        ##-
      `)],["t",u(this,O,P).call(this,`
        ###
        -#-
        -#-
        -#-
      `)],["u",u(this,O,P).call(this,`
        #-#
        #-#
        #-#
        ##-
      `)],["v",u(this,O,P).call(this,`
        #-#
        #-#
        #-#
        -#-
      `)],["w",u(this,O,P).call(this,`
        #-#
        #-#
        ###
        #-#
      `)],["x",u(this,O,P).call(this,`
        #-#
        -#-
        #-#
        #-#
      `)],["y",u(this,O,P).call(this,`
        #-#
        #-#
        -#-
        -#-
      `)],["z",u(this,O,P).call(this,`
        ###
        -#-
        #--
        ###
      `)]]))}mapGrapheme(e){return e.toLowerCase()}}O=new WeakSet,P=function(e){const t=Sr.from(e);return{type:"pixels",pixels:t,advance:t.size.x+1}};var v,A;class Ru{constructor(){d(this,v);b(this,"ascent",5);b(this,"descent",0);b(this,"lineGap",2);b(this,"glyphs",new Map([[" ",u(this,v,A).call(this,`
        ----
        ----
        ----
        ----
        ----
      `)],[".",u(this,v,A).call(this,`
        --
        --
        --
        ##
        ##
      `)],[":",u(this,v,A).call(this,`
        #
        -
        -
        #
        -
      `)],["!",u(this,v,A).call(this,`
        ###
        ###
        -#-
        ---
        -#-
      `)],["?",u(this,v,A).call(this,`
        ###
        --#
        -#-
        ---
        -#-
      `)],["'",u(this,v,A).call(this,`
        -
        #
        #
        -
        -
      `)],['"',u(this,v,A).call(this,`
        #-#
        #-#
        ---
        ---
        ---
      `)],["*",u(this,v,A).call(this,`
        --
        ##
        ##
        --
        --
      `)],["/",u(this,v,A).call(this,`
        --#
        --#
        -#-
        #--
        #--
      `)],["+",u(this,v,A).call(this,`
        ---
        -#-
        ###
        -#-
        ---
      `)],["-",u(this,v,A).call(this,`
        ---
        ---
        ###
        ---
        ---
      `)],["0",u(this,v,A).call(this,`
        -#-
        #-#
        #-#
        #-#
        -#-
      `)],["1",u(this,v,A).call(this,`
        -#-
        ##-
        -#-
        -#-
        ###
      `)],["2",u(this,v,A).call(this,`
        -#-
        #-#
        --#
        -#-
        ###
      `)],["3",u(this,v,A).call(this,`
        ###
        --#
        -##
        --#
        ##-
      `)],["4",u(this,v,A).call(this,`
        --#
        -##
        #-#
        ###
        --#
      `)],["5",u(this,v,A).call(this,`
        ###
        #--
        ###
        --#
        ##-
      `)],["6",u(this,v,A).call(this,`
        ###
        #--
        ###
        #-#
        ###
      `)],["7",u(this,v,A).call(this,`
        ###
        --#
        -#-
        -#-
        -#-
      `)],["8",u(this,v,A).call(this,`
        ###
        #-#
        -#-
        #-#
        ###
      `)],["9",u(this,v,A).call(this,`
        ###
        #-#
        ###
        --#
        ###
      `)],["%",u(this,v,A).call(this,`
        #-#
        --#
        -#-
        #--
        #-#
      `)],["$",u(this,v,A).call(this,`
        ###
        ##-
        -##
        ###
        -#-
      `)],["(",u(this,v,A).call(this,`
        -#
        #-
        #-
        #-
        -#
      `)],[")",u(this,v,A).call(this,`
        #-
        -#
        -#
        -#
        #-
      `)],["[",u(this,v,A).call(this,`
        ##
        #-
        #-
        #-
        ##
      `)],["]",u(this,v,A).call(this,`
        ##
        -#
        -#
        -#
        ##
      `)],["{",u(this,v,A).call(this,`
        -##
        -#-
        #--
        -#-
        -##
      `)],["}",u(this,v,A).call(this,`
        ##-
        -#-
        --#
        -#-
        ##-
      `)],["<",u(this,v,A).call(this,`
        --#
        -#-
        #--
        -#-
        --#
      `)],[">",u(this,v,A).call(this,`
        #--
        -#-
        --#
        -#-
        #--
      `)],["A",u(this,v,A).call(this,`
        -#-
        #-#
        ###
        #-#
        #-#
      `)],["B",u(this,v,A).call(this,`
        ##-
        #-#
        ##-
        #-#
        ###
      `)],["C",u(this,v,A).call(this,`
        -#-
        #-#
        #--
        #-#
        -#-
      `)],["D",u(this,v,A).call(this,`
        ##-
        #-#
        #-#
        #-#
        ##-
      `)],["E",u(this,v,A).call(this,`
        ###
        #--
        ##-
        #--
        ###
      `)],["F",u(this,v,A).call(this,`
        ###
        #--
        ##-
        #--
        #--
      `)],["G",u(this,v,A).call(this,`
        -#-
        #-#
        #--
        #-#
        -##
      `)],["H",u(this,v,A).call(this,`
        #-#
        #-#
        ###
        #-#
        #-#
      `)],["I",u(this,v,A).call(this,`
        ###
        -#-
        -#-
        -#-
        ###
      `)],["J",u(this,v,A).call(this,`
        --#
        --#
        --#
        #-#
        -#-
      `)],["K",u(this,v,A).call(this,`
        #-#
        #-#
        ##-
        #-#
        #-#
      `)],["L",u(this,v,A).call(this,`
        #--
        #--
        #--
        #--
        ###
      `)],["M",u(this,v,A).call(this,`
        #-#
        ###
        ###
        #-#
        #-#
      `)],["N",u(this,v,A).call(this,`
        ##-
        ###
        #-#
        #-#
        #-#
      `)],["O",u(this,v,A).call(this,`
        -#-
        #-#
        #-#
        #-#
        -#-
      `)],["P",u(this,v,A).call(this,`
        ##-
        #-#
        ###
        #--
        #--
      `)],["Q",u(this,v,A).call(this,`
        -#-
        #-#
        #-#
        ###
        -##
      `)],["R",u(this,v,A).call(this,`
        ##-
        #-#
        ##-
        #-#
        #-#
      `)],["S",u(this,v,A).call(this,`
        ###
        #--
        -#-
        --#
        ##-
      `)],["T",u(this,v,A).call(this,`
        ###
        -#-
        -#-
        -#-
        -#-
      `)],["U",u(this,v,A).call(this,`
        #-#
        #-#
        #-#
        #-#
        ###
      `)],["V",u(this,v,A).call(this,`
        #-#
        #-#
        #-#
        -#-
        -#-
      `)],["W",u(this,v,A).call(this,`
        #-#
        #-#
        ###
        ###
        #-#
      `)],["X",u(this,v,A).call(this,`
        #-#
        #-#
        -#-
        #-#
        #-#
      `)],["Y",u(this,v,A).call(this,`
        #-#
        #-#
        -#-
        -#-
        -#-
      `)],["Z",u(this,v,A).call(this,`
        ###
        --#
        -#-
        #--
        ###
      `)],["a",u(this,v,A).call(this,`
        -#-
        #-#
        #-#
        ###
        #-#
      `)],["b",u(this,v,A).call(this,`
        #--
        #--
        ##-
        #-#
        ##-
      `)],["c",u(this,v,A).call(this,`
        -##
        #--
        #--
        #--
        -##
      `)],["d",u(this,v,A).call(this,`
        --#
        --#
        -##
        #-#
        ###
      `)],["e",u(this,v,A).call(this,`
        -#-
        #-#
        ###
        #--
        -##
      `)],["f",u(this,v,A).call(this,`
        -##
        -#-
        ###
        -#-
        -#-
      `)],["g",u(this,v,A).call(this,`
        -#-
        #-#
        #--
        #-#
        -##
      `)],["h",u(this,v,A).call(this,`
        #--
        #--
        ##-
        #-#
        #-#
      `)],["i",u(this,v,A).call(this,`
        -#
        --
        -#
        -#
        -#
      `)],["j",u(this,v,A).call(this,`
        -##
        --#
        --#
        #-#
        -#-
      `)],["k",u(this,v,A).call(this,`
        #-#
        #-#
        ##-
        #-#
        #-#
      `)],["l",u(this,v,A).call(this,`
        #
        #
        #
        #
        #
      `)],["m",u(this,v,A).call(this,`
        #-#
        ###
        ###
        #-#
        #-#
      `)],["n",u(this,v,A).call(this,`
        ##-
        #-#
        #-#
        #-#
        #-#
      `)],["o",u(this,v,A).call(this,`
        -#-
        #-#
        #-#
        #-#
        -#-
      `)],["p",u(this,v,A).call(this,`
        ##-
        #-#
        ###
        #--
        #--
      `)],["q",u(this,v,A).call(this,`
        -#-
        #-#
        #-#
        ###
        -##
      `)],["r",u(this,v,A).call(this,`
        -#-
        #-#
        #--
        #--
        #--
      `)],["s",u(this,v,A).call(this,`
        -##
        #--
        -#-
        --#
        ##-
      `)],["t",u(this,v,A).call(this,`
        -#-
        ###
        -#-
        -#-
        -##
      `)],["u",u(this,v,A).call(this,`
        #-#
        #-#
        #-#
        #-#
        -#-
      `)],["v",u(this,v,A).call(this,`
        #-#
        #-#
        #-#
        -#-
        -#-
      `)],["w",u(this,v,A).call(this,`
        #-#
        #-#
        ###
        ###
        #-#
      `)],["x",u(this,v,A).call(this,`
        #-#
        #-#
        -#-
        #-#
        #-#
      `)],["y",u(this,v,A).call(this,`
        #-#
        #-#
        -#-
        -#-
        -#-
      `)],["z",u(this,v,A).call(this,`
        ###
        --#
        -#-
        #--
        ###
      `)]]))}mapGrapheme(e){return e}}v=new WeakSet,A=function(e){const t=Sr.from(e);return{type:"pixels",pixels:t,advance:t.size.x+1}};class el{static detect(e){const t=e.id.toLowerCase();return t.includes("dualsense")?"dualsense":t.includes("8bitdo")||t.includes("2dc8")?"8bitdo":t.includes("054c")?"dualsense":t.includes("xbox")||t.includes("045e")?"xbox":(t.includes("xinput"),"other")}}class ${static addLoadedClass(){document.body.classList.add("loaded")}static addStartedClass(){document.body.classList.add("started")}static showError(e){document.body.classList.add("error"),document.getElementById("screen_error__message").innerText=String(e)}static updateMutedClass(e){document.body.classList[e?"add":"remove"]("muted")}static updateDebugClass(e){document.body.classList[e?"add":"remove"]("debug")}static updatePressedClasses(e){document.body.classList[e.up?"add":"remove"]("pressed_u"),document.body.classList[e.down?"add":"remove"]("pressed_d"),document.body.classList[e.left?"add":"remove"]("pressed_l"),document.body.classList[e.right?"add":"remove"]("pressed_r"),document.body.classList[e.a?"add":"remove"]("pressed_a"),document.body.classList[e.b?"add":"remove"]("pressed_b"),document.body.classList[e.menu?"add":"remove"]("pressed_menu"),document.body.classList[e.mute?"add":"remove"]("pressed_mute"),document.body.classList[e.fullscreen?"add":"remove"]("pressed_fullscreen")}}b($,"selectors",{fullScreenSubject:"body",canvas:"#game_canvas",startButton:"#screen_start_game__button",controlsLeft:"#dpad_l",controlsRight:"#dpad_r",controlsUp:"#dpad_u",controlsDown:"#dpad_d",controlsUpLeft:"#dpad_ul",controlsUpRight:"#dpad_ur",controlsDownLeft:"#dpad_dl",controlsDownRight:"#dpad_dr",controlsA:"#button_a",controlsB:"#button_b",controlsMenu:"#button_menu",controlsFullScreen:"#button_fullscreen",controlsMuteToggle:"#button_mute"});(function(i){if(i.TextEncoder&&i.TextDecoder)return!1;function e(s="utf-8"){if(s!=="utf-8")throw new RangeError(`Failed to construct 'TextEncoder': The encoding label provided ('${s}') is invalid.`)}Object.defineProperty(e.prototype,"encoding",{value:"utf-8"}),e.prototype.encode=function(s,n={stream:!1}){if(n.stream)throw new Error("Failed to encode: the 'stream' option is unsupported.");let r=0;const o=s.length;let h=0,c=Math.max(32,o+(o>>1)+7),l=new Uint8Array(c>>3<<3);for(;r<o;){let f=s.charCodeAt(r++);if(f>=55296&&f<=56319){if(r<o){const m=s.charCodeAt(r);(m&64512)===56320&&(++r,f=((f&1023)<<10)+(m&1023)+65536)}if(f>=55296&&f<=56319)continue}if(h+4>l.length){c+=8,c*=1+r/s.length*2,c=c>>3<<3;const m=new Uint8Array(c);m.set(l),l=m}if(f&4294967168)if(!(f&4294965248))l[h++]=f>>6&31|192;else if(!(f&4294901760))l[h++]=f>>12&15|224,l[h++]=f>>6&63|128;else if(!(f&4292870144))l[h++]=f>>18&7|240,l[h++]=f>>12&63|128,l[h++]=f>>6&63|128;else continue;else{l[h++]=f;continue}l[h++]=f&63|128}return l.slice(0,h)};function t(s="utf-8",n={fatal:!1}){if(s!=="utf-8")throw new RangeError(`Failed to construct 'TextDecoder': The encoding label provided ('${s}') is invalid.`);if(n.fatal)throw new Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}Object.defineProperty(t.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(t.prototype,"fatal",{value:!1}),Object.defineProperty(t.prototype,"ignoreBOM",{value:!1}),t.prototype.decode=function(s,n={stream:!1}){if(n.stream)throw new Error("Failed to decode: the 'stream' option is unsupported.");const r=new Uint8Array(s);let o=0;const h=r.length,c=[];for(;o<h;){const l=r[o++];if(l===0)break;if(!(l&128))c.push(l);else if((l&224)===192){const f=r[o++]&63;c.push((l&31)<<6|f)}else if((l&240)===224){const f=r[o++]&63,m=r[o++]&63;c.push((l&31)<<12|f<<6|m)}else if((l&248)===240){const f=r[o++]&63,m=r[o++]&63,g=r[o++]&63;let p=(l&7)<<18|f<<12|m<<6|g;p>65535&&(p-=65536,c.push(p>>>10&1023|55296),p=56320|p&1023),c.push(p)}}return String.fromCharCode.apply(null,c)},i.TextEncoder=e,i.TextDecoder=t})(typeof window<"u"?window:typeof self<"u"?self:void 0);function no(i,e="utf8"){return new TextDecoder(e).decode(i)}const Mu=new TextEncoder;function Fu(i){return Mu.encode(i)}const Ou=1024*8,Du=(()=>{const i=new Uint8Array(4),e=new Uint32Array(i.buffer);return!((e[0]=1)&i[0])})(),Or={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Ll{constructor(e=Ou,t={}){let s=!1;typeof e=="number"?e=new ArrayBuffer(e):(s=!0,this.lastWrittenByte=e.byteLength);const n=t.offset?t.offset>>>0:0,r=e.byteLength-n;let o=n;(ArrayBuffer.isView(e)||e instanceof Ll)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+n),e=e.buffer),s?this.lastWrittenByte=r:this.lastWrittenByte=0,this.buffer=e,this.length=r,this.byteLength=r,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,r),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const s=(this.offset+e)*2,n=new Uint8Array(s);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=this.byteLength=s,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){const s=Or[t].BYTES_PER_ELEMENT*e,n=this.byteOffset+this.offset,r=this.buffer.slice(n,n+s);if(this.littleEndian===Du&&t!=="uint8"&&t!=="int8"){const h=new Uint8Array(this.buffer.slice(n,n+s));h.reverse();const c=new Or[t](h.buffer);return this.offset+=s,c.reverse(),c}const o=new Or[t](r);return this.offset+=s,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let s=0;s<e;s++)t+=this.readChar();return t}readUtf8(e=1){return no(this.readBytes(e))}decodeText(e=1,t="utf-8"){return no(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(Fu(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Pu=4,ao=0,ro=1,Uu=2;function js(i){let e=i.length;for(;--e>=0;)i[e]=0}const Iu=0,uh=1,zu=2,Nu=3,Bu=258,$l=29,Ma=256,gn=Ma+1+$l,ps=30,Gl=19,fh=2*gn+1,vi=15,Dr=16,Lu=7,Zl=256,ch=16,dh=17,ph=18,il=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Xa=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),$u=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),_h=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Gu=512,pe=new Array((gn+2)*2);js(pe);const on=new Array(ps*2);js(on);const mn=new Array(Gu);js(mn);const bn=new Array(Bu-Nu+1);js(bn);const Hl=new Array($l);js(Hl);const er=new Array(ps);js(er);function Pr(i,e,t,s,n){this.static_tree=i,this.extra_bits=e,this.extra_base=t,this.elems=s,this.max_length=n,this.has_stree=i&&i.length}let gh,mh,bh;function Ur(i,e){this.dyn_tree=i,this.max_code=0,this.stat_desc=e}const wh=i=>i<256?mn[i]:mn[256+(i>>>7)],wn=(i,e)=>{i.pending_buf[i.pending++]=e&255,i.pending_buf[i.pending++]=e>>>8&255},St=(i,e,t)=>{i.bi_valid>Dr-t?(i.bi_buf|=e<<i.bi_valid&65535,wn(i,i.bi_buf),i.bi_buf=e>>Dr-i.bi_valid,i.bi_valid+=t-Dr):(i.bi_buf|=e<<i.bi_valid&65535,i.bi_valid+=t)},he=(i,e,t)=>{St(i,t[e*2],t[e*2+1])},yh=(i,e)=>{let t=0;do t|=i&1,i>>>=1,t<<=1;while(--e>0);return t>>>1},Zu=i=>{i.bi_valid===16?(wn(i,i.bi_buf),i.bi_buf=0,i.bi_valid=0):i.bi_valid>=8&&(i.pending_buf[i.pending++]=i.bi_buf&255,i.bi_buf>>=8,i.bi_valid-=8)},Hu=(i,e)=>{const t=e.dyn_tree,s=e.max_code,n=e.stat_desc.static_tree,r=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,h=e.stat_desc.extra_base,c=e.stat_desc.max_length;let l,f,m,g,p,y,N=0;for(g=0;g<=vi;g++)i.bl_count[g]=0;for(t[i.heap[i.heap_max]*2+1]=0,l=i.heap_max+1;l<fh;l++)f=i.heap[l],g=t[t[f*2+1]*2+1]+1,g>c&&(g=c,N++),t[f*2+1]=g,!(f>s)&&(i.bl_count[g]++,p=0,f>=h&&(p=o[f-h]),y=t[f*2],i.opt_len+=y*(g+p),r&&(i.static_len+=y*(n[f*2+1]+p)));if(N!==0){do{for(g=c-1;i.bl_count[g]===0;)g--;i.bl_count[g]--,i.bl_count[g+1]+=2,i.bl_count[c]--,N-=2}while(N>0);for(g=c;g!==0;g--)for(f=i.bl_count[g];f!==0;)m=i.heap[--l],!(m>s)&&(t[m*2+1]!==g&&(i.opt_len+=(g-t[m*2+1])*t[m*2],t[m*2+1]=g),f--)}},vh=(i,e,t)=>{const s=new Array(vi+1);let n=0,r,o;for(r=1;r<=vi;r++)n=n+t[r-1]<<1,s[r]=n;for(o=0;o<=e;o++){let h=i[o*2+1];h!==0&&(i[o*2]=yh(s[h]++,h))}},Ju=()=>{let i,e,t,s,n;const r=new Array(vi+1);for(t=0,s=0;s<$l-1;s++)for(Hl[s]=t,i=0;i<1<<il[s];i++)bn[t++]=s;for(bn[t-1]=s,n=0,s=0;s<16;s++)for(er[s]=n,i=0;i<1<<Xa[s];i++)mn[n++]=s;for(n>>=7;s<ps;s++)for(er[s]=n<<7,i=0;i<1<<Xa[s]-7;i++)mn[256+n++]=s;for(e=0;e<=vi;e++)r[e]=0;for(i=0;i<=143;)pe[i*2+1]=8,i++,r[8]++;for(;i<=255;)pe[i*2+1]=9,i++,r[9]++;for(;i<=279;)pe[i*2+1]=7,i++,r[7]++;for(;i<=287;)pe[i*2+1]=8,i++,r[8]++;for(vh(pe,gn+1,r),i=0;i<ps;i++)on[i*2+1]=5,on[i*2]=yh(i,5);gh=new Pr(pe,il,Ma+1,gn,vi),mh=new Pr(on,Xa,0,ps,vi),bh=new Pr(new Array(0),$u,0,Gl,Lu)},xh=i=>{let e;for(e=0;e<gn;e++)i.dyn_ltree[e*2]=0;for(e=0;e<ps;e++)i.dyn_dtree[e*2]=0;for(e=0;e<Gl;e++)i.bl_tree[e*2]=0;i.dyn_ltree[Zl*2]=1,i.opt_len=i.static_len=0,i.sym_next=i.matches=0},Ah=i=>{i.bi_valid>8?wn(i,i.bi_buf):i.bi_valid>0&&(i.pending_buf[i.pending++]=i.bi_buf),i.bi_buf=0,i.bi_valid=0},lo=(i,e,t,s)=>{const n=e*2,r=t*2;return i[n]<i[r]||i[n]===i[r]&&s[e]<=s[t]},Ir=(i,e,t)=>{const s=i.heap[t];let n=t<<1;for(;n<=i.heap_len&&(n<i.heap_len&&lo(e,i.heap[n+1],i.heap[n],i.depth)&&n++,!lo(e,s,i.heap[n],i.depth));)i.heap[t]=i.heap[n],t=n,n<<=1;i.heap[t]=s},oo=(i,e,t)=>{let s,n,r=0,o,h;if(i.sym_next!==0)do s=i.pending_buf[i.sym_buf+r++]&255,s+=(i.pending_buf[i.sym_buf+r++]&255)<<8,n=i.pending_buf[i.sym_buf+r++],s===0?he(i,n,e):(o=bn[n],he(i,o+Ma+1,e),h=il[o],h!==0&&(n-=Hl[o],St(i,n,h)),s--,o=wh(s),he(i,o,t),h=Xa[o],h!==0&&(s-=er[o],St(i,s,h)));while(r<i.sym_next);he(i,Zl,e)},sl=(i,e)=>{const t=e.dyn_tree,s=e.stat_desc.static_tree,n=e.stat_desc.has_stree,r=e.stat_desc.elems;let o,h,c=-1,l;for(i.heap_len=0,i.heap_max=fh,o=0;o<r;o++)t[o*2]!==0?(i.heap[++i.heap_len]=c=o,i.depth[o]=0):t[o*2+1]=0;for(;i.heap_len<2;)l=i.heap[++i.heap_len]=c<2?++c:0,t[l*2]=1,i.depth[l]=0,i.opt_len--,n&&(i.static_len-=s[l*2+1]);for(e.max_code=c,o=i.heap_len>>1;o>=1;o--)Ir(i,t,o);l=r;do o=i.heap[1],i.heap[1]=i.heap[i.heap_len--],Ir(i,t,1),h=i.heap[1],i.heap[--i.heap_max]=o,i.heap[--i.heap_max]=h,t[l*2]=t[o*2]+t[h*2],i.depth[l]=(i.depth[o]>=i.depth[h]?i.depth[o]:i.depth[h])+1,t[o*2+1]=t[h*2+1]=l,i.heap[1]=l++,Ir(i,t,1);while(i.heap_len>=2);i.heap[--i.heap_max]=i.heap[1],Hu(i,e),vh(t,c,i.bl_count)},ho=(i,e,t)=>{let s,n=-1,r,o=e[0*2+1],h=0,c=7,l=4;for(o===0&&(c=138,l=3),e[(t+1)*2+1]=65535,s=0;s<=t;s++)r=o,o=e[(s+1)*2+1],!(++h<c&&r===o)&&(h<l?i.bl_tree[r*2]+=h:r!==0?(r!==n&&i.bl_tree[r*2]++,i.bl_tree[ch*2]++):h<=10?i.bl_tree[dh*2]++:i.bl_tree[ph*2]++,h=0,n=r,o===0?(c=138,l=3):r===o?(c=6,l=3):(c=7,l=4))},uo=(i,e,t)=>{let s,n=-1,r,o=e[0*2+1],h=0,c=7,l=4;for(o===0&&(c=138,l=3),s=0;s<=t;s++)if(r=o,o=e[(s+1)*2+1],!(++h<c&&r===o)){if(h<l)do he(i,r,i.bl_tree);while(--h!==0);else r!==0?(r!==n&&(he(i,r,i.bl_tree),h--),he(i,ch,i.bl_tree),St(i,h-3,2)):h<=10?(he(i,dh,i.bl_tree),St(i,h-3,3)):(he(i,ph,i.bl_tree),St(i,h-11,7));h=0,n=r,o===0?(c=138,l=3):r===o?(c=6,l=3):(c=7,l=4)}},Ku=i=>{let e;for(ho(i,i.dyn_ltree,i.l_desc.max_code),ho(i,i.dyn_dtree,i.d_desc.max_code),sl(i,i.bl_desc),e=Gl-1;e>=3&&i.bl_tree[_h[e]*2+1]===0;e--);return i.opt_len+=3*(e+1)+5+5+4,e},Wu=(i,e,t,s)=>{let n;for(St(i,e-257,5),St(i,t-1,5),St(i,s-4,4),n=0;n<s;n++)St(i,i.bl_tree[_h[n]*2+1],3);uo(i,i.dyn_ltree,e-1),uo(i,i.dyn_dtree,t-1)},qu=i=>{let e=4093624447,t;for(t=0;t<=31;t++,e>>>=1)if(e&1&&i.dyn_ltree[t*2]!==0)return ao;if(i.dyn_ltree[9*2]!==0||i.dyn_ltree[10*2]!==0||i.dyn_ltree[13*2]!==0)return ro;for(t=32;t<Ma;t++)if(i.dyn_ltree[t*2]!==0)return ro;return ao};let fo=!1;const Yu=i=>{fo||(Ju(),fo=!0),i.l_desc=new Ur(i.dyn_ltree,gh),i.d_desc=new Ur(i.dyn_dtree,mh),i.bl_desc=new Ur(i.bl_tree,bh),i.bi_buf=0,i.bi_valid=0,xh(i)},kh=(i,e,t,s)=>{St(i,(Iu<<1)+(s?1:0),3),Ah(i),wn(i,t),wn(i,~t),t&&i.pending_buf.set(i.window.subarray(e,e+t),i.pending),i.pending+=t},Xu=i=>{St(i,uh<<1,3),he(i,Zl,pe),Zu(i)},ju=(i,e,t,s)=>{let n,r,o=0;i.level>0?(i.strm.data_type===Uu&&(i.strm.data_type=qu(i)),sl(i,i.l_desc),sl(i,i.d_desc),o=Ku(i),n=i.opt_len+3+7>>>3,r=i.static_len+3+7>>>3,r<=n&&(n=r)):n=r=t+5,t+4<=n&&e!==-1?kh(i,e,t,s):i.strategy===Pu||r===n?(St(i,(uh<<1)+(s?1:0),3),oo(i,pe,on)):(St(i,(zu<<1)+(s?1:0),3),Wu(i,i.l_desc.max_code+1,i.d_desc.max_code+1,o+1),oo(i,i.dyn_ltree,i.dyn_dtree)),xh(i),s&&Ah(i)},Qu=(i,e,t)=>(i.pending_buf[i.sym_buf+i.sym_next++]=e,i.pending_buf[i.sym_buf+i.sym_next++]=e>>8,i.pending_buf[i.sym_buf+i.sym_next++]=t,e===0?i.dyn_ltree[t*2]++:(i.matches++,e--,i.dyn_ltree[(bn[t]+Ma+1)*2]++,i.dyn_dtree[wh(e)*2]++),i.sym_next===i.sym_end);var Vu=Yu,tf=kh,ef=ju,sf=Qu,nf=Xu,af={_tr_init:Vu,_tr_stored_block:tf,_tr_flush_block:ef,_tr_tally:sf,_tr_align:nf};const rf=(i,e,t,s)=>{let n=i&65535|0,r=i>>>16&65535|0,o=0;for(;t!==0;){o=t>2e3?2e3:t,t-=o;do n=n+e[s++]|0,r=r+n|0;while(--o);n%=65521,r%=65521}return n|r<<16|0};var yn=rf;const lf=()=>{let i,e=[];for(var t=0;t<256;t++){i=t;for(var s=0;s<8;s++)i=i&1?3988292384^i>>>1:i>>>1;e[t]=i}return e},of=new Uint32Array(lf()),hf=(i,e,t,s)=>{const n=of,r=s+t;i^=-1;for(let o=s;o<r;o++)i=i>>>8^n[(i^e[o])&255];return i^-1};var rt=hf,Ws={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Fa={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:uf,_tr_stored_block:nl,_tr_flush_block:ff,_tr_tally:ti,_tr_align:cf}=af,{Z_NO_FLUSH:ei,Z_PARTIAL_FLUSH:df,Z_FULL_FLUSH:pf,Z_FINISH:Nt,Z_BLOCK:co,Z_OK:lt,Z_STREAM_END:po,Z_STREAM_ERROR:ue,Z_DATA_ERROR:_f,Z_BUF_ERROR:zr,Z_DEFAULT_COMPRESSION:gf,Z_FILTERED:mf,Z_HUFFMAN_ONLY:za,Z_RLE:bf,Z_FIXED:wf,Z_DEFAULT_STRATEGY:yf,Z_UNKNOWN:vf,Z_DEFLATED:Er}=Fa,xf=9,Af=15,kf=8,Sf=29,Ef=256,al=Ef+1+Sf,Cf=30,Tf=19,Rf=2*al+1,Mf=15,W=3,Ve=258,fe=Ve+W+1,Ff=32,qs=42,Jl=57,rl=69,ll=73,ol=91,hl=103,xi=113,nn=666,gt=1,Qs=2,rs=3,Vs=4,Of=3,Ai=(i,e)=>(i.msg=Ws[e],e),_o=i=>i*2-(i>4?9:0),De=i=>{let e=i.length;for(;--e>=0;)i[e]=0},Df=i=>{let e,t,s,n=i.w_size;e=i.hash_size,s=e;do t=i.head[--s],i.head[s]=t>=n?t-n:0;while(--e);e=n,s=e;do t=i.prev[--s],i.prev[s]=t>=n?t-n:0;while(--e)};let Pf=(i,e,t)=>(e<<i.hash_shift^t)&i.hash_mask,ii=Pf;const Ct=i=>{const e=i.state;let t=e.pending;t>i.avail_out&&(t=i.avail_out),t!==0&&(i.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+t),i.next_out),i.next_out+=t,e.pending_out+=t,i.total_out+=t,i.avail_out-=t,e.pending-=t,e.pending===0&&(e.pending_out=0))},Tt=(i,e)=>{ff(i,i.block_start>=0?i.block_start:-1,i.strstart-i.block_start,e),i.block_start=i.strstart,Ct(i.strm)},q=(i,e)=>{i.pending_buf[i.pending++]=e},tn=(i,e)=>{i.pending_buf[i.pending++]=e>>>8&255,i.pending_buf[i.pending++]=e&255},ul=(i,e,t,s)=>{let n=i.avail_in;return n>s&&(n=s),n===0?0:(i.avail_in-=n,e.set(i.input.subarray(i.next_in,i.next_in+n),t),i.state.wrap===1?i.adler=yn(i.adler,e,n,t):i.state.wrap===2&&(i.adler=rt(i.adler,e,n,t)),i.next_in+=n,i.total_in+=n,n)},Sh=(i,e)=>{let t=i.max_chain_length,s=i.strstart,n,r,o=i.prev_length,h=i.nice_match;const c=i.strstart>i.w_size-fe?i.strstart-(i.w_size-fe):0,l=i.window,f=i.w_mask,m=i.prev,g=i.strstart+Ve;let p=l[s+o-1],y=l[s+o];i.prev_length>=i.good_match&&(t>>=2),h>i.lookahead&&(h=i.lookahead);do if(n=e,!(l[n+o]!==y||l[n+o-1]!==p||l[n]!==l[s]||l[++n]!==l[s+1])){s+=2,n++;do;while(l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&s<g);if(r=Ve-(g-s),s=g-Ve,r>o){if(i.match_start=e,o=r,r>=h)break;p=l[s+o-1],y=l[s+o]}}while((e=m[e&f])>c&&--t!==0);return o<=i.lookahead?o:i.lookahead},Ys=i=>{const e=i.w_size;let t,s,n;do{if(s=i.window_size-i.lookahead-i.strstart,i.strstart>=e+(e-fe)&&(i.window.set(i.window.subarray(e,e+e-s),0),i.match_start-=e,i.strstart-=e,i.block_start-=e,i.insert>i.strstart&&(i.insert=i.strstart),Df(i),s+=e),i.strm.avail_in===0)break;if(t=ul(i.strm,i.window,i.strstart+i.lookahead,s),i.lookahead+=t,i.lookahead+i.insert>=W)for(n=i.strstart-i.insert,i.ins_h=i.window[n],i.ins_h=ii(i,i.ins_h,i.window[n+1]);i.insert&&(i.ins_h=ii(i,i.ins_h,i.window[n+W-1]),i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++,i.insert--,!(i.lookahead+i.insert<W)););}while(i.lookahead<fe&&i.strm.avail_in!==0)},Eh=(i,e)=>{let t=i.pending_buf_size-5>i.w_size?i.w_size:i.pending_buf_size-5,s,n,r,o=0,h=i.strm.avail_in;do{if(s=65535,r=i.bi_valid+42>>3,i.strm.avail_out<r||(r=i.strm.avail_out-r,n=i.strstart-i.block_start,s>n+i.strm.avail_in&&(s=n+i.strm.avail_in),s>r&&(s=r),s<t&&(s===0&&e!==Nt||e===ei||s!==n+i.strm.avail_in)))break;o=e===Nt&&s===n+i.strm.avail_in?1:0,nl(i,0,0,o),i.pending_buf[i.pending-4]=s,i.pending_buf[i.pending-3]=s>>8,i.pending_buf[i.pending-2]=~s,i.pending_buf[i.pending-1]=~s>>8,Ct(i.strm),n&&(n>s&&(n=s),i.strm.output.set(i.window.subarray(i.block_start,i.block_start+n),i.strm.next_out),i.strm.next_out+=n,i.strm.avail_out-=n,i.strm.total_out+=n,i.block_start+=n,s-=n),s&&(ul(i.strm,i.strm.output,i.strm.next_out,s),i.strm.next_out+=s,i.strm.avail_out-=s,i.strm.total_out+=s)}while(o===0);return h-=i.strm.avail_in,h&&(h>=i.w_size?(i.matches=2,i.window.set(i.strm.input.subarray(i.strm.next_in-i.w_size,i.strm.next_in),0),i.strstart=i.w_size,i.insert=i.strstart):(i.window_size-i.strstart<=h&&(i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,i.insert>i.strstart&&(i.insert=i.strstart)),i.window.set(i.strm.input.subarray(i.strm.next_in-h,i.strm.next_in),i.strstart),i.strstart+=h,i.insert+=h>i.w_size-i.insert?i.w_size-i.insert:h),i.block_start=i.strstart),i.high_water<i.strstart&&(i.high_water=i.strstart),o?Vs:e!==ei&&e!==Nt&&i.strm.avail_in===0&&i.strstart===i.block_start?Qs:(r=i.window_size-i.strstart,i.strm.avail_in>r&&i.block_start>=i.w_size&&(i.block_start-=i.w_size,i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,r+=i.w_size,i.insert>i.strstart&&(i.insert=i.strstart)),r>i.strm.avail_in&&(r=i.strm.avail_in),r&&(ul(i.strm,i.window,i.strstart,r),i.strstart+=r,i.insert+=r>i.w_size-i.insert?i.w_size-i.insert:r),i.high_water<i.strstart&&(i.high_water=i.strstart),r=i.bi_valid+42>>3,r=i.pending_buf_size-r>65535?65535:i.pending_buf_size-r,t=r>i.w_size?i.w_size:r,n=i.strstart-i.block_start,(n>=t||(n||e===Nt)&&e!==ei&&i.strm.avail_in===0&&n<=r)&&(s=n>r?r:n,o=e===Nt&&i.strm.avail_in===0&&s===n?1:0,nl(i,i.block_start,s,o),i.block_start+=s,Ct(i.strm)),o?rs:gt)},Nr=(i,e)=>{let t,s;for(;;){if(i.lookahead<fe){if(Ys(i),i.lookahead<fe&&e===ei)return gt;if(i.lookahead===0)break}if(t=0,i.lookahead>=W&&(i.ins_h=ii(i,i.ins_h,i.window[i.strstart+W-1]),t=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),t!==0&&i.strstart-t<=i.w_size-fe&&(i.match_length=Sh(i,t)),i.match_length>=W)if(s=ti(i,i.strstart-i.match_start,i.match_length-W),i.lookahead-=i.match_length,i.match_length<=i.max_lazy_match&&i.lookahead>=W){i.match_length--;do i.strstart++,i.ins_h=ii(i,i.ins_h,i.window[i.strstart+W-1]),t=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart;while(--i.match_length!==0);i.strstart++}else i.strstart+=i.match_length,i.match_length=0,i.ins_h=i.window[i.strstart],i.ins_h=ii(i,i.ins_h,i.window[i.strstart+1]);else s=ti(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++;if(s&&(Tt(i,!1),i.strm.avail_out===0))return gt}return i.insert=i.strstart<W-1?i.strstart:W-1,e===Nt?(Tt(i,!0),i.strm.avail_out===0?rs:Vs):i.sym_next&&(Tt(i,!1),i.strm.avail_out===0)?gt:Qs},hs=(i,e)=>{let t,s,n;for(;;){if(i.lookahead<fe){if(Ys(i),i.lookahead<fe&&e===ei)return gt;if(i.lookahead===0)break}if(t=0,i.lookahead>=W&&(i.ins_h=ii(i,i.ins_h,i.window[i.strstart+W-1]),t=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),i.prev_length=i.match_length,i.prev_match=i.match_start,i.match_length=W-1,t!==0&&i.prev_length<i.max_lazy_match&&i.strstart-t<=i.w_size-fe&&(i.match_length=Sh(i,t),i.match_length<=5&&(i.strategy===mf||i.match_length===W&&i.strstart-i.match_start>4096)&&(i.match_length=W-1)),i.prev_length>=W&&i.match_length<=i.prev_length){n=i.strstart+i.lookahead-W,s=ti(i,i.strstart-1-i.prev_match,i.prev_length-W),i.lookahead-=i.prev_length-1,i.prev_length-=2;do++i.strstart<=n&&(i.ins_h=ii(i,i.ins_h,i.window[i.strstart+W-1]),t=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart);while(--i.prev_length!==0);if(i.match_available=0,i.match_length=W-1,i.strstart++,s&&(Tt(i,!1),i.strm.avail_out===0))return gt}else if(i.match_available){if(s=ti(i,0,i.window[i.strstart-1]),s&&Tt(i,!1),i.strstart++,i.lookahead--,i.strm.avail_out===0)return gt}else i.match_available=1,i.strstart++,i.lookahead--}return i.match_available&&(s=ti(i,0,i.window[i.strstart-1]),i.match_available=0),i.insert=i.strstart<W-1?i.strstart:W-1,e===Nt?(Tt(i,!0),i.strm.avail_out===0?rs:Vs):i.sym_next&&(Tt(i,!1),i.strm.avail_out===0)?gt:Qs},Uf=(i,e)=>{let t,s,n,r;const o=i.window;for(;;){if(i.lookahead<=Ve){if(Ys(i),i.lookahead<=Ve&&e===ei)return gt;if(i.lookahead===0)break}if(i.match_length=0,i.lookahead>=W&&i.strstart>0&&(n=i.strstart-1,s=o[n],s===o[++n]&&s===o[++n]&&s===o[++n])){r=i.strstart+Ve;do;while(s===o[++n]&&s===o[++n]&&s===o[++n]&&s===o[++n]&&s===o[++n]&&s===o[++n]&&s===o[++n]&&s===o[++n]&&n<r);i.match_length=Ve-(r-n),i.match_length>i.lookahead&&(i.match_length=i.lookahead)}if(i.match_length>=W?(t=ti(i,1,i.match_length-W),i.lookahead-=i.match_length,i.strstart+=i.match_length,i.match_length=0):(t=ti(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++),t&&(Tt(i,!1),i.strm.avail_out===0))return gt}return i.insert=0,e===Nt?(Tt(i,!0),i.strm.avail_out===0?rs:Vs):i.sym_next&&(Tt(i,!1),i.strm.avail_out===0)?gt:Qs},If=(i,e)=>{let t;for(;;){if(i.lookahead===0&&(Ys(i),i.lookahead===0)){if(e===ei)return gt;break}if(i.match_length=0,t=ti(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++,t&&(Tt(i,!1),i.strm.avail_out===0))return gt}return i.insert=0,e===Nt?(Tt(i,!0),i.strm.avail_out===0?rs:Vs):i.sym_next&&(Tt(i,!1),i.strm.avail_out===0)?gt:Qs};function Vt(i,e,t,s,n){this.good_length=i,this.max_lazy=e,this.nice_length=t,this.max_chain=s,this.func=n}const an=[new Vt(0,0,0,0,Eh),new Vt(4,4,8,4,Nr),new Vt(4,5,16,8,Nr),new Vt(4,6,32,32,Nr),new Vt(4,4,16,16,hs),new Vt(8,16,32,32,hs),new Vt(8,16,128,128,hs),new Vt(8,32,128,256,hs),new Vt(32,128,258,1024,hs),new Vt(32,258,258,4096,hs)],zf=i=>{i.window_size=2*i.w_size,De(i.head),i.max_lazy_match=an[i.level].max_lazy,i.good_match=an[i.level].good_length,i.nice_match=an[i.level].nice_length,i.max_chain_length=an[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=W-1,i.match_available=0,i.ins_h=0};function Nf(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Er,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(Rf*2),this.dyn_dtree=new Uint16Array((2*Cf+1)*2),this.bl_tree=new Uint16Array((2*Tf+1)*2),De(this.dyn_ltree),De(this.dyn_dtree),De(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Mf+1),this.heap=new Uint16Array(2*al+1),De(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*al+1),De(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Oa=i=>{if(!i)return 1;const e=i.state;return!e||e.strm!==i||e.status!==qs&&e.status!==Jl&&e.status!==rl&&e.status!==ll&&e.status!==ol&&e.status!==hl&&e.status!==xi&&e.status!==nn?1:0},Ch=i=>{if(Oa(i))return Ai(i,ue);i.total_in=i.total_out=0,i.data_type=vf;const e=i.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap===2?Jl:e.wrap?qs:xi,i.adler=e.wrap===2?0:1,e.last_flush=-2,uf(e),lt},Th=i=>{const e=Ch(i);return e===lt&&zf(i.state),e},Bf=(i,e)=>Oa(i)||i.state.wrap!==2?ue:(i.state.gzhead=e,lt),Rh=(i,e,t,s,n,r)=>{if(!i)return ue;let o=1;if(e===gf&&(e=6),s<0?(o=0,s=-s):s>15&&(o=2,s-=16),n<1||n>xf||t!==Er||s<8||s>15||e<0||e>9||r<0||r>wf||s===8&&o!==1)return Ai(i,ue);s===8&&(s=9);const h=new Nf;return i.state=h,h.strm=i,h.status=qs,h.wrap=o,h.gzhead=null,h.w_bits=s,h.w_size=1<<h.w_bits,h.w_mask=h.w_size-1,h.hash_bits=n+7,h.hash_size=1<<h.hash_bits,h.hash_mask=h.hash_size-1,h.hash_shift=~~((h.hash_bits+W-1)/W),h.window=new Uint8Array(h.w_size*2),h.head=new Uint16Array(h.hash_size),h.prev=new Uint16Array(h.w_size),h.lit_bufsize=1<<n+6,h.pending_buf_size=h.lit_bufsize*4,h.pending_buf=new Uint8Array(h.pending_buf_size),h.sym_buf=h.lit_bufsize,h.sym_end=(h.lit_bufsize-1)*3,h.level=e,h.strategy=r,h.method=t,Th(i)},Lf=(i,e)=>Rh(i,e,Er,Af,kf,yf),$f=(i,e)=>{if(Oa(i)||e>co||e<0)return i?Ai(i,ue):ue;const t=i.state;if(!i.output||i.avail_in!==0&&!i.input||t.status===nn&&e!==Nt)return Ai(i,i.avail_out===0?zr:ue);const s=t.last_flush;if(t.last_flush=e,t.pending!==0){if(Ct(i),i.avail_out===0)return t.last_flush=-1,lt}else if(i.avail_in===0&&_o(e)<=_o(s)&&e!==Nt)return Ai(i,zr);if(t.status===nn&&i.avail_in!==0)return Ai(i,zr);if(t.status===qs&&t.wrap===0&&(t.status=xi),t.status===qs){let n=Er+(t.w_bits-8<<4)<<8,r=-1;if(t.strategy>=za||t.level<2?r=0:t.level<6?r=1:t.level===6?r=2:r=3,n|=r<<6,t.strstart!==0&&(n|=Ff),n+=31-n%31,tn(t,n),t.strstart!==0&&(tn(t,i.adler>>>16),tn(t,i.adler&65535)),i.adler=1,t.status=xi,Ct(i),t.pending!==0)return t.last_flush=-1,lt}if(t.status===Jl){if(i.adler=0,q(t,31),q(t,139),q(t,8),t.gzhead)q(t,(t.gzhead.text?1:0)+(t.gzhead.hcrc?2:0)+(t.gzhead.extra?4:0)+(t.gzhead.name?8:0)+(t.gzhead.comment?16:0)),q(t,t.gzhead.time&255),q(t,t.gzhead.time>>8&255),q(t,t.gzhead.time>>16&255),q(t,t.gzhead.time>>24&255),q(t,t.level===9?2:t.strategy>=za||t.level<2?4:0),q(t,t.gzhead.os&255),t.gzhead.extra&&t.gzhead.extra.length&&(q(t,t.gzhead.extra.length&255),q(t,t.gzhead.extra.length>>8&255)),t.gzhead.hcrc&&(i.adler=rt(i.adler,t.pending_buf,t.pending,0)),t.gzindex=0,t.status=rl;else if(q(t,0),q(t,0),q(t,0),q(t,0),q(t,0),q(t,t.level===9?2:t.strategy>=za||t.level<2?4:0),q(t,Of),t.status=xi,Ct(i),t.pending!==0)return t.last_flush=-1,lt}if(t.status===rl){if(t.gzhead.extra){let n=t.pending,r=(t.gzhead.extra.length&65535)-t.gzindex;for(;t.pending+r>t.pending_buf_size;){let h=t.pending_buf_size-t.pending;if(t.pending_buf.set(t.gzhead.extra.subarray(t.gzindex,t.gzindex+h),t.pending),t.pending=t.pending_buf_size,t.gzhead.hcrc&&t.pending>n&&(i.adler=rt(i.adler,t.pending_buf,t.pending-n,n)),t.gzindex+=h,Ct(i),t.pending!==0)return t.last_flush=-1,lt;n=0,r-=h}let o=new Uint8Array(t.gzhead.extra);t.pending_buf.set(o.subarray(t.gzindex,t.gzindex+r),t.pending),t.pending+=r,t.gzhead.hcrc&&t.pending>n&&(i.adler=rt(i.adler,t.pending_buf,t.pending-n,n)),t.gzindex=0}t.status=ll}if(t.status===ll){if(t.gzhead.name){let n=t.pending,r;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>n&&(i.adler=rt(i.adler,t.pending_buf,t.pending-n,n)),Ct(i),t.pending!==0)return t.last_flush=-1,lt;n=0}t.gzindex<t.gzhead.name.length?r=t.gzhead.name.charCodeAt(t.gzindex++)&255:r=0,q(t,r)}while(r!==0);t.gzhead.hcrc&&t.pending>n&&(i.adler=rt(i.adler,t.pending_buf,t.pending-n,n)),t.gzindex=0}t.status=ol}if(t.status===ol){if(t.gzhead.comment){let n=t.pending,r;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>n&&(i.adler=rt(i.adler,t.pending_buf,t.pending-n,n)),Ct(i),t.pending!==0)return t.last_flush=-1,lt;n=0}t.gzindex<t.gzhead.comment.length?r=t.gzhead.comment.charCodeAt(t.gzindex++)&255:r=0,q(t,r)}while(r!==0);t.gzhead.hcrc&&t.pending>n&&(i.adler=rt(i.adler,t.pending_buf,t.pending-n,n))}t.status=hl}if(t.status===hl){if(t.gzhead.hcrc){if(t.pending+2>t.pending_buf_size&&(Ct(i),t.pending!==0))return t.last_flush=-1,lt;q(t,i.adler&255),q(t,i.adler>>8&255),i.adler=0}if(t.status=xi,Ct(i),t.pending!==0)return t.last_flush=-1,lt}if(i.avail_in!==0||t.lookahead!==0||e!==ei&&t.status!==nn){let n=t.level===0?Eh(t,e):t.strategy===za?If(t,e):t.strategy===bf?Uf(t,e):an[t.level].func(t,e);if((n===rs||n===Vs)&&(t.status=nn),n===gt||n===rs)return i.avail_out===0&&(t.last_flush=-1),lt;if(n===Qs&&(e===df?cf(t):e!==co&&(nl(t,0,0,!1),e===pf&&(De(t.head),t.lookahead===0&&(t.strstart=0,t.block_start=0,t.insert=0))),Ct(i),i.avail_out===0))return t.last_flush=-1,lt}return e!==Nt?lt:t.wrap<=0?po:(t.wrap===2?(q(t,i.adler&255),q(t,i.adler>>8&255),q(t,i.adler>>16&255),q(t,i.adler>>24&255),q(t,i.total_in&255),q(t,i.total_in>>8&255),q(t,i.total_in>>16&255),q(t,i.total_in>>24&255)):(tn(t,i.adler>>>16),tn(t,i.adler&65535)),Ct(i),t.wrap>0&&(t.wrap=-t.wrap),t.pending!==0?lt:po)},Gf=i=>{if(Oa(i))return ue;const e=i.state.status;return i.state=null,e===xi?Ai(i,_f):lt},Zf=(i,e)=>{let t=e.length;if(Oa(i))return ue;const s=i.state,n=s.wrap;if(n===2||n===1&&s.status!==qs||s.lookahead)return ue;if(n===1&&(i.adler=yn(i.adler,e,t,0)),s.wrap=0,t>=s.w_size){n===0&&(De(s.head),s.strstart=0,s.block_start=0,s.insert=0);let c=new Uint8Array(s.w_size);c.set(e.subarray(t-s.w_size,t),0),e=c,t=s.w_size}const r=i.avail_in,o=i.next_in,h=i.input;for(i.avail_in=t,i.next_in=0,i.input=e,Ys(s);s.lookahead>=W;){let c=s.strstart,l=s.lookahead-(W-1);do s.ins_h=ii(s,s.ins_h,s.window[c+W-1]),s.prev[c&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=c,c++;while(--l);s.strstart=c,s.lookahead=W-1,Ys(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=W-1,s.match_available=0,i.next_in=o,i.input=h,i.avail_in=r,s.wrap=n,lt};var Hf=Lf,Jf=Rh,Kf=Th,Wf=Ch,qf=Bf,Yf=$f,Xf=Gf,jf=Zf,Qf="pako deflate (from Nodeca project)",hn={deflateInit:Hf,deflateInit2:Jf,deflateReset:Kf,deflateResetKeep:Wf,deflateSetHeader:qf,deflate:Yf,deflateEnd:Xf,deflateSetDictionary:jf,deflateInfo:Qf};const Vf=(i,e)=>Object.prototype.hasOwnProperty.call(i,e);var tc=function(i){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const s in t)Vf(t,s)&&(i[s]=t[s])}}return i},ec=i=>{let e=0;for(let s=0,n=i.length;s<n;s++)e+=i[s].length;const t=new Uint8Array(e);for(let s=0,n=0,r=i.length;s<r;s++){let o=i[s];t.set(o,n),n+=o.length}return t},Cr={assign:tc,flattenChunks:ec};let Mh=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Mh=!1}const vn=new Uint8Array(256);for(let i=0;i<256;i++)vn[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;vn[254]=vn[254]=1;var ic=i=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(i);let e,t,s,n,r,o=i.length,h=0;for(n=0;n<o;n++)t=i.charCodeAt(n),(t&64512)===55296&&n+1<o&&(s=i.charCodeAt(n+1),(s&64512)===56320&&(t=65536+(t-55296<<10)+(s-56320),n++)),h+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(h),r=0,n=0;r<h;n++)t=i.charCodeAt(n),(t&64512)===55296&&n+1<o&&(s=i.charCodeAt(n+1),(s&64512)===56320&&(t=65536+(t-55296<<10)+(s-56320),n++)),t<128?e[r++]=t:t<2048?(e[r++]=192|t>>>6,e[r++]=128|t&63):t<65536?(e[r++]=224|t>>>12,e[r++]=128|t>>>6&63,e[r++]=128|t&63):(e[r++]=240|t>>>18,e[r++]=128|t>>>12&63,e[r++]=128|t>>>6&63,e[r++]=128|t&63);return e};const sc=(i,e)=>{if(e<65534&&i.subarray&&Mh)return String.fromCharCode.apply(null,i.length===e?i:i.subarray(0,e));let t="";for(let s=0;s<e;s++)t+=String.fromCharCode(i[s]);return t};var nc=(i,e)=>{const t=e||i.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(i.subarray(0,e));let s,n;const r=new Array(t*2);for(n=0,s=0;s<t;){let o=i[s++];if(o<128){r[n++]=o;continue}let h=vn[o];if(h>4){r[n++]=65533,s+=h-1;continue}for(o&=h===2?31:h===3?15:7;h>1&&s<t;)o=o<<6|i[s++]&63,h--;if(h>1){r[n++]=65533;continue}o<65536?r[n++]=o:(o-=65536,r[n++]=55296|o>>10&1023,r[n++]=56320|o&1023)}return sc(r,n)},ac=(i,e)=>{e=e||i.length,e>i.length&&(e=i.length);let t=e-1;for(;t>=0&&(i[t]&192)===128;)t--;return t<0||t===0?e:t+vn[i[t]]>e?t:e},xn={string2buf:ic,buf2string:nc,utf8border:ac};function rc(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Fh=rc;const Oh=Object.prototype.toString,{Z_NO_FLUSH:lc,Z_SYNC_FLUSH:oc,Z_FULL_FLUSH:hc,Z_FINISH:uc,Z_OK:ir,Z_STREAM_END:fc,Z_DEFAULT_COMPRESSION:cc,Z_DEFAULT_STRATEGY:dc,Z_DEFLATED:pc}=Fa;function Kl(i){this.options=Cr.assign({level:cc,method:pc,chunkSize:16384,windowBits:15,memLevel:8,strategy:dc},i||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Fh,this.strm.avail_out=0;let t=hn.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(t!==ir)throw new Error(Ws[t]);if(e.header&&hn.deflateSetHeader(this.strm,e.header),e.dictionary){let s;if(typeof e.dictionary=="string"?s=xn.string2buf(e.dictionary):Oh.call(e.dictionary)==="[object ArrayBuffer]"?s=new Uint8Array(e.dictionary):s=e.dictionary,t=hn.deflateSetDictionary(this.strm,s),t!==ir)throw new Error(Ws[t]);this._dict_set=!0}}Kl.prototype.push=function(i,e){const t=this.strm,s=this.options.chunkSize;let n,r;if(this.ended)return!1;for(e===~~e?r=e:r=e===!0?uc:lc,typeof i=="string"?t.input=xn.string2buf(i):Oh.call(i)==="[object ArrayBuffer]"?t.input=new Uint8Array(i):t.input=i,t.next_in=0,t.avail_in=t.input.length;;){if(t.avail_out===0&&(t.output=new Uint8Array(s),t.next_out=0,t.avail_out=s),(r===oc||r===hc)&&t.avail_out<=6){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(n=hn.deflate(t,r),n===fc)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),n=hn.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===ir;if(t.avail_out===0){this.onData(t.output);continue}if(r>0&&t.next_out>0){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(t.avail_in===0)break}return!0};Kl.prototype.onData=function(i){this.chunks.push(i)};Kl.prototype.onEnd=function(i){i===ir&&(this.result=Cr.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};const Na=16209,_c=16191;var gc=function(e,t){let s,n,r,o,h,c,l,f,m,g,p,y,N,D,R,I,B,x,H,G,C,Y,J,Z;const K=e.state;s=e.next_in,J=e.input,n=s+(e.avail_in-5),r=e.next_out,Z=e.output,o=r-(t-e.avail_out),h=r+(e.avail_out-257),c=K.dmax,l=K.wsize,f=K.whave,m=K.wnext,g=K.window,p=K.hold,y=K.bits,N=K.lencode,D=K.distcode,R=(1<<K.lenbits)-1,I=(1<<K.distbits)-1;t:do{y<15&&(p+=J[s++]<<y,y+=8,p+=J[s++]<<y,y+=8),B=N[p&R];e:for(;;){if(x=B>>>24,p>>>=x,y-=x,x=B>>>16&255,x===0)Z[r++]=B&65535;else if(x&16){H=B&65535,x&=15,x&&(y<x&&(p+=J[s++]<<y,y+=8),H+=p&(1<<x)-1,p>>>=x,y-=x),y<15&&(p+=J[s++]<<y,y+=8,p+=J[s++]<<y,y+=8),B=D[p&I];i:for(;;){if(x=B>>>24,p>>>=x,y-=x,x=B>>>16&255,x&16){if(G=B&65535,x&=15,y<x&&(p+=J[s++]<<y,y+=8,y<x&&(p+=J[s++]<<y,y+=8)),G+=p&(1<<x)-1,G>c){e.msg="invalid distance too far back",K.mode=Na;break t}if(p>>>=x,y-=x,x=r-o,G>x){if(x=G-x,x>f&&K.sane){e.msg="invalid distance too far back",K.mode=Na;break t}if(C=0,Y=g,m===0){if(C+=l-x,x<H){H-=x;do Z[r++]=g[C++];while(--x);C=r-G,Y=Z}}else if(m<x){if(C+=l+m-x,x-=m,x<H){H-=x;do Z[r++]=g[C++];while(--x);if(C=0,m<H){x=m,H-=x;do Z[r++]=g[C++];while(--x);C=r-G,Y=Z}}}else if(C+=m-x,x<H){H-=x;do Z[r++]=g[C++];while(--x);C=r-G,Y=Z}for(;H>2;)Z[r++]=Y[C++],Z[r++]=Y[C++],Z[r++]=Y[C++],H-=3;H&&(Z[r++]=Y[C++],H>1&&(Z[r++]=Y[C++]))}else{C=r-G;do Z[r++]=Z[C++],Z[r++]=Z[C++],Z[r++]=Z[C++],H-=3;while(H>2);H&&(Z[r++]=Z[C++],H>1&&(Z[r++]=Z[C++]))}}else if(x&64){e.msg="invalid distance code",K.mode=Na;break t}else{B=D[(B&65535)+(p&(1<<x)-1)];continue i}break}}else if(x&64)if(x&32){K.mode=_c;break t}else{e.msg="invalid literal/length code",K.mode=Na;break t}else{B=N[(B&65535)+(p&(1<<x)-1)];continue e}break}}while(s<n&&r<h);H=y>>3,s-=H,y-=H<<3,p&=(1<<y)-1,e.next_in=s,e.next_out=r,e.avail_in=s<n?5+(n-s):5-(s-n),e.avail_out=r<h?257+(h-r):257-(r-h),K.hold=p,K.bits=y};const us=15,go=852,mo=592,bo=0,Br=1,wo=2,mc=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),bc=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),wc=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),yc=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),vc=(i,e,t,s,n,r,o,h)=>{const c=h.bits;let l=0,f=0,m=0,g=0,p=0,y=0,N=0,D=0,R=0,I=0,B,x,H,G,C,Y=null,J;const Z=new Uint16Array(us+1),K=new Uint16Array(us+1);let Gt=null,so,Ua,Ia;for(l=0;l<=us;l++)Z[l]=0;for(f=0;f<s;f++)Z[e[t+f]]++;for(p=c,g=us;g>=1&&Z[g]===0;g--);if(p>g&&(p=g),g===0)return n[r++]=1<<24|64<<16|0,n[r++]=1<<24|64<<16|0,h.bits=1,0;for(m=1;m<g&&Z[m]===0;m++);for(p<m&&(p=m),D=1,l=1;l<=us;l++)if(D<<=1,D-=Z[l],D<0)return-1;if(D>0&&(i===bo||g!==1))return-1;for(K[1]=0,l=1;l<us;l++)K[l+1]=K[l]+Z[l];for(f=0;f<s;f++)e[t+f]!==0&&(o[K[e[t+f]]++]=f);if(i===bo?(Y=Gt=o,J=20):i===Br?(Y=mc,Gt=bc,J=257):(Y=wc,Gt=yc,J=0),I=0,f=0,l=m,C=r,y=p,N=0,H=-1,R=1<<p,G=R-1,i===Br&&R>go||i===wo&&R>mo)return 1;for(;;){so=l-N,o[f]+1<J?(Ua=0,Ia=o[f]):o[f]>=J?(Ua=Gt[o[f]-J],Ia=Y[o[f]-J]):(Ua=96,Ia=0),B=1<<l-N,x=1<<y,m=x;do x-=B,n[C+(I>>N)+x]=so<<24|Ua<<16|Ia|0;while(x!==0);for(B=1<<l-1;I&B;)B>>=1;if(B!==0?(I&=B-1,I+=B):I=0,f++,--Z[l]===0){if(l===g)break;l=e[t+o[f]]}if(l>p&&(I&G)!==H){for(N===0&&(N=p),C+=m,y=l-N,D=1<<y;y+N<g&&(D-=Z[y+N],!(D<=0));)y++,D<<=1;if(R+=1<<y,i===Br&&R>go||i===wo&&R>mo)return 1;H=I&G,n[H]=p<<24|y<<16|C-r|0}}return I!==0&&(n[C+I]=l-N<<24|64<<16|0),h.bits=p,0};var un=vc;const xc=0,Dh=1,Ph=2,{Z_FINISH:yo,Z_BLOCK:Ac,Z_TREES:Ba,Z_OK:ls,Z_STREAM_END:kc,Z_NEED_DICT:Sc,Z_STREAM_ERROR:Lt,Z_DATA_ERROR:Uh,Z_MEM_ERROR:Ih,Z_BUF_ERROR:Ec,Z_DEFLATED:vo}=Fa,Tr=16180,xo=16181,Ao=16182,ko=16183,So=16184,Eo=16185,Co=16186,To=16187,Ro=16188,Mo=16189,sr=16190,ce=16191,Lr=16192,Fo=16193,$r=16194,Oo=16195,Do=16196,Po=16197,Uo=16198,La=16199,$a=16200,Io=16201,zo=16202,No=16203,Bo=16204,Lo=16205,Gr=16206,$o=16207,Go=16208,Q=16209,zh=16210,Nh=16211,Cc=852,Tc=592,Rc=15,Mc=Rc,Zo=i=>(i>>>24&255)+(i>>>8&65280)+((i&65280)<<8)+((i&255)<<24);function Fc(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const os=i=>{if(!i)return 1;const e=i.state;return!e||e.strm!==i||e.mode<Tr||e.mode>Nh?1:0},Bh=i=>{if(os(i))return Lt;const e=i.state;return i.total_in=i.total_out=e.total=0,i.msg="",e.wrap&&(i.adler=e.wrap&1),e.mode=Tr,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Cc),e.distcode=e.distdyn=new Int32Array(Tc),e.sane=1,e.back=-1,ls},Lh=i=>{if(os(i))return Lt;const e=i.state;return e.wsize=0,e.whave=0,e.wnext=0,Bh(i)},$h=(i,e)=>{let t;if(os(i))return Lt;const s=i.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Lt:(s.window!==null&&s.wbits!==e&&(s.window=null),s.wrap=t,s.wbits=e,Lh(i))},Gh=(i,e)=>{if(!i)return Lt;const t=new Fc;i.state=t,t.strm=i,t.window=null,t.mode=Tr;const s=$h(i,e);return s!==ls&&(i.state=null),s},Oc=i=>Gh(i,Mc);let Ho=!0,Zr,Hr;const Dc=i=>{if(Ho){Zr=new Int32Array(512),Hr=new Int32Array(32);let e=0;for(;e<144;)i.lens[e++]=8;for(;e<256;)i.lens[e++]=9;for(;e<280;)i.lens[e++]=7;for(;e<288;)i.lens[e++]=8;for(un(Dh,i.lens,0,288,Zr,0,i.work,{bits:9}),e=0;e<32;)i.lens[e++]=5;un(Ph,i.lens,0,32,Hr,0,i.work,{bits:5}),Ho=!1}i.lencode=Zr,i.lenbits=9,i.distcode=Hr,i.distbits=5},Zh=(i,e,t,s)=>{let n;const r=i.state;return r.window===null&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),s>=r.wsize?(r.window.set(e.subarray(t-r.wsize,t),0),r.wnext=0,r.whave=r.wsize):(n=r.wsize-r.wnext,n>s&&(n=s),r.window.set(e.subarray(t-s,t-s+n),r.wnext),s-=n,s?(r.window.set(e.subarray(t-s,t),0),r.wnext=s,r.whave=r.wsize):(r.wnext+=n,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=n))),0},Pc=(i,e)=>{let t,s,n,r,o,h,c,l,f,m,g,p,y,N,D=0,R,I,B,x,H,G,C,Y;const J=new Uint8Array(4);let Z,K;const Gt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(os(i)||!i.output||!i.input&&i.avail_in!==0)return Lt;t=i.state,t.mode===ce&&(t.mode=Lr),o=i.next_out,n=i.output,c=i.avail_out,r=i.next_in,s=i.input,h=i.avail_in,l=t.hold,f=t.bits,m=h,g=c,Y=ls;t:for(;;)switch(t.mode){case Tr:if(t.wrap===0){t.mode=Lr;break}for(;f<16;){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}if(t.wrap&2&&l===35615){t.wbits===0&&(t.wbits=15),t.check=0,J[0]=l&255,J[1]=l>>>8&255,t.check=rt(t.check,J,2,0),l=0,f=0,t.mode=xo;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((l&255)<<8)+(l>>8))%31){i.msg="incorrect header check",t.mode=Q;break}if((l&15)!==vo){i.msg="unknown compression method",t.mode=Q;break}if(l>>>=4,f-=4,C=(l&15)+8,t.wbits===0&&(t.wbits=C),C>15||C>t.wbits){i.msg="invalid window size",t.mode=Q;break}t.dmax=1<<t.wbits,t.flags=0,i.adler=t.check=1,t.mode=l&512?Mo:ce,l=0,f=0;break;case xo:for(;f<16;){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}if(t.flags=l,(t.flags&255)!==vo){i.msg="unknown compression method",t.mode=Q;break}if(t.flags&57344){i.msg="unknown header flags set",t.mode=Q;break}t.head&&(t.head.text=l>>8&1),t.flags&512&&t.wrap&4&&(J[0]=l&255,J[1]=l>>>8&255,t.check=rt(t.check,J,2,0)),l=0,f=0,t.mode=Ao;case Ao:for(;f<32;){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}t.head&&(t.head.time=l),t.flags&512&&t.wrap&4&&(J[0]=l&255,J[1]=l>>>8&255,J[2]=l>>>16&255,J[3]=l>>>24&255,t.check=rt(t.check,J,4,0)),l=0,f=0,t.mode=ko;case ko:for(;f<16;){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}t.head&&(t.head.xflags=l&255,t.head.os=l>>8),t.flags&512&&t.wrap&4&&(J[0]=l&255,J[1]=l>>>8&255,t.check=rt(t.check,J,2,0)),l=0,f=0,t.mode=So;case So:if(t.flags&1024){for(;f<16;){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}t.length=l,t.head&&(t.head.extra_len=l),t.flags&512&&t.wrap&4&&(J[0]=l&255,J[1]=l>>>8&255,t.check=rt(t.check,J,2,0)),l=0,f=0}else t.head&&(t.head.extra=null);t.mode=Eo;case Eo:if(t.flags&1024&&(p=t.length,p>h&&(p=h),p&&(t.head&&(C=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(s.subarray(r,r+p),C)),t.flags&512&&t.wrap&4&&(t.check=rt(t.check,s,p,r)),h-=p,r+=p,t.length-=p),t.length))break t;t.length=0,t.mode=Co;case Co:if(t.flags&2048){if(h===0)break t;p=0;do C=s[r+p++],t.head&&C&&t.length<65536&&(t.head.name+=String.fromCharCode(C));while(C&&p<h);if(t.flags&512&&t.wrap&4&&(t.check=rt(t.check,s,p,r)),h-=p,r+=p,C)break t}else t.head&&(t.head.name=null);t.length=0,t.mode=To;case To:if(t.flags&4096){if(h===0)break t;p=0;do C=s[r+p++],t.head&&C&&t.length<65536&&(t.head.comment+=String.fromCharCode(C));while(C&&p<h);if(t.flags&512&&t.wrap&4&&(t.check=rt(t.check,s,p,r)),h-=p,r+=p,C)break t}else t.head&&(t.head.comment=null);t.mode=Ro;case Ro:if(t.flags&512){for(;f<16;){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}if(t.wrap&4&&l!==(t.check&65535)){i.msg="header crc mismatch",t.mode=Q;break}l=0,f=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),i.adler=t.check=0,t.mode=ce;break;case Mo:for(;f<32;){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}i.adler=t.check=Zo(l),l=0,f=0,t.mode=sr;case sr:if(t.havedict===0)return i.next_out=o,i.avail_out=c,i.next_in=r,i.avail_in=h,t.hold=l,t.bits=f,Sc;i.adler=t.check=1,t.mode=ce;case ce:if(e===Ac||e===Ba)break t;case Lr:if(t.last){l>>>=f&7,f-=f&7,t.mode=Gr;break}for(;f<3;){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}switch(t.last=l&1,l>>>=1,f-=1,l&3){case 0:t.mode=Fo;break;case 1:if(Dc(t),t.mode=La,e===Ba){l>>>=2,f-=2;break t}break;case 2:t.mode=Do;break;case 3:i.msg="invalid block type",t.mode=Q}l>>>=2,f-=2;break;case Fo:for(l>>>=f&7,f-=f&7;f<32;){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}if((l&65535)!==(l>>>16^65535)){i.msg="invalid stored block lengths",t.mode=Q;break}if(t.length=l&65535,l=0,f=0,t.mode=$r,e===Ba)break t;case $r:t.mode=Oo;case Oo:if(p=t.length,p){if(p>h&&(p=h),p>c&&(p=c),p===0)break t;n.set(s.subarray(r,r+p),o),h-=p,r+=p,c-=p,o+=p,t.length-=p;break}t.mode=ce;break;case Do:for(;f<14;){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}if(t.nlen=(l&31)+257,l>>>=5,f-=5,t.ndist=(l&31)+1,l>>>=5,f-=5,t.ncode=(l&15)+4,l>>>=4,f-=4,t.nlen>286||t.ndist>30){i.msg="too many length or distance symbols",t.mode=Q;break}t.have=0,t.mode=Po;case Po:for(;t.have<t.ncode;){for(;f<3;){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}t.lens[Gt[t.have++]]=l&7,l>>>=3,f-=3}for(;t.have<19;)t.lens[Gt[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,Z={bits:t.lenbits},Y=un(xc,t.lens,0,19,t.lencode,0,t.work,Z),t.lenbits=Z.bits,Y){i.msg="invalid code lengths set",t.mode=Q;break}t.have=0,t.mode=Uo;case Uo:for(;t.have<t.nlen+t.ndist;){for(;D=t.lencode[l&(1<<t.lenbits)-1],R=D>>>24,I=D>>>16&255,B=D&65535,!(R<=f);){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}if(B<16)l>>>=R,f-=R,t.lens[t.have++]=B;else{if(B===16){for(K=R+2;f<K;){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}if(l>>>=R,f-=R,t.have===0){i.msg="invalid bit length repeat",t.mode=Q;break}C=t.lens[t.have-1],p=3+(l&3),l>>>=2,f-=2}else if(B===17){for(K=R+3;f<K;){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}l>>>=R,f-=R,C=0,p=3+(l&7),l>>>=3,f-=3}else{for(K=R+7;f<K;){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}l>>>=R,f-=R,C=0,p=11+(l&127),l>>>=7,f-=7}if(t.have+p>t.nlen+t.ndist){i.msg="invalid bit length repeat",t.mode=Q;break}for(;p--;)t.lens[t.have++]=C}}if(t.mode===Q)break;if(t.lens[256]===0){i.msg="invalid code -- missing end-of-block",t.mode=Q;break}if(t.lenbits=9,Z={bits:t.lenbits},Y=un(Dh,t.lens,0,t.nlen,t.lencode,0,t.work,Z),t.lenbits=Z.bits,Y){i.msg="invalid literal/lengths set",t.mode=Q;break}if(t.distbits=6,t.distcode=t.distdyn,Z={bits:t.distbits},Y=un(Ph,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,Z),t.distbits=Z.bits,Y){i.msg="invalid distances set",t.mode=Q;break}if(t.mode=La,e===Ba)break t;case La:t.mode=$a;case $a:if(h>=6&&c>=258){i.next_out=o,i.avail_out=c,i.next_in=r,i.avail_in=h,t.hold=l,t.bits=f,gc(i,g),o=i.next_out,n=i.output,c=i.avail_out,r=i.next_in,s=i.input,h=i.avail_in,l=t.hold,f=t.bits,t.mode===ce&&(t.back=-1);break}for(t.back=0;D=t.lencode[l&(1<<t.lenbits)-1],R=D>>>24,I=D>>>16&255,B=D&65535,!(R<=f);){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}if(I&&!(I&240)){for(x=R,H=I,G=B;D=t.lencode[G+((l&(1<<x+H)-1)>>x)],R=D>>>24,I=D>>>16&255,B=D&65535,!(x+R<=f);){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}l>>>=x,f-=x,t.back+=x}if(l>>>=R,f-=R,t.back+=R,t.length=B,I===0){t.mode=Lo;break}if(I&32){t.back=-1,t.mode=ce;break}if(I&64){i.msg="invalid literal/length code",t.mode=Q;break}t.extra=I&15,t.mode=Io;case Io:if(t.extra){for(K=t.extra;f<K;){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}t.length+=l&(1<<t.extra)-1,l>>>=t.extra,f-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=zo;case zo:for(;D=t.distcode[l&(1<<t.distbits)-1],R=D>>>24,I=D>>>16&255,B=D&65535,!(R<=f);){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}if(!(I&240)){for(x=R,H=I,G=B;D=t.distcode[G+((l&(1<<x+H)-1)>>x)],R=D>>>24,I=D>>>16&255,B=D&65535,!(x+R<=f);){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}l>>>=x,f-=x,t.back+=x}if(l>>>=R,f-=R,t.back+=R,I&64){i.msg="invalid distance code",t.mode=Q;break}t.offset=B,t.extra=I&15,t.mode=No;case No:if(t.extra){for(K=t.extra;f<K;){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}t.offset+=l&(1<<t.extra)-1,l>>>=t.extra,f-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){i.msg="invalid distance too far back",t.mode=Q;break}t.mode=Bo;case Bo:if(c===0)break t;if(p=g-c,t.offset>p){if(p=t.offset-p,p>t.whave&&t.sane){i.msg="invalid distance too far back",t.mode=Q;break}p>t.wnext?(p-=t.wnext,y=t.wsize-p):y=t.wnext-p,p>t.length&&(p=t.length),N=t.window}else N=n,y=o-t.offset,p=t.length;p>c&&(p=c),c-=p,t.length-=p;do n[o++]=N[y++];while(--p);t.length===0&&(t.mode=$a);break;case Lo:if(c===0)break t;n[o++]=t.length,c--,t.mode=$a;break;case Gr:if(t.wrap){for(;f<32;){if(h===0)break t;h--,l|=s[r++]<<f,f+=8}if(g-=c,i.total_out+=g,t.total+=g,t.wrap&4&&g&&(i.adler=t.check=t.flags?rt(t.check,n,g,o-g):yn(t.check,n,g,o-g)),g=c,t.wrap&4&&(t.flags?l:Zo(l))!==t.check){i.msg="incorrect data check",t.mode=Q;break}l=0,f=0}t.mode=$o;case $o:if(t.wrap&&t.flags){for(;f<32;){if(h===0)break t;h--,l+=s[r++]<<f,f+=8}if(t.wrap&4&&l!==(t.total&4294967295)){i.msg="incorrect length check",t.mode=Q;break}l=0,f=0}t.mode=Go;case Go:Y=kc;break t;case Q:Y=Uh;break t;case zh:return Ih;case Nh:default:return Lt}return i.next_out=o,i.avail_out=c,i.next_in=r,i.avail_in=h,t.hold=l,t.bits=f,(t.wsize||g!==i.avail_out&&t.mode<Q&&(t.mode<Gr||e!==yo))&&Zh(i,i.output,i.next_out,g-i.avail_out),m-=i.avail_in,g-=i.avail_out,i.total_in+=m,i.total_out+=g,t.total+=g,t.wrap&4&&g&&(i.adler=t.check=t.flags?rt(t.check,n,g,i.next_out-g):yn(t.check,n,g,i.next_out-g)),i.data_type=t.bits+(t.last?64:0)+(t.mode===ce?128:0)+(t.mode===La||t.mode===$r?256:0),(m===0&&g===0||e===yo)&&Y===ls&&(Y=Ec),Y},Uc=i=>{if(os(i))return Lt;let e=i.state;return e.window&&(e.window=null),i.state=null,ls},Ic=(i,e)=>{if(os(i))return Lt;const t=i.state;return t.wrap&2?(t.head=e,e.done=!1,ls):Lt},zc=(i,e)=>{const t=e.length;let s,n,r;return os(i)||(s=i.state,s.wrap!==0&&s.mode!==sr)?Lt:s.mode===sr&&(n=1,n=yn(n,e,t,0),n!==s.check)?Uh:(r=Zh(i,e,t,t),r?(s.mode=zh,Ih):(s.havedict=1,ls))};var Nc=Lh,Bc=$h,Lc=Bh,$c=Oc,Gc=Gh,Zc=Pc,Hc=Uc,Jc=Ic,Kc=zc,Wc="pako inflate (from Nodeca project)",_e={inflateReset:Nc,inflateReset2:Bc,inflateResetKeep:Lc,inflateInit:$c,inflateInit2:Gc,inflate:Zc,inflateEnd:Hc,inflateGetHeader:Jc,inflateSetDictionary:Kc,inflateInfo:Wc};function qc(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Yc=qc;const Hh=Object.prototype.toString,{Z_NO_FLUSH:Xc,Z_FINISH:jc,Z_OK:An,Z_STREAM_END:Jr,Z_NEED_DICT:Kr,Z_STREAM_ERROR:Qc,Z_DATA_ERROR:Jo,Z_MEM_ERROR:Vc}=Fa;function Da(i){this.options=Cr.assign({chunkSize:1024*64,windowBits:15,to:""},i||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(i&&i.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Fh,this.strm.avail_out=0;let t=_e.inflateInit2(this.strm,e.windowBits);if(t!==An)throw new Error(Ws[t]);if(this.header=new Yc,_e.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=xn.string2buf(e.dictionary):Hh.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=_e.inflateSetDictionary(this.strm,e.dictionary),t!==An)))throw new Error(Ws[t])}Da.prototype.push=function(i,e){const t=this.strm,s=this.options.chunkSize,n=this.options.dictionary;let r,o,h;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?jc:Xc,Hh.call(i)==="[object ArrayBuffer]"?t.input=new Uint8Array(i):t.input=i,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(s),t.next_out=0,t.avail_out=s),r=_e.inflate(t,o),r===Kr&&n&&(r=_e.inflateSetDictionary(t,n),r===An?r=_e.inflate(t,o):r===Jo&&(r=Kr));t.avail_in>0&&r===Jr&&t.state.wrap>0&&i[t.next_in]!==0;)_e.inflateReset(t),r=_e.inflate(t,o);switch(r){case Qc:case Jo:case Kr:case Vc:return this.onEnd(r),this.ended=!0,!1}if(h=t.avail_out,t.next_out&&(t.avail_out===0||r===Jr))if(this.options.to==="string"){let c=xn.utf8border(t.output,t.next_out),l=t.next_out-c,f=xn.buf2string(t.output,c);t.next_out=l,t.avail_out=s-l,l&&t.output.set(t.output.subarray(c,c+l),0),this.onData(f)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(r===An&&h===0)){if(r===Jr)return r=_e.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};Da.prototype.onData=function(i){this.chunks.push(i)};Da.prototype.onEnd=function(i){i===An&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Cr.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};function Wl(i,e){const t=new Da(e);if(t.push(i),t.err)throw t.msg||Ws[t.err];return t.result}function td(i,e){return e=e||{},e.raw=!0,Wl(i,e)}var ed=Da,id=Wl,sd=td,nd=Wl,ad=Fa,rd={Inflate:ed,inflate:id,inflateRaw:sd,ungzip:nd,constants:ad};const{Inflate:ld,inflate:od,inflateRaw:Dp,ungzip:Pp}=rd;var hd=ld,ud=od;const Wr=[137,80,78,71,13,10,26,10],Jh=[];for(let i=0;i<256;i++){let e=i;for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e=e>>>1;Jh[i]=e}const Ko=4294967295;function fd(i,e,t){let s=i;for(let n=0;n<t;n++)s=Jh[(s^e[n])&255]^s>>>8;return s}function cd(i,e){return(fd(Ko,i,e)^Ko)>>>0}var Zt;(function(i){i[i.UNKNOWN=-1]="UNKNOWN",i[i.GREYSCALE=0]="GREYSCALE",i[i.TRUECOLOUR=2]="TRUECOLOUR",i[i.INDEXED_COLOUR=3]="INDEXED_COLOUR",i[i.GREYSCALE_ALPHA=4]="GREYSCALE_ALPHA",i[i.TRUECOLOUR_ALPHA=6]="TRUECOLOUR_ALPHA"})(Zt||(Zt={}));var fn;(function(i){i[i.UNKNOWN=-1]="UNKNOWN",i[i.DEFLATE=0]="DEFLATE"})(fn||(fn={}));var nr;(function(i){i[i.UNKNOWN=-1]="UNKNOWN",i[i.ADAPTIVE=0]="ADAPTIVE"})(nr||(nr={}));var ar;(function(i){i[i.UNKNOWN=-1]="UNKNOWN",i[i.NO_INTERLACE=0]="NO_INTERLACE",i[i.ADAM7=1]="ADAM7"})(ar||(ar={}));const dd=new Uint8Array(0),Wo="\0",pd=new Uint16Array([255]),_d=new Uint8Array(pd.buffer),gd=_d[0]===255;class md extends Ll{constructor(e,t={}){super(e);const{checkCrc:s=!1}=t;this._checkCrc=s,this._inflator=new hd,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=fn.UNKNOWN,this._filterMethod=nr.UNKNOWN,this._interlaceMethod=ar.UNKNOWN,this._colorType=Zt.UNKNOWN,this.setBigEndian()}decode(){for(this.decodeSignature();!this._end;)this.decodeChunk();return this.decodeImage(),this._png}decodeSignature(){for(let e=0;e<Wr.length;e++)if(this.readUint8()!==Wr[e])throw new Error(`wrong PNG signature. Byte at ${e} should be ${Wr[e]}.`)}decodeChunk(){const e=this.readUint32(),t=this.readChars(4),s=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case"tEXt":this.decodetEXt(e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-s!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);if(this._checkCrc){const n=this.readUint32(),r=e+4,o=cd(new Uint8Array(this.buffer,this.byteOffset+this.offset-r-4,r),r);if(o!==n)throw new Error(`CRC mismatch for chunk ${t}. Expected ${n}, found ${o}`)}else this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=Sd(this.readUint8());const t=this.readUint8();this._colorType=t;let s;switch(t){case Zt.GREYSCALE:s=1;break;case Zt.TRUECOLOUR:s=3;break;case Zt.INDEXED_COLOUR:s=1;break;case Zt.GREYSCALE_ALPHA:s=2;break;case Zt.TRUECOLOUR_ALPHA:s=4;break;default:throw new Error(`Unknown color type: ${t}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==fn.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const t=e/3;this._hasPalette=!0;const s=[];this._palette=s;for(let n=0;n<t;n++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._inflator.push(new Uint8Array(this.buffer,this.offset+this.byteOffset,e)),this.skip(e)}decodetRNS(e){switch(this._colorType){case Zt.GREYSCALE:case Zt.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let t=0;t<e/2;t++)this._transparency[t]=this.readUint16();break}case Zt.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let t=0;for(;t<e;t++){const s=this.readByte();this._palette[t].push(s)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){let t="",s;for(;(s=this.readChar())!==Wo;)t+=s;const n=this.readUint8();if(n!==fn.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const r=this.readBytes(e-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:ud(r)}}decodetEXt(e){let t="",s;for(;(s=this.readChar())!==Wo;)t+=s;this._png.text[t]=this.readChars(e-t.length-1)}decodepHYs(){const e=this.readUint32(),t=this.readUint32(),s=this.readByte();this._png.resolution={x:e,y:t,unit:s}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._inflator.result;if(this._filterMethod!==nr.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===ar.NO_INTERLACE)this.decodeInterlaceNull(e);else throw new Error(`Interlace method ${this._interlaceMethod} not supported`)}decodeInterlaceNull(e){const t=this._png.height,s=this._png.channels*this._png.depth/8,n=this._png.width*s,r=new Uint8Array(this._png.height*n);let o=dd,h=0,c,l;for(let f=0;f<t;f++){switch(c=e.subarray(h+1,h+1+n),l=r.subarray(f*n,(f+1)*n),e[h]){case 0:bd(c,l,n);break;case 1:wd(c,l,n,s);break;case 2:yd(c,l,o,n);break;case 3:vd(c,l,o,n,s);break;case 4:xd(c,l,o,n,s);break;default:throw new Error(`Unsupported filter: ${e[h]}`)}o=l,h+=n+1}if(this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency),this._png.depth===16){const f=new Uint16Array(r.buffer);if(gd)for(let m=0;m<f.length;m++)f[m]=kd(f[m]);this._png.data=f}else this._png.data=r}}function bd(i,e,t){for(let s=0;s<t;s++)e[s]=i[s]}function wd(i,e,t,s){let n=0;for(;n<s;n++)e[n]=i[n];for(;n<t;n++)e[n]=i[n]+e[n-s]&255}function yd(i,e,t,s){let n=0;if(t.length===0)for(;n<s;n++)e[n]=i[n];else for(;n<s;n++)e[n]=i[n]+t[n]&255}function vd(i,e,t,s,n){let r=0;if(t.length===0){for(;r<n;r++)e[r]=i[r];for(;r<s;r++)e[r]=i[r]+(e[r-n]>>1)&255}else{for(;r<n;r++)e[r]=i[r]+(t[r]>>1)&255;for(;r<s;r++)e[r]=i[r]+(e[r-n]+t[r]>>1)&255}}function xd(i,e,t,s,n){let r=0;if(t.length===0){for(;r<n;r++)e[r]=i[r];for(;r<s;r++)e[r]=i[r]+e[r-n]&255}else{for(;r<n;r++)e[r]=i[r]+t[r]&255;for(;r<s;r++)e[r]=i[r]+Ad(e[r-n],t[r],t[r-n])&255}}function Ad(i,e,t){const s=i+e-t,n=Math.abs(s-i),r=Math.abs(s-e),o=Math.abs(s-t);return n<=r&&n<=o?i:r<=o?e:t}function kd(i){return(i&255)<<8|i>>8&255}function Sd(i){if(i!==1&&i!==2&&i!==4&&i!==8&&i!==16)throw new Error(`invalid bit depth: ${i}`);return i}var qo;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.METRE=1]="METRE"})(qo||(qo={}));function Ed(i,e){return new md(i,e).decode()}var _s,Fn,Pe;class Qt{static loadFromStorage(){_(this,Pe,window.localStorage.getItem(a(this,_s))!==a(this,Fn)),$.updateDebugClass(this.enabled)}static get enabled(){return a(this,Pe)}static set enabled(e){_(this,Pe,e),L.infoBeetPx(`Debug flag set to: ${a(this,Pe)}`),$.updateDebugClass(this.enabled),a(this,Pe)?window.localStorage.removeItem(a(this,_s)):window.localStorage.setItem(a(this,_s),a(this,Fn))}}_s=new WeakMap,Fn=new WeakMap,Pe=new WeakMap,d(Qt,_s,"beetpx__debug_disabled"),d(Qt,Fn,"yes"),d(Qt,Pe,!1);var Si;const Ht=class Ht{static debugBeetPx(...e){Ht.debug(a(Ht,Si),...e)}static debug(...e){Qt.enabled&&console.debug(...e.map(t=>t.__printDebug?t.__printDebug():t))}static infoBeetPx(...e){Ht.info(a(Ht,Si),...e)}static info(...e){console.info(...e.map(t=>t.__printDebug?t.__printDebug():t))}static warnBeetPx(...e){Ht.warn(a(Ht,Si),...e)}static warn(...e){console.warn(...e.map(t=>t.__printDebug?t.__printDebug():t))}static errorBeetPx(...e){Ht.error(a(Ht,Si),...e)}static error(...e){console.error(...e.map(t=>t.__printDebug?t.__printDebug():t))}};Si=new WeakMap,d(Ht,Si,"[BeetPx]");let L=Ht;var Ei,On,Dn,fl,Pn,cl,Un,dl,lr,Kh,or,Wh,hr,qh,gs,ja;class Cd{constructor(e,t){d(this,Dn);d(this,Pn);d(this,Un);d(this,lr);d(this,or);d(this,hr);d(this,gs);d(this,Ei,void 0);d(this,On,void 0);_(this,Ei,e),_(this,On,t.decodeAudioData)}async loadAssets(e){const t=e.map(n=>n.trim()).filter(n=>n.length>0),s=t.filter(n=>!u(this,Dn,fl).call(this,n)&&!u(this,Pn,cl).call(this,n)&&!u(this,Un,dl).call(this,n));if(s.length>0)throw Error("Assets: following URLs don't look like any of supported formats: "+s.map(n=>`"${n}"`).join(", ")+'. Supported formats are: ".png", ".wav", ".flac", ".json", ".ldtk"');await Promise.all([...t.filter(n=>u(this,Dn,fl).call(this,n)).map(n=>u(this,lr,Kh).call(this,n)),...t.filter(n=>u(this,Pn,cl).call(this,n)).map(n=>u(this,or,Wh).call(this,n)),...t.filter(n=>u(this,Un,dl).call(this,n)).map(n=>u(this,hr,qh).call(this,n))])}}Ei=new WeakMap,On=new WeakMap,Dn=new WeakSet,fl=function(e){return e.toLowerCase().endsWith(".png")},Pn=new WeakSet,cl=function(e){return e.toLowerCase().endsWith(".wav")||e.toLowerCase().endsWith(".flac")},Un=new WeakSet,dl=function(e){return e.toLowerCase().endsWith(".json")||e.toLowerCase().endsWith(".ldtk")},lr=new WeakSet,Kh=async function(e){L.infoBeetPx(`Assets: loading image "${e}"`);const t=await fetch(e);if(!u(this,gs,ja).call(this,t.status))throw Error(`Assets: could not fetch PNG file: "${e}"`);const s=await t.arrayBuffer(),n=Ed(s);if(n.channels!==3&&n.channels!==4)throw Error(`Assets: only PNG image files with 3 or 4 channels are supported. The file which seems to have ${n.channels} channels instead: "${e}"`);a(this,Ei).addImageAsset(e,{width:n.width,height:n.height,channels:n.channels,rgba8bitData:n.data})},or=new WeakSet,Wh=async function(e){L.infoBeetPx(`Assets: loading sound "${e}"`);const t=await fetch(e);if(!u(this,gs,ja).call(this,t.status))throw Error(`Assets: could not fetch sound file: "${e}"`);const s=await t.arrayBuffer(),n=await a(this,On).call(this,s);a(this,Ei).addSoundAsset(e,{audioBuffer:n})},hr=new WeakSet,qh=async function(e){L.infoBeetPx(`Assets: loading JSON "${e}"`);const t=await fetch(e);if(!u(this,gs,ja).call(this,t.status))throw Error(`Assets: could not fetch JSON file: "${e}"`);const s=await t.json();a(this,Ei).addJsonAsset(e,{json:s})},gs=new WeakSet,ja=function(e){return e>=200&&e<300};var In,zn,Nn;class Td{constructor(){d(this,In,new Map);d(this,zn,new Map);d(this,Nn,new Map)}addImageAsset(e,t){a(this,In).set(e,t)}addSoundAsset(e,t){a(this,zn).set(e,t)}addJsonAsset(e,t){a(this,Nn).set(e,t)}getImageAsset(e){const t=a(this,In).get(e);if(!t)throw Error(`Assets: There is no image loaded for: ${e}`);return t}getSoundAsset(e){const t=a(this,zn).get(e);if(!t)throw Error(`Assets: There is no sound loaded for: ${e}`);return t}getJsonAsset(e){const t=a(this,Nn).get(e);if(!t)throw Error(`Assets: There is no JSON loaded for: ${e}`);return t}}In=new WeakMap,zn=new WeakMap,Nn=new WeakMap;function pl(){}var ms,Qa;const dn=class dn{static muteGain(e,t,s,n=pl){var r;s=Math.max(0,s),L.debugBeetPx(`AudioHelpers.muteGain (audioContextCurrentTime: ${t}, fadeOutMillis: ${s})`),u(r=dn,ms,Qa).call(r,15,100,()=>{s>0?e.gain.setValueCurveAtTime([e.gain.value,0],t,s/1e3):e.gain.setValueAtTime(0,t)}).catch(()=>{}),setTimeout(()=>{n()},s)}static unmuteGain(e,t,s,n=pl){var r;s=Math.max(0,s),L.debugBeetPx(`AudioHelpers.unmuteGain (audioContextCurrentTime: ${t}, fadeInMillis: ${s})`),u(r=dn,ms,Qa).call(r,15,100,()=>{s>0?e.gain.setValueCurveAtTime([e.gain.value,1],t,s/1e3):e.gain.setValueAtTime(1,t)}).catch(o=>{}),setTimeout(()=>{n()},s)}};ms=new WeakSet,Qa=async function(e,t,s){if(e<=0)return L.warnBeetPx("AudioHelpers.#tryNTimes: Failed to perform the action in N trials."),Promise.reject();try{s()}catch(n){return L.debugBeetPx("AudioHelpers.#tryNTimes: err:",n),new Promise((r,o)=>{L.debugBeetPx(`AudioHelpers.#tryNTimes: Failed to perform the action, trying ${e} more times…`),setTimeout(()=>{u(this,ms,Qa).call(this,e-1,t,s).then(r,o)},t)})}},d(dn,ms);let Te=dn;var te,Ft,dt,bs,ht,Bn,_l,Ln,gl,$n,ml,Gn,bl;const de=class de{constructor(e,t,s,n,r){d(this,Bn);d(this,Ln);d(this,$n);d(this,Gn);b(this,"onEnded");b(this,"startedAtMs");b(this,"pausedAtMs");b(this,"accumulatedPauseMs");b(this,"isPausedByEngine");b(this,"isPausedByGame");d(this,te,void 0);d(this,Ft,void 0);d(this,dt,void 0);d(this,bs,void 0);d(this,ht,void 0);n==="pause"?de.playbacksToPauseOnGamePause.add(this):n==="mute"&&de.playbacksToMuteOnGamePause.add(this),this.onEnded=()=>{r(),de.playbacksToPauseOnGamePause.delete(this),de.playbacksToMuteOnGamePause.delete(this)},_(this,dt,e),_(this,bs,t),_(this,ht,a(this,dt).createGain()),a(this,ht).gain.value=s?0:1,a(this,ht).connect(a(this,bs)),this.isPausedByGame=!1,this.isPausedByEngine=!1,_(this,Ft,s),_(this,te,!1),this.startedAtMs=a(this,dt).currentTime*1e3,this.pausedAtMs=null,this.accumulatedPauseMs=0}mute(e){L.debugBeetPx(`AudioPlayback.mute (id: ${this.id}, type: ${this.type}, fadeOutMillis: ${e})`),!a(this,Ft)&&(_(this,Ft,!0),!a(this,te)&&(this.isPausedByGame||this.isPausedByEngine||u(this,Bn,_l).call(this,e)))}muteByEngine(){L.debugBeetPx(`AudioPlayback.muteByEngine (id: ${this.id}, type: ${this.type})`),!a(this,te)&&(_(this,te,!0),!a(this,Ft)&&(this.isPausedByGame||this.isPausedByEngine||u(this,Bn,_l).call(this,ki.muteUnmuteDefaultFadeMillis)))}unmute(e){L.debugBeetPx(`AudioPlayback.unmute (id: ${this.id}, type: ${this.type}, fadeInMillis: ${e})`),a(this,Ft)&&(_(this,Ft,!1),!a(this,te)&&(this.isPausedByGame||this.isPausedByEngine||u(this,Ln,gl).call(this,e)))}unmuteByEngine(){L.debugBeetPx(`AudioPlayback.unmuteByEngine (id: ${this.id}, type: ${this.type})`),a(this,te)&&(_(this,te,!1),!a(this,Ft)&&(this.isPausedByGame||this.isPausedByEngine||u(this,Ln,gl).call(this,ki.muteUnmuteDefaultFadeMillis)))}stop(e){if(L.debugBeetPx(`AudioPlayback.stop (id: ${this.id}, type: ${this.type}, fadeOutMillis: ${e})`),this.isPausedByGame||this.isPausedByEngine){this.onEnded();return}Te.muteGain(a(this,ht),a(this,dt).currentTime,e,()=>{this.stopAllNodes(),!this.isPausedByGame&&!this.isPausedByEngine&&this.onEnded()})}pause(){L.debugBeetPx(`AudioPlayback.pause (id: ${this.id}, type: ${this.type}})`),!this.isPausedByGame&&(this.isPausedByGame=!0,!this.isPausedByEngine&&u(this,$n,ml).call(this))}pauseByEngine(){L.debugBeetPx(`AudioPlayback.pauseByEngine (id: ${this.id}, type: ${this.type}})`),!this.isPausedByEngine&&(this.isPausedByEngine=!0,!this.isPausedByGame&&u(this,$n,ml).call(this))}resume(){L.debugBeetPx(`AudioPlayback.resume (id: ${this.id}, type: ${this.type})`),this.isPausedByGame&&(this.isPausedByGame=!1,!this.isPausedByEngine&&u(this,Gn,bl).call(this))}resumeByEngine(){L.debugBeetPx(`AudioPlayback.resumeByEngine (id: ${this.id}, type: ${this.type})`),this.isPausedByEngine&&(this.isPausedByEngine=!1,!this.isPausedByGame&&u(this,Gn,bl).call(this))}createSourceNode(){return a(this,dt).createBufferSource()}connectToMainGainNode(e){e.connect(a(this,ht))}disconnectFromOutput(){a(this,ht).disconnect()}};te=new WeakMap,Ft=new WeakMap,dt=new WeakMap,bs=new WeakMap,ht=new WeakMap,Bn=new WeakSet,_l=function(e){Te.muteGain(a(this,ht),a(this,dt).currentTime,e)},Ln=new WeakSet,gl=function(e){Te.unmuteGain(a(this,ht),a(this,dt).currentTime,e)},$n=new WeakSet,ml=function(){this.pausedAtMs=a(this,dt).currentTime*1e3,Te.muteGain(a(this,ht),a(this,dt).currentTime,ki.muteUnmuteDefaultFadeMillis,()=>{this.stopAllNodes()})},Gn=new WeakSet,bl=function(){_(this,ht,a(this,dt).createGain()),a(this,ht).gain.value=a(this,Ft)||this.isPausedByEngine?0:1,a(this,ht).connect(a(this,bs)),this.setupAndStartNodes(),this.pausedAtMs!=null&&(this.accumulatedPauseMs+=a(this,dt).currentTime*1e3-this.pausedAtMs,this.pausedAtMs=null),!a(this,Ft)&&!this.isPausedByEngine&&Te.unmuteGain(a(this,ht),a(this,dt).currentTime,ki.muteUnmuteDefaultFadeMillis,()=>{})},b(de,"playbacksToPauseOnGamePause",new Set),b(de,"playbacksToMuteOnGamePause",new Set),b(de,"nextPlaybackId",1);let Et=de;var ws,Ot,Zn;class Rd extends Et{constructor(t,s){super(s.audioContext,s.target,s.muteOnStart,s.onGamePause,s.onEnded);b(this,"id",Et.nextPlaybackId++);b(this,"type","looped");d(this,ws,void 0);d(this,Ot,void 0);d(this,Zn,void 0);_(this,ws,s.assets.getSoundAsset(t)),_(this,Zn,a(this,ws).audioBuffer.duration*1e3),_(this,Ot,this.createSourceNode()),this.setupAndStartNodes()}stopAllNodes(){a(this,Ot).stop()}setupAndStartNodes(){this.pausedAtMs!=null&&_(this,Ot,this.createSourceNode()),a(this,Ot).buffer=a(this,ws).audioBuffer,a(this,Ot).loop=!0,this.connectToMainGainNode(a(this,Ot)),a(this,Ot).addEventListener("ended",()=>{a(this,Ot).disconnect(),this.disconnectFromOutput(),!this.isPausedByGame&&!this.isPausedByEngine&&this.onEnded()});const t=this.pausedAtMs?(this.pausedAtMs-this.startedAtMs-this.accumulatedPauseMs)%a(this,Zn):0;a(this,Ot).start(0,t/1e3)}}ws=new WeakMap,Ot=new WeakMap,Zn=new WeakMap;var Hn,Jt;class Md extends Et{constructor(t,s){super(s.audioContext,s.target,s.muteOnStart,s.onGamePause,s.onEnded);b(this,"id",Et.nextPlaybackId++);b(this,"type","once");d(this,Hn,void 0);d(this,Jt,void 0);_(this,Hn,s.assets.getSoundAsset(t)),_(this,Jt,this.createSourceNode()),this.setupAndStartNodes()}stopAllNodes(){a(this,Jt).stop()}setupAndStartNodes(){this.pausedAtMs!=null&&_(this,Jt,this.createSourceNode()),a(this,Jt).buffer=a(this,Hn).audioBuffer,this.connectToMainGainNode(a(this,Jt)),a(this,Jt).addEventListener("ended",()=>{a(this,Jt).disconnect(),this.disconnectFromOutput(),!this.isPausedByGame&&!this.isPausedByEngine&&this.onEnded()});const t=this.pausedAtMs?this.pausedAtMs-this.startedAtMs-this.accumulatedPauseMs:0;a(this,Jt).start(0,t/1e3)}}Hn=new WeakMap,Jt=new WeakMap;function Fd(i){if(i.__esModule)return i;var e=i.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(i).forEach(function(s){var n=Object.getOwnPropertyDescriptor(i,s);Object.defineProperty(t,s,n.get?n:{enumerable:!0,get:function(){return i[s]}})}),t}var qr={},ql=function(e){if(typeof window>"u")return null;var t=window.OfflineAudioContext||window.webkitOfflineAudioContext,s=window.AudioContext||window.webkitAudioContext;if(!s)return null;typeof e=="number"&&(e={sampleRate:e});var n=e&&e.sampleRate;if(e&&e.offline)return t?new t(e.channels||2,e.length,n||44100):null;var r=qr[n];if(r)return r;try{r=new s(e)}catch{r=new s}return qr[r.sampleRate]=qr[n]=r,r},Od=ql,Yh=si;function si(i,e){if(!(this instanceof si))return new si(i,e);if(e||(e=i,i=e&&e.context),e||(e={}),i===void 0&&(i=Od()),e.numberOfChannels==null&&(e.numberOfChannels=1),e.sampleRate==null&&(e.sampleRate=i&&i.sampleRate||this.sampleRate),e.length==null&&(e.duration!=null?e.length=e.duration*e.sampleRate:e.length=1),i&&i.createBuffer)return i.createBuffer(e.numberOfChannels,Math.ceil(e.length),e.sampleRate);this.length=Math.ceil(e.length),this.numberOfChannels=e.numberOfChannels,this.sampleRate=e.sampleRate,this.duration=this.length/this.sampleRate,this._data=new Float32Array(this.length*this.numberOfChannels),this._channelData=[];for(var t=0;t<this.numberOfChannels;t++)this._channelData.push(this._data.subarray(t*this.length,(t+1)*this.length))}si.prototype.numberOfChannels=1;si.prototype.sampleRate=44100;si.prototype.getChannelData=function(i){if(i>=this.numberOfChannels||i<0||i==null)throw Error("Cannot getChannelData: channel number ("+i+") exceeds number of channels ("+this.numberOfChannels+")");return this._channelData[i]};si.prototype.copyFromChannel=function(i,e,t){t==null&&(t=0);for(var s=this._channelData[e],n=t,r=0;n<this.length&&r<i.length;n++,r++)i[r]=s[n]};si.prototype.copyToChannel=function(i,e,t){var s=this._channelData[e];t||(t=0);for(var n=t,r=0;n<this.length&&r<i.length;n++,r++)s[n]=i[r]};var Rr=function(e){return e!=null&&typeof e.length=="number"&&typeof e.sampleRate=="number"&&typeof e.getChannelData=="function"&&typeof e.duration=="number"},Dd=Pd;function Pd(i,e,t){return e<t?i<e?e:i>t?t:i:i<t?t:i>e?e:i}var Ud=Object.prototype.toString,Xh=function(i){var e;return Ud.call(i)==="[object Object]"&&(e=Object.getPrototypeOf(i),e===null||e===Object.getPrototypeOf({}))};const Id={},zd=Object.freeze(Object.defineProperty({__proto__:null,default:Id},Symbol.toStringTag,{value:"Module"})),jh=Fd(zd);/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Nd=function(i){return i!=null&&(Qh(i)||Bd(i)||!!i._isBuffer)};function Qh(i){return!!i.constructor&&typeof i.constructor.isBuffer=="function"&&i.constructor.isBuffer(i)}function Bd(i){return typeof i.readFloatLE=="function"&&typeof i.slice=="function"&&Qh(i.slice(0,0))}const Ld={8e3:8e3,11025:11025,16e3:16e3,22050:22050,44100:44100,48e3:48e3,88200:88200,96e3:96e3,176400:176400,192e3:192e3,352800:352800,384e3:384e3};/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var $d=function(i){return i!=null&&(Vh(i)||Gd(i)||!!i._isBuffer)};function Vh(i){return!!i.constructor&&typeof i.constructor.isBuffer=="function"&&i.constructor.isBuffer(i)}function Gd(i){return typeof i.readFloatLE=="function"&&typeof i.slice=="function"&&Vh(i.slice(0,0))}var tu=function(e,t,s){var n={},r,o;if(typeof t=="string"&&(t=Yo(t)),Array.isArray(t)){var h={};for(o=0;o<t.length;o++)h[t[o]]=!0;t=h}for(r in t)t[r]=Yo(t[r]);var c={};for(r in t){var l=t[r];if(Array.isArray(l))for(o=0;o<l.length;o++){var f=l[o];if(s&&(c[f]=!0),f in e){if(n[r]=e[f],s)for(var m=o;m<l.length;m++)c[l[m]]=!0;break}}else r in e&&(t[r]&&(n[r]=e[r]),s&&(c[r]=!0))}if(s)for(r in e)c[r]||(n[r]=e[r]);return n},Yr={};function Yo(i){return Yr[i]?Yr[i]:(typeof i=="string"&&(i=Yr[i]=i.split(/\s*,\s*|\s+/)),i)}var Xo=Ld,jo=jh,Zd=Rr,Hd=$d,Jd=Xh,Kd=tu,eu={parse:nu,stringify:qd,detect:wl,type:au},iu=jo.endianness instanceof Function?jo.endianness().toLowerCase():"le",Qo={uint:"uint32",uint8:"uint8",uint8_clamped:"uint8",uint16:"uint16",uint32:"uint32",int:"int32",int8:"int8",int16:"int16",int32:"int32",float:"float32",float32:"float32",float64:"float64",array:"array",arraybuffer:"arraybuffer",buffer:"buffer",audiobuffer:"audiobuffer",ndarray:"ndarray",ndsamples:"ndsamples"},kn={mono:1,stereo:2,quad:4,"5.1":6,"2.1":3,"3-channel":3,"5-channel":5},Wd=32;for(var Ga=6;Ga<Wd;Ga++)kn[Ga+"-channel"]=Ga;var su={};for(var Vo in kn)su[kn[Vo]]=Vo;function nu(i){for(var e={},t=i.split(/\s*[,;_]\s*|\s+/),s=0;s<t.length;s++){var n=t[s].toLowerCase();if(n==="planar"&&e.interleaved==null)e.interleaved=!1,e.channels==null&&(e.channels=2);else if((n==="interleave"||n==="interleaved")&&e.interleaved==null)e.interleaved=!0,e.channels==null&&(e.channels=2);else if(kn[n])e.channels=kn[n];else if(n==="le"||n==="LE"||n==="littleendian"||n==="bigEndian")e.endianness="le";else if(n==="be"||n==="BE"||n==="bigendian"||n==="bigEndian")e.endianness="be";else if(Qo[n])e.type=Qo[n],n==="audiobuffer"&&(e.endianness=iu,e.interleaved=!1);else if(Xo[n])e.sampleRate=Xo[n];else if(/^\d+$/.test(n))e.sampleRate=parseInt(n);else throw Error("Cannot identify part `"+n+"`")}return e}function wl(i){if(!i)return{};var e=Kd(i,{channels:"channel channels numberOfChannels channelCount",sampleRate:"sampleRate rate",interleaved:"interleave interleaved",type:"type dtype",endianness:"endianness"});if(i.format&&(e.type="ndsamples"),e.sampleRate==null&&i.format&&i.format.sampleRate&&(e.sampleRate=i.format.sampleRate),i.planar&&(e.interleaved=!1),e.interleaved!=null&&e.channels==null&&(e.channels=2),e.type==null){var t=au(i);t&&(e.type=t)}return e.type==="audiobuffer"&&(e.endianness=iu,e.interleaved=!1),e}function qd(i,e){e===void 0?e={endianness:"le"}:e==null?e={}:typeof e=="string"?e=nu(e):e=wl(e),Jd(i)||(i=wl(i));var t=[];return i.type!=null&&i.type!==e.type&&t.push(i.type||"float32"),i.channels!=null&&i.channels!==e.channels&&t.push(su[i.channels]),i.endianness!=null&&i.endianness!==e.endianness&&t.push(i.endianness||"le"),i.interleaved!=null&&i.interleaved!==e.interleaved&&i.type!=="audiobuffer"&&t.push(i.interleaved?"interleaved":"planar"),i.sampleRate!=null&&i.sampleRate!==e.sampleRate&&t.push(i.sampleRate),t.join(" ")}function au(i){if(Zd(i))return"audiobuffer";if(Hd(i))return"buffer";if(Array.isArray(i))return"array";if(i instanceof ArrayBuffer)return"arraybuffer";if(i.shape&&i.dtype)return i.format?"ndsamples":"ndarray";if(i instanceof Float32Array)return"float32";if(i instanceof Float64Array)return"float64";if(i instanceof Uint8Array)return"uint8";if(i instanceof Uint8ClampedArray)return"uint8_clamped";if(i instanceof Int8Array)return"int8";if(i instanceof Int16Array)return"int16";if(i instanceof Uint16Array)return"uint16";if(i instanceof Int32Array)return"int32";if(i instanceof Uint32Array)return"uint32"}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var th=Object.getOwnPropertySymbols,Yd=Object.prototype.hasOwnProperty,Xd=Object.prototype.propertyIsEnumerable;function jd(i){if(i==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(i)}function Qd(){try{if(!Object.assign)return!1;var i=new String("abc");if(i[5]="de",Object.getOwnPropertyNames(i)[0]==="5")return!1;for(var e={},t=0;t<10;t++)e["_"+String.fromCharCode(t)]=t;var s=Object.getOwnPropertyNames(e).map(function(r){return e[r]});if(s.join("")!=="0123456789")return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(r){n[r]=r}),Object.keys(Object.assign({},n)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var Vd=Qd()?Object.assign:function(i,e){for(var t,s=jd(i),n,r=1;r<arguments.length;r++){t=Object(arguments[r]);for(var o in t)Yd.call(t,o)&&(s[o]=t[o]);if(th){n=th(t);for(var h=0;h<n.length;h++)Xd.call(t,n[h])&&(s[n[h]]=t[n[h]])}}return s},eh=jh,t0=Nd,Fe=eu,ih=Vd,e0=Rr,i0=s0;function s0(i,e,t,s){if(eh(i,"First argument should be data"),eh(e,"Second argument should be format string or object"),e===t)return i;if(sh(e))s=e,t=Fe.detect(s),e=Fe.detect(i);else if(t===void 0&&s===void 0)t=Za(e),e=Fe.detect(i);else if(sh(t))s=t,t=Za(e),e=Fe.detect(i);else{var n=Za(e),r=Fe.detect(i);r.dtype=n.type==="arraybuffer"?r.type:n.type,e=ih(n,r);var o=Za(t),h=Fe.detect(s);o.type&&(h.dtype=o.type==="arraybuffer"?h.type||e.dtype:o.type),t=ih(o,h)}if(t.channels==null&&e.channels!=null&&(t.channels=e.channels),t.type==null&&(t.type=e.type,t.dtype=e.dtype),t.interleaved!=null&&e.channels==null&&(e.channels=2),e.type===t.type&&e.interleaved===t.interleaved&&e.endianness===t.endianness)return i;nh(e),nh(t),(i.buffers||i.buffer&&i.buffer.buffers)&&(i.buffer&&(i=i.buffer),i.buffers&&(i=i.join()));var c;if(e0(i))if(i._data)c=i._data;else{c=new Float32Array(i.length*i.numberOfChannels);for(var l=0,f=i.numberOfChannels;l<f;l++)c.set(i.getChannelData(l),i.length*l)}else i instanceof ArrayBuffer?c=new Ha[e.dtype](i):t0(i)?(i.byteOffset!=null?c=i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength):c=i.buffer,c=new Ha[e.dtype](c)):c=i;var m=t.type==="array"?Array.from(c):new Ha[t.dtype](c);if(e.max!==t.max)for(var g=e.max-e.min,p=t.max-t.min,y=0,f=c.length;y<f;y++){var N=c[y],D=(N-e.min)/g;N=D*p+t.min,m[y]=Math.max(t.min,Math.min(t.max,N))}if(e.interleaved!=t.interleaved){var R=e.channels,I=Math.floor(c.length/R);e.interleaved&&!t.interleaved?m=m.map(function(Y,J,Z){var K=J%I,Gt=~~(J/I);return Z[K*R+Gt]}):!e.interleaved&&t.interleaved&&(m=m.map(function(Y,J,Z){var K=~~(J/R),Gt=J%R;return Z[Gt*I+K]}))}if(t.dtype!="array"&&t.dtype!="int8"&&t.dtype!="uint8"&&e.endianness&&t.endianness&&e.endianness!==t.endianness)for(var B=t.endianness==="le",x=new DataView(m.buffer),H=m.BYTES_PER_ELEMENT,G="set"+t.dtype[0].toUpperCase()+t.dtype.slice(1),y=0,f=m.length;y<f;y++)x[G](y*H,m[y],B);if(t.type,s){if(Array.isArray(s))for(var y=0;y<m.length;y++)s[y]=m[y];else if(s instanceof ArrayBuffer){var C=new Ha[t.dtype](s);C.set(m),s=C}else s.set(m);m=s}return(t.type==="arraybuffer"||t.type==="buffer")&&(m=m.buffer),m}function Za(i){return typeof i=="string"?Fe.parse(i):Fe.detect(i)}function sh(i){return typeof i!="string"&&(Array.isArray(i)||ArrayBuffer.isView(i)||i instanceof ArrayBuffer)}var Ha={uint8:Uint8Array,uint8_clamped:Uint8ClampedArray,uint16:Uint16Array,uint32:Uint32Array,int8:Int8Array,int16:Int16Array,int32:Int32Array,float32:Float32Array,float64:Float64Array,array:Array,arraybuffer:Uint8Array,buffer:Uint8Array},n0={float32:"float32",audiobuffer:"float32",ndsamples:"float32",ndarray:"float32",float64:"float64",buffer:"uint8",arraybuffer:"uint8",uint8:"uint8",uint8_clamped:"uint8",uint16:"uint16",uint32:"uint32",int8:"int8",int16:"int16",int32:"int32",array:"array"};function nh(i){switch(i.dtype||(i.dtype=n0[i.type]||"array"),i.dtype){case"float32":case"float64":case"audiobuffer":case"ndsamples":case"ndarray":i.min=-1,i.max=1;break;case"uint8":i.min=0,i.max=255;break;case"uint16":i.min=0,i.max=65535;break;case"uint32":i.min=0,i.max=4294967295;break;case"int8":i.min=-128,i.max=127;break;case"int16":i.min=-32768,i.max=32767;break;case"int32":i.min=-2147483648,i.max=2147483647;break;default:i.min=-1,i.max=1;break}return i}var a0=function(e){return atob(e)},yl={exports:{}};(function(i,e){(function(t){function s(n,r){if(n instanceof Boolean||typeof n=="boolean"||(r instanceof Object||(r={}),r.hasOwnProperty("allowBlank")&&!r.allowBlank&&n===""))return!1;var o="(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+/]{3}=)?";return r.mime&&(o="(data:\\w+\\/[a-zA-Z\\+\\-\\.]+;base64,)?"+o),r.paddingRequired===!1&&(o="(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}(==)?|[A-Za-z0-9+\\/]{3}=?)?"),new RegExp("^"+o+"$","gi").test(n)}i.exports&&(e=i.exports=s),e.isBase64=s})()})(yl,yl.exports);var r0=yl.exports,ru=a0,l0=r0,o0=function(e){if(typeof e!="string")throw Error("Argument should be a string");return/^data\:/i.test(e)?h0(e):(l0(e)&&(e=ru(e)),lu(e))};function lu(i){for(var e=new Uint8Array(i.length),t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e.buffer}function h0(i){i=i.replace(/\r?\n/g,"");var e=i.indexOf(",");if(e===-1||e<=4)throw new TypeError("malformed data-URI");for(var t=i.substring(5,e).split(";"),s=!1,n="US-ASCII",r=0;r<t.length;r++)t[r]=="base64"?s=!0:t[r].indexOf("charset=")==0&&(n=t[r].substring(8));var o=unescape(i.substring(e+1));s&&(o=ru(o));var h=lu(o);return h.type=t[0]||"text/plain",h.charset=n,h}var u0=Yh,f0=Rr,c0=Xh,d0=ql,p0=i0,ah=eu,_0=o0,g0=tu,m0=function i(e,t){var s,n,r,o,h,c,l;if(typeof t=="number"?t={channels:t}:typeof t=="string"?t={format:t}:t===void 0&&(c0(e)?(t=e,e=void 0):t={}),t=g0(t,{format:"format type dtype dataType",channels:"channel channels numberOfChannels channelCount",sampleRate:"sampleRate rate",length:"length size",duration:"duration time"}),r=t.channels,o=t.sampleRate,t.format&&(h=rh(t.format)),h&&(r&&!h.channels?h.channels=r:h.channels&&!r&&(r=h.channels),!o&&h.sampleRate&&(o=h.sampleRate)),e==null)t.duration!=null?(o||(o=44100),s=o*t.duration):s=t.length;else if(f0(e))if(s=e.length,r==null&&(r=e.numberOfChannels),o==null&&(o=e.sampleRate),e._channelData)n=e._channelData.slice(0,r);else for(n=[],c=0,l=r;c<l;c++)n[c]=e.getChannelData(c);else if(typeof e=="number")s=e;else if(Array.isArray(e)&&(Array.isArray(e[0])||ArrayBuffer.isView(e[0])))for(s=e[0].length,n=[],r||(r=e.length),c=0;c<r;c++)n[c]=e[c]instanceof Float32Array?e[c]:new Float32Array(e[c]);else{if(e.shape&&e.data)return e.shape&&(r=e.shape[1]),!o&&e.format&&(o=e.format.sampleRate),i(e.data,{channels:r,sampleRate:o});for(typeof e=="string"&&(e=_0(e)),h||(h=rh(e)),r||(r=h.channels||1),e=p0(e,h,"float32 planar"),s=Math.floor(e.length/r),n=[],c=0;c<r;c++)n[c]=e.subarray(c*s,(c+1)*s)}var f=new u0(t.context===null||s===0?null:t.context||d0(),{length:s??1,numberOfChannels:r||1,sampleRate:o||44100});if(n)for(c=0,l=n.length;c<l;c++)f.getChannelData(c).set(n[c]);return f};function rh(i){return typeof i=="string"?ah.parse(i):ah.detect(i)}var ou=Yh,Pa=Rr,b0=Dd,w0=ql,y0=m0,v0=function(i){return i===0&&1/i===-1/0},$t=function(e,t){return e==null?0:v0(e)?t:e<=-t?0:e<0?t+e%t:Math.min(t,e)},Xr,Mr={create:Xs,copy:Yl,shallow:hu,clone:x0,reverse:A0,invert:k0,zero:S0,noise:E0,equal:uu,fill:ni,slice:Xl,concat:Sn,resize:R0,pad:jl,padLeft:M0,padRight:F0,rotate:O0,shift:D0,normalize:P0,removeStatic:U0,trim:z0,trimLeft:N0,trimRight:B0,mix:L0,size:$0,data:G0,subbuffer:T0,repeat:C0};Object.defineProperty(Mr,"context",{get:function(){return Xr||(Xr=w0()),Xr}});var en=Mr;function Xs(i,e,t){return typeof e=="number"?e={channels:e}:typeof e=="string"?e={format:e}:e||(e={}),t&&(e.sampleRate=t),e.context=Mr.context,y0(i,e)}function Yl(i,e,t){et(i),et(e),t=t||0;for(var s=0,n=Math.min(i.numberOfChannels,e.numberOfChannels);s<n;s++)e.getChannelData(s).set(i.getChannelData(s),t);return e}function et(i){if(!Pa(i))throw new Error("Argument should be an AudioBuffer instance.")}function hu(i){return et(i),Mr.context.createBuffer(i.numberOfChannels,i.length,i.sampleRate)}function x0(i){return Yl(i,hu(i))}function A0(i,e,t,s){et(i),!Pa(e)&&e!=null&&(s=t,t=e,e=null),e?(et(e),Yl(i,e)):e=i,t=t==null?0:$t(t,i.length),s=s==null?i.length:$t(s,i.length);for(var n=0,r=e.numberOfChannels;n<r;++n)e.getChannelData(n).subarray(t,s).reverse();return e}function k0(i,e,t,s){return!Pa(e)&&e!=null&&(s=t,t=e,e=null),ni(i,e,function(n){return-n},t,s)}function S0(i,e,t,s){return ni(i,e,0,t,s)}function E0(i,e,t,s){return ni(i,e,function(n){return Math.random()*2-1},t,s)}function uu(i,e){if(arguments.length>2){for(var t=0,s=arguments.length-1;t<s;t++)if(!uu(arguments[t],arguments[t+1]))return!1;return!0}if(et(i),et(e),i.length!==e.length||i.numberOfChannels!==e.numberOfChannels)return!1;for(var n=0;n<i.numberOfChannels;n++)for(var r=i.getChannelData(n),o=e.getChannelData(n),t=0;t<r.length;t++)if(r[t]!==o[t])return!1;return!0}function ni(i,e,t,s,n){if(et(i),!Pa(e)&&e!=null&&(typeof t=="function"||(n=s,s=t,t=e),e=null),e?et(e):e=i,s=s==null?0:$t(s,i.length),n=n==null?i.length:$t(n,i.length),t instanceof Function)for(var r=0,o=i.numberOfChannels;r<o;r++)for(var l=i.getChannelData(r),h=e.getChannelData(r),c=s;c<n;c++)h[c]=t.call(i,l[c],c,r,l);else for(var r=0,o=i.numberOfChannels;r<o;r++)for(var h=e.getChannelData(r),c=s;c<n;c++)h[c]=t;return e}function C0(i,e){if(et(i),!e||e<0)return new ou(null,{length:0,numberOfChannels:i.numberOfChannels,sampleRate:i.sampleRate});if(e===1)return i;for(var t=[],s=0;s<e;s++)t.push(i);return Sn(t)}function Xl(i,e,t){et(i),e=e==null?0:$t(e,i.length),t=t==null?i.length:$t(t,i.length);for(var s=[],n=0;n<i.numberOfChannels;n++){var r=i.getChannelData(n);s.push(r.slice(e,t))}return Xs(s,i.numberOfChannels,i.sampleRate)}function T0(i,e,t,s){if(et(i),Array.isArray(e)?(s=e,e=0,t=-0):Array.isArray(t)&&(s=t,t=-0),!Array.isArray(s)){s=Array(i.numberOfChannels);for(var n=0;n<i.numberOfChannels;n++)s[n]=n}e=e==null?0:$t(e,i.length),t=t==null?i.length:$t(t,i.length);for(var r=[],o=0;o<s.length;o++){var h=s[o],c=i.getChannelData(h);r.push(c.subarray(e,t))}var l=new ou(null,{length:0,sampleRate:i.sampleRate,numberOfChannels:i.numberOfChannels});return l.length=r[0].length,l._data=null,l._channelData=r,l.duration=l.length/l.sampleRate,l}function Sn(){for(var i=[],e=0,t=arguments.length;e<t;e++){var s=arguments[e];if(Array.isArray(s))for(var n=0;n<s.length;n++)i.push(s[n]);else i.push(s)}for(var r=1,o=0,h=0,e=0;e<i.length;e++){var c=i[e];et(c),o+=c.length,r=Math.max(c.numberOfChannels,r),h=Math.max(c.sampleRate,h)}for(var l=[],f=0;f<r;f++){for(var m=new Float32Array(o),g=0,e=0;e<i.length;e++){var c=i[e];f<c.numberOfChannels&&m.set(c.getChannelData(f),g),g+=c.length}l.push(m)}return Xs(l,r,h)}function R0(i,e){return et(i),e<i.length?Xl(i,0,e):Sn(i,Xs(e-i.length,i.numberOfChannels))}function jl(i,e,t){var s,n;return typeof i=="number"?(s=e,n=i):(s=i,n=e),t=t||0,et(s),n<s.length?s:s===e?Sn(ni(Xs(n-s.length,s.numberOfChannels),t),s):Sn(s,ni(Xs(n-s.length,s.numberOfChannels),t))}function M0(i,e,t){return jl(e,i,t)}function F0(i,e,t){return jl(i,e,t)}function O0(i,e){et(i);for(var t=0;t<i.numberOfChannels;t++)for(var s=i.getChannelData(t),n=s.slice(),r=0,o=s.length,h;r<o;r++)h=(e+(e+r<0?o+r:r))%o,s[h]=n[r];return i}function D0(i,e){et(i);for(var t=0;t<i.numberOfChannels;t++){var s=i.getChannelData(t);if(e>0)for(var n=s.length-e;n--;)s[n+e]=s[n];else for(var n=-e,r=s.length-e;n<r;n++)s[n+e]=s[n]||0}return i}function P0(i,e,t,s){Pa(e)||(s=t,t=e,e=null),t=t==null?0:$t(t,i.length),s=s==null?i.length:$t(s,i.length);for(var n=0,r=0;r<i.numberOfChannels;r++)for(var o=i.getChannelData(r),h=t;h<s;h++)n=Math.max(Math.abs(o[h]),n);var c=Math.max(1/n,1);return ni(i,e,function(l,f,m){return b0(l*c,-1,1)},t,s)}function U0(i,e,t,s){var n=I0(i,t,s);return ni(i,e,function(r,o,h){return r-n[h]},t,s)}function I0(i,e,t){if(et(i),e=e==null?0:$t(e,i.length),t=t==null?i.length:$t(t,i.length),t-e<1)return[];for(var s=[],n=0;n<i.numberOfChannels;n++){for(var r=0,o=i.getChannelData(n),h=e;h<t;h++)r+=o[h];s.push(r/(t-e))}return s}function z0(i,e){return Ql(i,e,!0,!0)}function N0(i,e){return Ql(i,e,!0,!1)}function B0(i,e){return Ql(i,e,!1,!0)}function Ql(i,e,t,s){et(i),e=e==null?0:Math.abs(e);var n,r;if(t){n=i.length;for(var o=0,h=i.numberOfChannels;o<h;o++)for(var c=i.getChannelData(o),l=0;l<c.length&&!(l>n);l++)if(Math.abs(c[l])>e){n=l;break}}else n=0;if(s){r=0;for(var o=0,h=i.numberOfChannels;o<h;o++)for(var c=i.getChannelData(o),l=c.length-1;l>=0&&!(l<r);l--)if(Math.abs(c[l])>e){r=l+1;break}}else r=i.length;return Xl(i,n,r)}function L0(i,e,t,s){et(i),et(e),t==null&&(t=.5);var n=t instanceof Function?t:function(f,m){return f*(1-t)+m*t};s==null?s=0:s<0&&(s+=i.length);for(var r=0;r<i.numberOfChannels;r++)for(var o=i.getChannelData(r),h=e.getChannelData(r),c=s,l=0;c<i.length&&l<e.length;c++,l++)o[c]=n.call(i,o[c],h[l],l,r);return i}function $0(i){return et(i),i.numberOfChannels*i.getChannelData(0).byteLength}function G0(i,e){et(i),e=e||[];for(var t=0;t<i.numberOfChannels;t++)ArrayBuffer.isView(e[t])?e[t].set(i.getChannelData(t)):e[t]=i.getChannelData(t);return e}var ys,Ue,vs,wt,Jn,vl,ur,fu;class Z0 extends Et{constructor(t,s){super(s.audioContext,s.target,s.muteOnStart,s.onGamePause,s.onEnded);d(this,Jn);d(this,ur);b(this,"id",Et.nextPlaybackId++);b(this,"type","sequence");d(this,ys,void 0);d(this,Ue,void 0);d(this,vs,void 0);d(this,wt,void 0);const n=t.intro??[],r=t.loop??[];if(n.length+r.length<=0)throw Error("Cannot play an empty sound sequence");const o=n.map(c=>u(this,Jn,vl).call(this,c,s.assets)),h=r.map(c=>u(this,Jn,vl).call(this,c,s.assets));_(this,ys,u(this,ur,fu).call(this,[...o,...h])),_(this,Ue,o.reduce((c,l)=>c+l.durationMs,0)),_(this,vs,h.reduce((c,l)=>c+l.durationMs,0)),_(this,wt,this.createSourceNode()),this.setupAndStartNodes()}stopAllNodes(){a(this,wt).stop()}setupAndStartNodes(){this.pausedAtMs!=null&&_(this,wt,this.createSourceNode()),a(this,wt).buffer=a(this,ys),a(this,vs)>0&&(a(this,wt).loop=!0,a(this,wt).loopStart=a(this,Ue)/1e3,a(this,wt).loopEnd=a(this,ys).duration),this.connectToMainGainNode(a(this,wt)),a(this,wt).addEventListener("ended",()=>{a(this,wt).disconnect(),this.disconnectFromOutput(),!this.isPausedByGame&&!this.isPausedByEngine&&this.onEnded()});let t=this.pausedAtMs?this.pausedAtMs-this.startedAtMs-this.accumulatedPauseMs:0;t>a(this,Ue)&&(t=(t-a(this,Ue))%a(this,vs)+a(this,Ue)),a(this,wt).start(0,t/1e3)}}ys=new WeakMap,Ue=new WeakMap,vs=new WeakMap,wt=new WeakMap,Jn=new WeakSet,vl=function(t,s){if(t.length<1)throw Error("Each intro sequence entry needs at least 1 sound");const[n,...r]=t,o=typeof n!="string"?n.url:n,h=s.getSoundAsset(o).audioBuffer,c=h.duration*1e3,l=typeof n!="string"&&n.durationMs?n.durationMs(c):c,f=en.resize(h,l/1e3*h.sampleRate),m=r.map(g=>typeof g=="string"?{url:g}:g).map(({url:g})=>s.getSoundAsset(g).audioBuffer).map(g=>en.resize(g,l/1e3*g.sampleRate));return{firstBuffer:f,otherBuffers:m,durationMs:l}},ur=new WeakSet,fu=function(t){const s=(r,o)=>Ks(-1,r+o,1),n=t.map(r=>r.otherBuffers.reduce((o,h)=>en.mix(o,h,s),en.clone(r.firstBuffer)));return en.concat(...n)};var xs,Kn,Ci,yt,Dt,ut,pt,fr,cu,cr,du,Wn,xl;const ot=class ot{constructor(e,t){d(this,fr);d(this,cr);d(this,Wn);d(this,Ci,void 0);d(this,yt,void 0);d(this,Dt,void 0);d(this,ut,new Map);d(this,pt,void 0);_(this,Ci,e),_(this,yt,t),_(this,pt,u(this,cr,du).call(this)),$.updateMutedClass(a(this,pt)),_(this,Dt,a(this,yt).createGain()),a(this,Dt).gain.value=a(this,pt)?0:1,a(this,Dt).connect(a(this,yt).destination)}restart(){u(this,fr,cu).call(this),a(this,ut).clear()}async tryToResumeAudioContextSuspendedByBrowserForSecurityReasons(){return L.debugBeetPx("AudioApi.tryToResumeAudioContextSuspendedByBrowserForSecurityReasons"),a(this,yt).state==="running"?(L.debugBeetPx("Audio Context is already running"),Promise.resolve(!0)):a(this,yt).resume().then(()=>(L.debugBeetPx("Audio Context got resumed"),!0)).catch(e=>(L.errorBeetPx(e),!1))}startPlayback(e,t){t??(t={}),t.muteOnStart??(t.muteOnStart=!1),t.onGamePause??(t.onGamePause="pause"),L.debugBeetPx(`AudioApi.startPlayback (muteOnStart: ${t.muteOnStart}, onGamePause: ${t.onGamePause})`);const s=new Md(e,{assets:a(this,Ci),audioContext:a(this,yt),target:a(this,Dt),muteOnStart:t.muteOnStart,onGamePause:t.onGamePause,onEnded:()=>{L.debugBeetPx(`AudioApi: deleting playback ${s.id}`),a(this,ut).delete(s.id)}});return a(this,ut).set(s.id,s),s.id}startPlaybackLooped(e,t){t??(t={}),t.muteOnStart??(t.muteOnStart=!1),t.onGamePause??(t.onGamePause="pause"),L.debugBeetPx(`AudioApi.startPlaybackLooped (muteOnStart: ${t.muteOnStart}, onGamePause: ${t.onGamePause})`);const s=new Rd(e,{assets:a(this,Ci),audioContext:a(this,yt),target:a(this,Dt),muteOnStart:t.muteOnStart,onGamePause:t.onGamePause,onEnded:()=>{L.debugBeetPx(`AudioApi: deleting playback ${s.id}`),a(this,ut).delete(s.id)}});return a(this,ut).set(s.id,s),s.id}startPlaybackSequence(e,t){t??(t={}),t.muteOnStart??(t.muteOnStart=!1),t.onGamePause??(t.onGamePause="pause"),L.debugBeetPx(`AudioApi.startPlaybackSequence (muteOnStart: ${t.muteOnStart}, onGamePause: ${t.onGamePause})`);const s=new Z0(e,{assets:a(this,Ci),audioContext:a(this,yt),target:a(this,Dt),muteOnStart:t.muteOnStart,onGamePause:t.onGamePause,onEnded:()=>{L.debugBeetPx(`AudioApi: deleting playback ${s.id}`),a(this,ut).delete(s.id)}});return a(this,ut).set(s.id,s),s.id}isAudioMuted(){return a(this,pt)}muteAudio(e={}){L.debugBeetPx(`AudioApi.muteAudio (fadeOutMillis: ${e.fadeOutMillis})`),!a(this,pt)&&(u(this,Wn,xl).call(this,!0),_(this,pt,!0),$.updateMutedClass(a(this,pt)),Te.muteGain(a(this,Dt),a(this,yt).currentTime,e.fadeOutMillis??ot.muteUnmuteDefaultFadeMillis))}unmuteAudio(e={}){L.debugBeetPx(`AudioApi.unmuteAudio (fadeInMillis: ${e.fadeInMillis})`),a(this,pt)&&(u(this,Wn,xl).call(this,!1),_(this,pt,!1),$.updateMutedClass(a(this,pt)),Te.unmuteGain(a(this,Dt),a(this,yt).currentTime,e.fadeInMillis??ot.muteUnmuteDefaultFadeMillis))}mutePlayback(e,t={}){var s;L.debugBeetPx(`AudioApi.mutePlayback (fadeOutMillis: ${t.fadeOutMillis})`),(s=a(this,ut).get(e))==null||s.mute(t.fadeOutMillis??ot.muteUnmuteDefaultFadeMillis)}unmutePlayback(e,t={}){var s;L.debugBeetPx(`AudioApi.unmutePlayback (fadeInMillis: ${t.fadeInMillis})`),(s=a(this,ut).get(e))==null||s.unmute(t.fadeInMillis??ot.muteUnmuteDefaultFadeMillis)}stopPlayback(e,t={}){var s;L.debugBeetPx(`AudioApi.stopPlayback (fadeOutMillis: ${t.fadeOutMillis})`),(s=a(this,ut).get(e))==null||s.stop(a(this,pt)?0:t.fadeOutMillis??ot.muteUnmuteDefaultFadeMillis)}pausePlayback(e){var t;L.debugBeetPx("AudioApi.pausePlayback"),(t=a(this,ut).get(e))==null||t.pause()}resumePlayback(e){var t;L.debugBeetPx("AudioApi.resumePlayback"),(t=a(this,ut).get(e))==null||t.resume()}getAudioContext(){return a(this,yt)}getGlobalGainNode(){return a(this,Dt)}};xs=new WeakMap,Kn=new WeakMap,Ci=new WeakMap,yt=new WeakMap,Dt=new WeakMap,ut=new WeakMap,pt=new WeakMap,fr=new WeakSet,cu=function(e={}){L.debugBeetPx(`AudioApi.#stopAllPlaybacks (fadeOutMillis: ${e.fadeOutMillis})`);for(const t of a(this,ut).values())t.stop(a(this,pt)?0:e.fadeOutMillis??ot.muteUnmuteDefaultFadeMillis)},cr=new WeakSet,du=function(){return window.localStorage.getItem(a(ot,xs))===a(ot,Kn)},Wn=new WeakSet,xl=function(e){e?window.localStorage.setItem(a(ot,xs),a(ot,Kn)):window.localStorage.removeItem(a(ot,xs))},d(ot,xs,"audio_api__muted"),d(ot,Kn,"yes"),b(ot,"muteUnmuteDefaultFadeMillis",100);let ki=ot;class H0{static detect(e){const t=(e==null?void 0:e.toLowerCase())??"";return t.includes("firefox")?t.includes("win64")?"firefox_windows":"firefox_other":t.includes("chrome")?"chromium":t.includes("safari")?"safari":"other"}}function as(i){throw Error(i)}var ge,me,Ie,ze,As;class J0{constructor(e){b(this,"canvasSize");d(this,ge,void 0);d(this,me,void 0);d(this,Ie,void 0);d(this,ze,void 0);d(this,As,null);this.canvasSize=e.round(),_(this,ge,0),_(this,me,0),_(this,Ie,this.canvasSize.x-1),_(this,ze,this.canvasSize.y-1)}setClippingRegion(e,t){const s=[U.of(a(this,ge),a(this,me)),U.of(a(this,Ie)-a(this,ge)+1,a(this,ze)-a(this,me)+1)],[n,r]=U.minMax(e.round(),e.add(t).round());return _(this,ge,n.x),_(this,me,n.y),_(this,Ie,r.x-1),_(this,ze,r.y-1),s}removeClippingRegion(){return this.setClippingRegion(U.of(0,0),this.canvasSize)}canSetAny(e,t,s,n){return s>=a(this,ge)&&n>=a(this,me)&&e<=a(this,Ie)&&t<=a(this,ze)}canSetAt(e,t){return e>=a(this,ge)&&t>=a(this,me)&&e<=a(this,Ie)&&t<=a(this,ze)}takeSnapshot(){_(this,As,this.newSnapshot())}getMostRecentSnapshot(){return a(this,As)}render(){_(this,As,null),this.doRender()}}ge=new WeakMap,me=new WeakMap,Ie=new WeakMap,ze=new WeakMap,As=new WeakMap;var be,qn;class K0{constructor(e,t){d(this,be,void 0);d(this,qn,void 0);_(this,be,e),_(this,qn,t)}getColorAt(e,t){const s=t*a(this,qn)+e;if(s>=a(this,be).length/4)throw Error(`index out of bounds: index = ${s}, max allowed index = ${a(this,be).length/4-1}`);const n=s*4;return tt.of(a(this,be)[n],a(this,be)[n+1],a(this,be)[n+2])}}be=new WeakMap,qn=new WeakMap;var ks,Ne,Ss,Kt,Wt,dr,pu;class W0 extends J0{constructor(t,s,n){super(t);d(this,dr);d(this,ks,void 0);d(this,Ne,void 0);d(this,Ss,void 0);d(this,Kt,void 0);d(this,Wt,void 0);_(this,ks,t.x*t.y),_(this,Ne,s),a(this,Ne).style.backgroundColor=n.cssHex,_(this,Ss,a(this,Ne).getContext("2d",{colorSpace:"srgb",alpha:!0})??as("Was unable to obtain '2d' context from <canvas>")),a(this,Ss).imageSmoothingEnabled=!1;const r=document.createElement("canvas").transferControlToOffscreen();r.width=t.x,r.height=t.y,_(this,Kt,r.getContext("2d",{colorSpace:"srgb",alpha:!1})??as("Was unable to obtain '2d' context from OffscreenCanvas")),_(this,Wt,a(this,Kt).createImageData(a(this,Kt).canvas.width,a(this,Kt).canvas.height,{colorSpace:"srgb"})),u(this,dr,pu).call(this)}set(t,s,n){if(s<0||n<0||s>=this.canvasSize.x||n>=this.canvasSize.y)throw Error(`(x,y) index out of bounds: (x,y) = (${s},${n}), bottom bound = (0,0), upper bound = (${this.canvasSize.x-1},${this.canvasSize.y-1})`);const r=n*this.canvasSize.x+s;if(r>=a(this,ks))throw Error(`index out of bounds: index = ${r}, max allowed index = ${a(this,ks)-1}`);const o=r*4;a(this,Wt).data[o]=t.r,a(this,Wt).data[o+1]=t.g,a(this,Wt).data[o+2]=t.b}newSnapshot(){return new K0(a(this,Wt).data.slice(),this.canvasSize.x)}doRender(){a(this,Kt).putImageData(a(this,Wt),0,0);const t=U.of(a(this,Ne).width,a(this,Ne).height),s=Math.max(1,Math.min(t.div(this.canvasSize).floor().x,t.div(this.canvasSize).floor().y)),n=t.sub(this.canvasSize.mul(s)).div(2).floor();a(this,Ss).drawImage(a(this,Kt).canvas,0,0,a(this,Kt).canvas.width,a(this,Kt).canvas.height,n.x,n.y,s*this.canvasSize.x,s*this.canvasSize.y)}}ks=new WeakMap,Ne=new WeakMap,Ss=new WeakMap,Kt=new WeakMap,Wt=new WeakMap,dr=new WeakSet,pu=function(){for(let t=3;t<a(this,Wt).data.length;t+=4)a(this,Wt).data[t]=255};var ee,we,Be,Es,Ti,Yn,Ri,ye,ie,nt,vt,Xn,xt,Mt,ve,li;const eo=class eo{constructor(e,t){d(this,xt);d(this,ve);d(this,ee,void 0);d(this,we,void 0);d(this,Be,void 0);d(this,Es,void 0);d(this,Ti,void 0);d(this,Yn,void 0);d(this,Ri,void 0);d(this,ye,void 0);d(this,ie,void 0);d(this,nt,void 0);d(this,vt,void 0);d(this,Xn,void 0);_(this,Yn,t.onGamePause==="ignore"),_(this,Ri,t.onGamePause),_(this,ee,[...e.intro,...e.loop].map(s=>({name:s[0],frames:Math.max(0,Math.round(s[1]))}))),_(this,we,e.loop.map(s=>({name:s[0],frames:Math.max(0,Math.round(s[1]))}))),_(this,Be,a(this,ee).reduce((s,n)=>s+n.frames,0)),_(this,Es,a(this,we).reduce((s,n)=>s+n.frames,0)),_(this,Ti,a(this,ve,li)+t.delayFrames),_(this,nt,cn.for({frames:a(this,Be),loop:!1,pause:t.pause,delayFrames:t.delayFrames,onGamePause:a(this,Ri)})),_(this,vt,a(this,we).length>0?cn.for({frames:a(this,Es),loop:!0,pause:t.pause,delayFrames:t.delayFrames+a(this,Be),onGamePause:a(this,Ri)}):null),_(this,ye,!1),_(this,ie,null),t.pause&&this.pause()}static of(e,t){return new eo(e,t)}get justFinishedPhase(){return this.hasJustFinishedOverall||a(this,xt,Mt).t===0?a(this,xt,Mt).recentlyFinishedPhase:null}get currentPhase(){var e;return((e=a(this,xt,Mt).phase)==null?void 0:e.name)??null}get t(){return a(this,xt,Mt).t}get progress(){return a(this,xt,Mt).phase&&a(this,xt,Mt).phase.frames>0?a(this,xt,Mt).t/a(this,xt,Mt).phase.frames:1}get framesLeft(){return a(this,xt,Mt).phase?a(this,xt,Mt).phase.frames-a(this,xt,Mt).t:0}get tOverall(){var e;return a(this,nt).hasFinished?((e=a(this,vt))==null?void 0:e.t)??a(this,nt).t:a(this,nt).t}get framesLeftOverall(){var e;return a(this,nt).hasFinished?((e=a(this,vt))==null?void 0:e.framesLeft)??a(this,nt).framesLeft:a(this,nt).framesLeft}get progressOverall(){var e;return a(this,nt).hasFinished?((e=a(this,vt))==null?void 0:e.progress)??a(this,nt).progress:a(this,nt).progress}get hasFinishedOverall(){return a(this,nt).hasFinished}get hasJustFinishedOverall(){var e;return((e=a(this,vt))==null?void 0:e.hasJustFinished)||a(this,nt).hasJustFinished}pause(){var e;a(this,ye)||(_(this,ye,!0),_(this,ie,a(this,ve,li)),a(this,nt).pause(),(e=a(this,vt))==null||e.pause())}resume(){var e;a(this,ye)&&(_(this,ye,!1),_(this,Ti,a(this,Ti)+(a(this,ve,li)-(a(this,ie)??0))),_(this,ie,null),a(this,nt).resume(),(e=a(this,vt))==null||e.resume())}restart(){_(this,Ti,a(this,ve,li)),_(this,ye,!1),_(this,ie,null),a(this,nt).restart(),a(this,vt)&&_(this,vt,cn.for({frames:a(this,Es),loop:!0,pause:!1,delayFrames:a(this,Be),onGamePause:a(this,Ri)}))}};ee=new WeakMap,we=new WeakMap,Be=new WeakMap,Es=new WeakMap,Ti=new WeakMap,Yn=new WeakMap,Ri=new WeakMap,ye=new WeakMap,ie=new WeakMap,nt=new WeakMap,vt=new WeakMap,Xn=new WeakMap,xt=new WeakSet,Mt=function(){var o;if(((o=a(this,Xn))==null?void 0:o.frameNumber)===(a(this,ie)??a(this,ve,li)))return a(this,Xn).value;if(!a(this,vt)||(a(this,ie)??a(this,ve,li))<a(this,Ti)+a(this,Be)){const h=a(this,nt).t;let c=0,l=null,f=0;for(;f<a(this,ee).length-1;){let g=a(this,ee)[f];if(h<c+g.frames)return{recentlyFinishedPhase:(l==null?void 0:l.name)??null,phase:g,t:h-c};c+=g.frames,l=g,f+=1}let m=a(this,ee)[f]??null;return{recentlyFinishedPhase:a(this,nt).hasJustFinished?(m==null?void 0:m.name)??null:(l==null?void 0:l.name)??null,phase:m,t:h-c}}const e=a(this,vt).t;let t=0,s=a(this,ee)[a(this,ee).length-1]??null,n=0;for(;n<a(this,we).length-1;){let h=a(this,we)[n];if(e<t+h.frames)return{recentlyFinishedPhase:(s==null?void 0:s.name)??null,phase:h,t:e-t};t+=h.frames,s=h,n+=1}let r=a(this,we)[n]??null;return{recentlyFinishedPhase:(s==null?void 0:s.name)??null,phase:r,t:e-t}},ve=new WeakSet,li=function(){return a(this,Yn)?Rt.frameNumber:Rt.frameNumberOutsidePause};let Al=eo;function Vl(i,e){return i instanceof ln?ln.basedOn(i,e??Bl):ln.of(i)}const to=Vl(new tl),q0=Vl(new Tu),Y0=Vl(new Ru);function st(i,e,t){return typeof i=="string"?tt.fromCssHex(i):tt.of(i,e??0,t??0)}const X0=st("#000000"),j0=st("#ffffff");st("#ff0000");st("#00ff00");st("#0000ff");st("#00ffff");st("#ff00ff");st("#ffff00");const Q0=at;function _u(i){return(e,t,s,n)=>_n.from(i,e,t,s,n)}function V0(i,e){return Al.of({intro:i.intro??[],loop:i.loop??[]},{pause:(e==null?void 0:e.pause)??!1,delayFrames:(e==null?void 0:e.delayFrames)??0,onGamePause:(e==null?void 0:e.onGamePause)??"pause"})}function k(i,e){return U.of(i,e??i)}const It=k(0,0),Ja=k(1,1);var Le,jn,Cs,Qn,Vn,$e,Ge,Ze;class tp{constructor(e,t,s){d(this,Le,void 0);d(this,jn,void 0);d(this,Cs,void 0);d(this,Qn,void 0);d(this,Vn,void 0);d(this,$e,void 0);d(this,Ge,void 0);d(this,Ze,void 0);_(this,Le,e),_(this,jn,s.color??Q0.orange),_(this,Cs,t);const n=s.placement??"top-right";_(this,Vn,n.endsWith("-left")),_(this,Qn,n.startsWith("top-")),_(this,$e,Array.from({length:15},()=>0)),_(this,Ge,0),_(this,Ze,0)}drawRenderingFps(e){if(a(this,$e)[a(this,Ge)]=e,_(this,Ge,yi(a(this,Ge)+1,a(this,$e).length)),a(this,Ge)===0){_(this,Ze,0);for(const r of a(this,$e))_(this,Ze,a(this,Ze)+r);_(this,Ze,a(this,Ze)/a(this,$e).length)}const t=a(this,Le).useFont(to),s=a(this,Ze).toFixed(),n=T.measureText(s).wh;a(this,Le).drawText(s,a(this,Le).cameraXy.add(a(this,Vn)?1:a(this,Cs).x-n.x-1,a(this,Qn)?1:a(this,Cs).y-n.y-1),a(this,jn)),a(this,Le).useFont(t)}}Le=new WeakMap,jn=new WeakMap,Cs=new WeakMap,Qn=new WeakMap,Vn=new WeakMap,$e=new WeakMap,Ge=new WeakMap,Ze=new WeakMap;var Ts;const pr=class pr{static get active(){return a(pr,Ts)}static set active(e){_(this,Ts,e),L.infoBeetPx(`FrameByFrame flag set to: ${a(this,Ts)}`)}};Ts=new WeakMap,d(pr,Ts,!1);let oi=pr;var Mi;class ep{constructor(e){d(this,Mi,void 0);_(this,Mi,e)}draw(e){for(let t=0;t<a(this,Mi).canvasSize.x;++t)for(let s=0;s<a(this,Mi).canvasSize.y;++s)a(this,Mi).set(e,t,s)}}Mi=new WeakMap;var _t,V,it;class ip{constructor(e){d(this,V);d(this,_t,void 0);_(this,_t,e)}draw(e,t,s,n,r){const[o,h]=U.minMax(e.round(),e.add(t).round());if(h.x-o.x<=0||h.y-o.y<=0||!a(this,_t).canSetAny(o.x,o.y,h.x-1,h.y-1))return;const c=s.type==="pattern"?s.primary:s,l=s.type==="pattern"?s.secondary:null,f=(c==null?void 0:c.type)==="canvas_snapshot_mapping"?a(this,_t).getMostRecentSnapshot():null,m=r;let g=h.x-o.x-1,p=h.y-o.y-1,y=p&1,N=o.x,D=h.x-1,R=o.y+Math.floor((p+1)/2),I=R-y,B=4*(1-g)*p*p,x=4*(y+1)*g*g,H=B+x+y*g*g;g=8*g*g,y=8*p*p;do{if(u(this,V,it).call(this,N,I,c,l,m,f),u(this,V,it).call(this,D,I,c,l,m,f),u(this,V,it).call(this,D,R,c,l,m,f),u(this,V,it).call(this,N,R,c,l,m,f),n==="inside")for(let C=N+1;C<D;++C)u(this,V,it).call(this,C,I,c,l,m,f),u(this,V,it).call(this,C,R,c,l,m,f);else if(n==="outside"){for(let C=0;C<N;++C)u(this,V,it).call(this,C,I,c,l,m,f),u(this,V,it).call(this,C,R,c,l,m,f);for(let C=D+1;C<a(this,_t).canvasSize.x;++C)u(this,V,it).call(this,C,I,c,l,m,f),u(this,V,it).call(this,C,R,c,l,m,f)}const G=H;2*G<=x&&(R+=1,I-=1,x+=g,H+=x),(2*G>=B||2*H>x)&&(N+=1,D-=1,B+=y,H+=B)}while(N<=D);for(;R-I<=p;){if(u(this,V,it).call(this,N-1,R,c,l,m,f),u(this,V,it).call(this,D+1,R,c,l,m,f),n==="outside"){for(let G=0;G<N-1;++G)u(this,V,it).call(this,G,R,c,l,m,f);for(let G=D+2;G<a(this,_t).canvasSize.x;++G)u(this,V,it).call(this,G,R,c,l,m,f)}if(R+=1,u(this,V,it).call(this,N-1,I,c,l,m,f),u(this,V,it).call(this,D+1,I,c,l,m,f),n==="outside"){for(let G=0;G<N-1;++G)u(this,V,it).call(this,G,I,c,l,m,f);for(let G=D+2;G<a(this,_t).canvasSize.x;++G)u(this,V,it).call(this,G,I,c,l,m,f)}I-=1}if(n==="outside")for(let G=0;G<a(this,_t).canvasSize.x;++G){for(let C=0;C<I+1;++C)u(this,V,it).call(this,G,C,c,l,m,f);for(let C=R;C<a(this,_t).canvasSize.y;++C)u(this,V,it).call(this,G,C,c,l,m,f)}}}_t=new WeakMap,V=new WeakSet,it=function(e,t,s,n,r,o){if(a(this,_t).canSetAt(e,t))if(r.hasPrimaryColorAt(e,t)){if(s)if(s.type==="rgb")a(this,_t).set(s,e,t);else{const h=s.getMappedColor(o,e,t);h&&a(this,_t).set(h,e,t)}}else n!=null&&a(this,_t).set(n,e,t)};var xe,_r,gu;class sp{constructor(e){d(this,_r);d(this,xe,void 0);_(this,xe,e)}draw(e,t,s,n){const r=e.round(),o=e.add(t).round();if(o.x-r.x===0||o.y-r.y===0)return;t=o.sub(r);const h=t.sub(t.sign()),c=s.type==="pattern"?s.primary:s,l=s.type==="pattern"?s.secondary:null,f=(c==null?void 0:c.type)==="canvas_snapshot_mapping"?a(this,xe).getMostRecentSnapshot():null,m=n;let g=h.abs().mul(k(1,-1)),p=r;const y=r.add(h),N=h.sign();let D=g.x+g.y;for(;u(this,_r,gu).call(this,p.x,p.y,c,l,m,f),!p.eq(y);){const R=D;2*R>=g.y&&(p=p.add(k(N.x,0)),D+=g.y),2*R<=g.x&&(p=p.add(k(0,N.y)),D+=g.x)}}}xe=new WeakMap,_r=new WeakSet,gu=function(e,t,s,n,r,o){if(a(this,xe).canSetAt(e,t))if(r.hasPrimaryColorAt(e,t)){if(s)if(s.type==="rgb")a(this,xe).set(s,e,t);else{const h=s.getMappedColor(o,e,t);h&&a(this,xe).set(h,e,t)}}else n!=null&&a(this,xe).set(n,e,t)};var Rs;class np{constructor(e){d(this,Rs,void 0);_(this,Rs,e)}draw(e,t,s){e=e.round(),a(this,Rs).canSetAt(e.x,e.y)&&s.hasPrimaryColorAt(e.x,e.y)&&a(this,Rs).set(t,e.x,e.y)}}Rs=new WeakMap;var Ms,ta;class mu{constructor(e,t={}){d(this,Ms,void 0);d(this,ta,void 0);_(this,Ms,e),_(this,ta,t)}draw(e,t,s,n,r,o){t=a(this,ta).disableRounding?t:t.round(),n=U.max(n.floor(),It);for(let h=0;h<e.asciiRows.length;h+=1){const c=t.y+(r[1]?e.size.y-1-h:h)*n.y;for(let l=0;l<e.asciiRows[h].length;l+=1){const f=t.x+(r[0]?e.size.x-1-l:l)*n.x;if(e.asciiRows[h][l]==="#")for(let m=0;m<n.y;++m)for(let g=0;g<n.x;++g){const p=c+m,y=f+g;o.hasPrimaryColorAt(y,p)&&a(this,Ms).canSetAt(y,p)&&a(this,Ms).set(s,y,p)}}}}}Ms=new WeakMap,ta=new WeakMap;var At,ft,mt;class ap{constructor(e){d(this,ft);d(this,At,void 0);_(this,At,e)}draw(e,t,s,n,r){const[o,h]=U.minMax(e.round(),e.add(t).round());if(!a(this,At).canSetAny(o.x,o.y,h.x-1,h.y-1))return;const c=s.type==="pattern"?s.primary:s,l=s.type==="pattern"?s.secondary:null,f=(c==null?void 0:c.type)==="canvas_snapshot_mapping"?a(this,At).getMostRecentSnapshot():null,m=r;for(let g=o.x;g<h.x;g+=1)u(this,ft,mt).call(this,g,o.y,c,l,m,f),u(this,ft,mt).call(this,g,h.y-1,c,l,m,f);for(let g=o.y+1;g<h.y-1;g+=1)u(this,ft,mt).call(this,o.x,g,c,l,m,f),u(this,ft,mt).call(this,h.x-1,g,c,l,m,f);if(n==="inside")for(let g=o.x;g<h.x;g+=1)for(let p=o.y+1;p<h.y-1;p+=1)u(this,ft,mt).call(this,g,p,c,l,m,f);else if(n==="outside"){for(let g=0;g<o.x;g+=1){for(let p=0;p<o.y;p+=1)u(this,ft,mt).call(this,g,p,c,l,m,f);for(let p=o.y;p<h.y;p+=1)u(this,ft,mt).call(this,g,p,c,l,m,f);for(let p=h.y;p<a(this,At).canvasSize.y;p+=1)u(this,ft,mt).call(this,g,p,c,l,m,f)}for(let g=o.x;g<h.x;g+=1)for(let p=0;p<o.y;p+=1)u(this,ft,mt).call(this,g,p,c,l,m,f);for(let g=o.x;g<h.x;g+=1)for(let p=h.y;p<a(this,At).canvasSize.y;p+=1)u(this,ft,mt).call(this,g,p,c,l,m,f);for(let g=h.x;g<a(this,At).canvasSize.x;g+=1){for(let p=0;p<o.y;p+=1)u(this,ft,mt).call(this,g,p,c,l,m,f);for(let p=o.y;p<h.y;p+=1)u(this,ft,mt).call(this,g,p,c,l,m,f);for(let p=h.y;p<a(this,At).canvasSize.y;p+=1)u(this,ft,mt).call(this,g,p,c,l,m,f)}}}}At=new WeakMap,ft=new WeakSet,mt=function(e,t,s,n,r,o){if(a(this,At).canSetAt(e,t))if(r.hasPrimaryColorAt(e,t)){if(s)if(s.type==="rgb")a(this,At).set(s,e,t);else{const h=s.getMappedColor(o,e,t);h&&a(this,At).set(h,e,t)}}else n!=null&&a(this,At).set(n,e,t)};var Fs;class rp{constructor(){d(this,Fs,new Map)}prepareOrGetFromCache(e,t,s,n){const r=e.imageUrl+"::"+e.xy.x.toString()+":"+e.xy.y.toString()+":"+e.size.x.toString()+":"+e.size.y.toString();if(a(this,Fs).has(r))return a(this,Fs).get(r);const o=e.size.x,h=e.size.y,c=tr(o).map(()=>tr(h).map(()=>null));for(let f=0;f<h;++f){const m=e.xy.y+f;for(let g=0;g<o;++g){const p=e.xy.x+g,y=(m*s+p)*n;c[g][f]=n===3||t[y+3]>=255/2?st(t[y],t[y+1],t[y+2]):null}}const l={w:e.size.x,h:e.size.y,colors:c,cacheHit:!0};return a(this,Fs).set(r,l),{...l,cacheHit:!1}}}Fs=new WeakMap;var gr,Fi,ea;class bu{constructor(e,t={}){d(this,gr,new rp);d(this,Fi,void 0);d(this,ea,void 0);_(this,Fi,e),_(this,ea,t)}draw(e,t,s,n,r,o,h){s=a(this,ea).disableRounding?s:s.round(),n=U.max(n.floor(),It);const{width:c,height:l,channels:f,rgba8bitData:m}=t;if(e=e.clipBy(It,k(c,l)),!a(this,Fi).canSetAny(s.x,s.y,s.x+e.size.x*n.x-1,s.y+e.size.y*n.y-1))return;const g=a(this,gr).prepareOrGetFromCache(e,m,c,f);for(let p=0;p<g.h;p+=1){const y=s.y+(r[1]?e.size.y-1-p:p)*n.y;for(let N=0;N<g.w;N+=1){const D=s.x+(r[0]?e.size.x-1-N:N)*n.x;for(let R=0;R<n.y;++R)for(let I=0;I<n.x;++I){const B=D+I,x=y+R;if(a(this,Fi).canSetAt(B,x)&&h.hasPrimaryColorAt(B,x)){const H=g.colors[N][p];if(H){const G=o.getMappedColor(H,N,p);G&&a(this,Fi).set(G,B,x)}}}}}}}gr=new WeakMap,Fi=new WeakMap,ea=new WeakMap;var Os,ia,sa,na;class lp{constructor(e,t){d(this,Os,void 0);d(this,ia,void 0);d(this,sa,void 0);d(this,na,void 0);_(this,Os,e),_(this,ia,t),_(this,sa,new bu(a(this,Os),{disableRounding:!0})),_(this,na,new mu(a(this,Os),{disableRounding:!0}))}draw(e,t,s,n,r,o,h){s=s.round(),o=U.max(o.floor(),It);for(const c of t.arrangeGlyphsFor(e,n,r)){if(c.type==="line_break")continue;const l=s.add(c.leftTop.mul(o));c.type==="sprite"?a(this,sa).draw(c.sprite,a(this,ia).getImageAsset(c.sprite.imageUrl),l,o,[!1,!1],c.spriteColorMapping,h):c.type==="pixels"?a(this,na).draw(c.pixels,l,c.color,o,[!1,!1],h):Nl()}}}Os=new WeakMap,ia=new WeakMap,sa=new WeakMap,na=new WeakMap;var aa,Oi,ra,la,oa,ha,Di,Pi,ua,fa,ct,Ds,se,Ui;class op{constructor(e){d(this,aa,void 0);d(this,Oi,void 0);d(this,ra,void 0);d(this,la,void 0);d(this,oa,void 0);d(this,ha,void 0);d(this,Di,void 0);d(this,Pi,void 0);d(this,ua,void 0);d(this,fa,void 0);b(this,"cameraXy",k(0,0));d(this,ct,Qr.primaryOnly);d(this,Ds,Qe.noMapping);d(this,se,to);d(this,Ui,{});_(this,aa,e.assets),_(this,Oi,e.canvas),_(this,ra,new ep(e.canvas)),_(this,la,new np(e.canvas)),_(this,oa,new mu(e.canvas)),_(this,ha,new sp(e.canvas)),_(this,Di,new ap(e.canvas)),_(this,Pi,new ip(e.canvas)),_(this,ua,new bu(e.canvas)),_(this,fa,new lp(e.canvas,e.assets))}clearCanvas(e){a(this,ra).draw(e)}setClippingRegion(e,t){return a(this,Oi).setClippingRegion(e,t)}removeClippingRegion(){return a(this,Oi).removeClippingRegion()}setCameraXy(e){const t=this.cameraXy;return this.cameraXy=e,t}setDrawingPattern(e){const t=a(this,ct);return _(this,ct,e),t}drawPixel(e,t){a(this,la).draw(e.sub(this.cameraXy),t,a(this,ct))}drawPixels(e,t,s,n){var o,h;const r=(n==null?void 0:n.centerXy)??[!1,!1];(r[0]||r[1])&&(t=t.sub(r[0]?e.size.x*(((o=n==null?void 0:n.scaleXy)==null?void 0:o.x)??1)/2:0,r[1]?e.size.y*(((h=n==null?void 0:n.scaleXy)==null?void 0:h.y)??1)/2:0)),a(this,oa).draw(e,t.sub(this.cameraXy),s,(n==null?void 0:n.scaleXy)??Ja,(n==null?void 0:n.flipXy)??[!1,!1],a(this,ct))}drawLine(e,t,s){a(this,ha).draw(e.sub(this.cameraXy),t,s,a(this,ct))}drawRect(e,t,s){a(this,Di).draw(e.sub(this.cameraXy),t,s,"none",a(this,ct))}drawRectFilled(e,t,s){a(this,Di).draw(e.sub(this.cameraXy),t,s,"inside",a(this,ct))}drawRectOutsideFilled(e,t,s){a(this,Di).draw(e.sub(this.cameraXy),t,s,"outside",a(this,ct))}drawEllipse(e,t,s){a(this,Pi).draw(e.sub(this.cameraXy),t,s,"none",a(this,ct))}drawEllipseFilled(e,t,s){a(this,Pi).draw(e.sub(this.cameraXy),t,s,"inside",a(this,ct))}drawEllipseOutsideFilled(e,t,s){a(this,Pi).draw(e.sub(this.cameraXy),t,s,"outside",a(this,ct))}setSpriteColorMapping(e){const t=a(this,Ds);return _(this,Ds,e),t}drawSprite(e,t,s){var o,h;const n=(s==null?void 0:s.centerXy)??[!1,!1];(n[0]||n[1])&&(t=t.sub(n[0]?e.size.x*(((o=s==null?void 0:s.scaleXy)==null?void 0:o.x)??1)/2:0,n[1]?e.size.y*(((h=s==null?void 0:s.scaleXy)==null?void 0:h.y)??1)/2:0));const r=a(this,aa).getImageAsset(e.imageUrl);a(this,ua).draw(e.type==="static"?e:e.current,r,t.sub(this.cameraXy),(s==null?void 0:s.scaleXy)??Ja,(s==null?void 0:s.flipXy)??[!1,!1],a(this,Ds),a(this,ct))}useFont(e){const t=a(this,se);return _(this,se,e),t}setTextColorMarkers(e){const t=a(this,Ui);return _(this,Ui,e),t}measureText(e,t){var h,c;let s=0,n=0;for(const l of a(this,se).arrangeGlyphsFor(e,j0,a(this,Ui)))l.type==="line_break"?s=Math.max(s,l.lineNumber+1):(s=Math.max(s,l.lineNumber),n=Math.max(n,l.leftTop.x+(l.type==="sprite"?l.sprite.size.x:l.pixels.size.x)));const r=k(n,(s+1)*(a(this,se).ascent+a(this,se).descent)+s*a(this,se).lineGap).mul((t==null?void 0:t.scaleXy)??Ja),o=k((h=t==null?void 0:t.centerXy)!=null&&h[0]?-r.x/2:0,(c=t==null?void 0:t.centerXy)!=null&&c[1]?-r.y/2:0);return{wh:r,offset:o}}drawText(e,t,s,n){const r=(n==null?void 0:n.centerXy)??[!1,!1];if(r[0]||r[1]){const{offset:o}=this.measureText(e,{scaleXy:n==null?void 0:n.scaleXy,centerXy:n==null?void 0:n.centerXy});t=t.add(o)}a(this,fa).draw(e,a(this,se),t.sub(this.cameraXy),s,a(this,Ui),(n==null?void 0:n.scaleXy)??Ja,a(this,ct))}takeCanvasSnapshot(){return a(this,Oi).takeSnapshot()}}aa=new WeakMap,Oi=new WeakMap,ra=new WeakMap,la=new WeakMap,oa=new WeakMap,ha=new WeakMap,Di=new WeakMap,Pi=new WeakMap,ua=new WeakMap,fa=new WeakMap,ct=new WeakMap,Ds=new WeakMap,se=new WeakMap,Ui=new WeakMap;var He,Ii,zi,Ni,Bi,Ps,Va;class zt{constructor(){d(this,Ps);d(this,He,!1);d(this,Ii,!1);d(this,zi,null);d(this,Ni,null);d(this,Bi,null)}setRepeating(e){_(this,zi,e.firstRepeatFrames),_(this,Ni,e.loopedRepeatFrames)}get isPressed(){return a(this,He)}get wasJustPressed(){var e;return a(this,Ii)&&a(this,He)||a(this,Ps,Va)&&((e=a(this,Bi))==null?void 0:e.justFinishedPhase)!=null}get wasJustReleased(){var e;return a(this,Ii)&&!a(this,He)||a(this,Ps,Va)&&((e=a(this,Bi))==null?void 0:e.justFinishedPhase)!=null}update(e){e?a(this,Ii)&&a(this,Ps,Va)&&_(this,Bi,V0({intro:a(this,zi)?[["first",a(this,zi)]]:void 0,loop:a(this,Ni)?[["looped",a(this,Ni)]]:void 0},{onGamePause:"ignore"})):_(this,Bi,null),_(this,Ii,a(this,He)!==e),_(this,He,e)}}He=new WeakMap,Ii=new WeakMap,zi=new WeakMap,Ni=new WeakMap,Bi=new WeakMap,Ps=new WeakSet,Va=function(){return a(this,zi)!=null||a(this,Ni)!=null};var qt,Yt,Xt,jt,ne,ae,re;class hp{constructor(){d(this,qt,new zt);d(this,Yt,new zt);d(this,Xt,new zt);d(this,jt,new zt);d(this,ne,new zt);d(this,ae,new zt);d(this,re,new zt)}update(e){a(this,qt).update(e.has("button_left")),a(this,Yt).update(e.has("button_right")),a(this,Xt).update(e.has("button_up")),a(this,jt).update(e.has("button_down")),a(this,ne).update(e.has("button_a")),a(this,ae).update(e.has("button_b")),a(this,re).update(e.has("button_menu"))}isAnyPressed(){return a(this,qt).isPressed||a(this,Yt).isPressed||a(this,Xt).isPressed||a(this,jt).isPressed||a(this,ne).isPressed||a(this,ae).isPressed||a(this,re).isPressed}isPressed(e){switch(e){case"left":return a(this,qt).isPressed;case"right":return a(this,Yt).isPressed;case"up":return a(this,Xt).isPressed;case"down":return a(this,jt).isPressed;case"a":return a(this,ne).isPressed;case"b":return a(this,ae).isPressed;case"menu":return a(this,re).isPressed}}getPressedDirection(){return k((a(this,qt).isPressed?-1:0)+(a(this,Yt).isPressed?1:0),(a(this,Xt).isPressed?-1:0)+(a(this,jt).isPressed?1:0))}setButtonRepeating(e,t){switch(e){case"left":a(this,qt).setRepeating(t);return;case"right":a(this,Yt).setRepeating(t);return;case"up":a(this,Xt).setRepeating(t);return;case"down":a(this,jt).setRepeating(t);return;case"a":a(this,ne).setRepeating(t);return;case"b":a(this,ae).setRepeating(t);return;case"menu":a(this,re).setRepeating(t);return}}wasAnyJustPressed(){return a(this,qt).wasJustPressed||a(this,Yt).wasJustPressed||a(this,Xt).wasJustPressed||a(this,jt).wasJustPressed||a(this,ne).wasJustPressed||a(this,ae).wasJustPressed||a(this,re).wasJustPressed}wasJustPressed(e){switch(e){case"left":return a(this,qt).wasJustPressed;case"right":return a(this,Yt).wasJustPressed;case"up":return a(this,Xt).wasJustPressed;case"down":return a(this,jt).wasJustPressed;case"a":return a(this,ne).wasJustPressed;case"b":return a(this,ae).wasJustPressed;case"menu":return a(this,re).wasJustPressed}}wasJustReleased(e){switch(e){case"left":return a(this,qt).wasJustReleased;case"right":return a(this,Yt).wasJustReleased;case"up":return a(this,Xt).wasJustReleased;case"down":return a(this,jt).wasJustReleased;case"a":return a(this,ne).wasJustReleased;case"b":return a(this,ae).wasJustReleased;case"menu":return a(this,re).wasJustReleased}}}qt=new WeakMap,Yt=new WeakMap,Xt=new WeakMap,jt=new WeakMap,ne=new WeakMap,ae=new WeakMap,re=new WeakMap;function wu(i){return i!=null}var Li;const ui=class ui{eventForButton(e,t){if(!t.pressed)return null;switch(e){case 0:case 4:return"button_a";case 1:case 3:return"button_b";case 10:case 11:return"button_menu"}return null}eventsForAxisValue(e,t){if(e===9){const s=t*7+8;if(s<.5||s>15.5||s>7.5&&s<8.5)return[];switch(Math.round(s)){case 1:return["button_up"];case 3:return["button_up","button_right"];case 5:return["button_right"];case 7:return["button_down","button_right"];case 9:return["button_down"];case 11:return["button_down","button_left"];case 13:return["button_left"];case 15:return["button_up","button_left"];default:return[]}}switch(e){case 0:case 2:return t>a(ui,Li)?["button_right"]:t<-a(ui,Li)?["button_left"]:[];case 1:case 5:return t>a(ui,Li)?["button_down"]:t<-a(ui,Li)?["button_up"]:[];default:return[]}}};Li=new WeakMap,d(ui,Li,.6);let kl=ui;var $i;const fi=class fi{eventForButton(e,t){if(!t.pressed)return null;switch(e){case 0:case 3:case 4:case 7:return"button_a";case 1:case 2:case 5:case 6:return"button_b";case 12:return"button_up";case 13:return"button_down";case 14:return"button_left";case 15:return"button_right";case 8:case 9:case 10:case 11:case 16:case 17:return"button_menu"}return null}eventsForAxisValue(e,t){switch(e){case 0:case 2:return t>a(fi,$i)?["button_right"]:t<-a(fi,$i)?["button_left"]:[];case 1:case 3:return t>a(fi,$i)?["button_down"]:t<-a(fi,$i)?["button_up"]:[];default:return[]}}};$i=new WeakMap,d(fi,$i,.6);let Sl=fi;var Gi;const ci=class ci{eventForButton(e,t){if(!t.pressed)return null;switch(e){case 0:case 4:return"button_a";case 1:case 3:return"button_b";case 10:case 11:return"button_menu"}return null}eventsForAxisValue(e,t){if(e===0){const s=t*7+8;if(s<.5||s>15.5||s>7.5&&s<8.5)return[];switch(Math.round(s)){case 1:return["button_up"];case 3:return["button_up","button_right"];case 5:return["button_right"];case 7:return["button_down","button_right"];case 9:return["button_down"];case 11:return["button_down","button_left"];case 13:return["button_left"];case 15:return["button_up","button_left"];default:return[]}}switch(e){case 1:case 3:return t>a(ci,Gi)?["button_right"]:t<-a(ci,Gi)?["button_left"]:[];case 2:case 4:return t>a(ci,Gi)?["button_down"]:t<-a(ci,Gi)?["button_up"]:[];default:return[]}}};Gi=new WeakMap,d(ci,Gi,.6);let El=ci;var Zi;const di=class di{eventForButton(e,t){if(!t.pressed)return null;switch(e){case 0:case 4:return"button_a";case 1:case 3:return"button_b";case 10:case 11:return"button_menu"}return null}eventsForAxisValue(e,t){if(e===9){const s=t*7+8;if(s<.5||s>15.5||s>7.5&&s<8.5)return[];switch(Math.round(s)){case 1:return["button_up"];case 3:return["button_up","button_right"];case 5:return["button_right"];case 7:return["button_down","button_right"];case 9:return["button_down"];case 11:return["button_down","button_left"];case 13:return["button_left"];case 15:return["button_up","button_left"];default:return[]}}switch(e){case 0:case 2:return t>a(di,Zi)?["button_right"]:t<-a(di,Zi)?["button_left"]:[];case 1:case 5:return t>a(di,Zi)?["button_down"]:t<-a(di,Zi)?["button_up"]:[];default:return[]}}};Zi=new WeakMap,d(di,Zi,.6);let Cl=di;var Hi;const pi=class pi{eventForButton(e,t){if(!t.pressed)return null;switch(e){case 1:case 3:return"button_a";case 0:case 2:return"button_b";case 9:return"button_menu"}return null}eventsForAxisValue(e,t){if(e===4){const s=t*7+8;if(s<.5||s>15.5||s>7.5&&s<8.5)return[];switch(Math.round(s)){case 1:return["button_up"];case 3:return["button_up","button_right"];case 5:return["button_right"];case 7:return["button_down","button_right"];case 9:return["button_down"];case 11:return["button_down","button_left"];case 13:return["button_left"];case 15:return["button_up","button_left"];default:return[]}}switch(e){case 0:case 2:return t>a(pi,Hi)?["button_right"]:t<-a(pi,Hi)?["button_left"]:[];case 1:case 3:return t>a(pi,Hi)?["button_down"]:t<-a(pi,Hi)?["button_up"]:[];default:return[]}}};Hi=new WeakMap,d(pi,Hi,.6);let Tl=pi;var Ji;const _i=class _i{eventForButton(e,t){if(!t.pressed)return null;switch(e){case 1:case 3:return"button_a";case 0:case 2:return"button_b";case 9:return"button_menu"}return null}eventsForAxisValue(e,t){switch(e){case 0:case 2:return t>a(_i,Ji)?["button_right"]:t<-a(_i,Ji)?["button_left"]:[];case 1:case 5:return t>a(_i,Ji)?["button_down"]:t<-a(_i,Ji)?["button_up"]:[];default:return[]}}};Ji=new WeakMap,d(_i,Ji,.6);let Rl=_i;var Ki;const gi=class gi{eventForButton(e,t){if(!t.pressed)return null;switch(e){case 1:case 5:case 4:case 7:return"button_a";case 2:case 3:case 0:case 6:return"button_b";case 12:return"button_up";case 13:return"button_down";case 14:return"button_left";case 15:return"button_right";case 16:case 8:case 9:case 10:case 11:case 17:return"button_menu"}return null}eventsForAxisValue(e,t){switch(e){case 0:case 2:return t>a(gi,Ki)?["button_right"]:t<-a(gi,Ki)?["button_left"]:[];case 1:case 3:return t>a(gi,Ki)?["button_down"]:t<-a(gi,Ki)?["button_up"]:[];default:return[]}}};Ki=new WeakMap,d(gi,Ki,.6);let Ml=gi;var Wi;const mi=class mi{eventForButton(e,t){if(!t.pressed)return null;switch(e){case 0:case 3:return"button_a";case 1:case 2:return"button_b";case 12:return"button_up";case 13:return"button_down";case 14:return"button_left";case 15:return"button_right";case 8:case 9:return"button_menu"}return null}eventsForAxisValue(e,t){switch(e){case 0:case 2:return t>a(mi,Wi)?["button_right"]:t<-a(mi,Wi)?["button_left"]:[];case 1:case 3:return t>a(mi,Wi)?["button_down"]:t<-a(mi,Wi)?["button_up"]:[];default:return[]}}};Wi=new WeakMap,d(mi,Wi,.6);let Fl=mi;var qi;const bi=class bi{eventForButton(e,t){if(!t.pressed)return null;switch(e){case 0:case 3:return"button_a";case 1:case 2:return"button_b";case 12:return"button_up";case 13:return"button_down";case 14:return"button_left";case 15:return"button_right";case 9:return"button_menu"}return null}eventsForAxisValue(e,t){switch(e){case 0:case 2:return t>a(bi,qi)?["button_right"]:t<-a(bi,qi)?["button_left"]:[];case 1:case 3:return t>a(bi,qi)?["button_down"]:t<-a(bi,qi)?["button_up"]:[];default:return[]}}};qi=new WeakMap,d(bi,qi,.6);let Ol=bi;var Ae,Pt,mr,yu;class up{constructor(e){d(this,mr);b(this,"inputMethod","gamepad");d(this,Ae,void 0);d(this,Pt,{standard:new Ol,firefoxDualSenseWindows:new Rl,firefoxDualSenseOther:new Tl,firefox8bitdoWindows:new Cl,firefox8bitdoOther:new El,firefoxOther:new Ml,safari8bitdo:new Fl,"8bitdo":new kl,other:new Sl});_(this,Ae,e.browserType)}startListening(){}update(e){let t=!1;for(const s of navigator.getGamepads()){if(!s)continue;const n=u(this,mr,yu).call(this,s);for(let r=0;r<s.buttons.length;++r){const o=n.eventForButton(r,s.buttons[r]);o&&(e.add(o),t=!0)}for(let r=0;r<s.axes.length;++r)n.eventsForAxisValue(r,s.axes[r]).forEach(o=>{e.add(o),t=!0})}return t}connectedGamepadTypes(){return new Set(navigator.getGamepads().filter(wu).map(e=>el.detect(e)))}}Ae=new WeakMap,Pt=new WeakMap,mr=new WeakSet,yu=function(e){const t=el.detect(e);return a(this,Ae)==="firefox_windows"||a(this,Ae)==="firefox_other"?t==="dualsense"?a(this,Ae)==="firefox_windows"?a(this,Pt).firefoxDualSenseWindows:a(this,Pt).firefoxDualSenseOther:t==="8bitdo"?a(this,Ae)==="firefox_windows"?a(this,Pt).firefox8bitdoWindows:a(this,Pt).firefox8bitdoOther:a(this,Pt).firefoxOther:t==="8bitdo"?a(this,Ae)==="safari"?a(this,Pt).safari8bitdo:a(this,Pt)["8bitdo"]:e.mapping==="standard"?a(this,Pt).standard:a(this,Pt).other};var Je,Yi;class fp{constructor(e){b(this,"inputMethod","keyboard");d(this,Je,new Map([["ArrowLeft","button_left"],["ArrowRight","button_right"],["ArrowUp","button_up"],["ArrowDown","button_down"],["w","button_up"],["W","button_up"],["s","button_down"],["S","button_down"],["a","button_left"],["A","button_left"],["d","button_right"],["D","button_right"],["j","button_a"],["J","button_a"],["k","button_b"],["K","button_b"],["c","button_a"],["C","button_a"],["x","button_b"],["x","button_b"],["p","button_menu"],["P","button_menu"],["Escape","button_menu"],["Enter","button_menu"],["m","mute_unmute_toggle"],["M","mute_unmute_toggle"],["f","full_screen"],["F","full_screen"]]));d(this,Yi,new Set);e.enableDebugToggle&&a(this,Je).set(";","debug_toggle"),e.enableFrameByFrameControls&&(a(this,Je).set(",","frame_by_frame_toggle"),a(this,Je).set(".","frame_by_frame_step"))}startListening(){document.addEventListener("keydown",e=>{const t=a(this,Je).get(e.key);t&&(e.preventDefault(),a(this,Yi).add(t))}),document.addEventListener("keyup",e=>{const t=a(this,Je).get(e.key);t&&(e.preventDefault(),a(this,Yi).delete(t))})}update(e){let t=!1;for(const s of a(this,Yi))e.add(s),t=!0;return a(this,Yi).delete("full_screen"),t}}Je=new WeakMap,Yi=new WeakMap;var Xi;const br=class br{constructor(){b(this,"inputMethod","mouse");d(this,Xi,new Set)}startListening(){br.mapping.forEach(({event:e,selector:t})=>{document.querySelectorAll(t).forEach(s=>{s.addEventListener("mousedown",()=>{a(this,Xi).add(e)}),s.addEventListener("mouseup",()=>{a(this,Xi).delete(e)})})})}update(e){let t=!1;for(const s of a(this,Xi))e.add(s),t=!0;return a(this,Xi).delete("full_screen"),t}};Xi=new WeakMap,b(br,"mapping",[{event:"button_left",selector:$.selectors.controlsLeft},{event:"button_left",selector:$.selectors.controlsUpLeft},{event:"button_left",selector:$.selectors.controlsDownLeft},{event:"button_right",selector:$.selectors.controlsRight},{event:"button_right",selector:$.selectors.controlsUpRight},{event:"button_right",selector:$.selectors.controlsDownRight},{event:"button_up",selector:$.selectors.controlsUp},{event:"button_up",selector:$.selectors.controlsUpLeft},{event:"button_up",selector:$.selectors.controlsUpRight},{event:"button_down",selector:$.selectors.controlsDown},{event:"button_down",selector:$.selectors.controlsDownLeft},{event:"button_down",selector:$.selectors.controlsDownRight},{event:"button_a",selector:$.selectors.controlsA},{event:"button_b",selector:$.selectors.controlsB},{event:"button_menu",selector:$.selectors.controlsMenu},{event:"mute_unmute_toggle",selector:$.selectors.controlsMuteToggle},{event:"full_screen",selector:$.selectors.controlsFullScreen}]);let Dl=br;var j,ji,Ke,Qi,rn,ca,Ul;const X=class X{constructor(){d(this,Qi);d(this,ca);b(this,"inputMethod","touch");d(this,ji,[{bitMask:a(X,j).up|a(X,j).left,events:["button_up","button_left"],requiresStart:!1,selector:$.selectors.controlsUpLeft,elements:[]},{bitMask:a(X,j).up,events:["button_up"],requiresStart:!1,selector:$.selectors.controlsUp,elements:[]},{bitMask:a(X,j).up|a(X,j).right,events:["button_up","button_right"],requiresStart:!1,selector:$.selectors.controlsUpRight,elements:[]},{bitMask:a(X,j).left,events:["button_left"],requiresStart:!1,selector:$.selectors.controlsLeft,elements:[]},{bitMask:a(X,j).right,events:["button_right"],requiresStart:!1,selector:$.selectors.controlsRight,elements:[]},{bitMask:a(X,j).down|a(X,j).left,events:["button_down","button_left"],requiresStart:!1,selector:$.selectors.controlsDownLeft,elements:[]},{bitMask:a(X,j).down,events:["button_down"],requiresStart:!1,selector:$.selectors.controlsDown,elements:[]},{bitMask:a(X,j).down|a(X,j).right,events:["button_down","button_right"],requiresStart:!1,selector:$.selectors.controlsDownRight,elements:[]},{bitMask:a(X,j).a,events:["button_a"],requiresStart:!1,selector:$.selectors.controlsA,elements:[]},{bitMask:a(X,j).b,events:["button_b"],requiresStart:!1,selector:$.selectors.controlsB,elements:[]},{bitMask:a(X,j).menu,events:["button_menu"],requiresStart:!0,selector:$.selectors.controlsMenu,elements:[]},{bitMask:a(X,j).muteUnmute,events:["mute_unmute_toggle"],requiresStart:!0,selector:$.selectors.controlsMuteToggle,elements:[]},{bitMask:a(X,j).fullScreen,events:["full_screen"],requiresStart:!0,selector:$.selectors.controlsFullScreen,elements:[]}]);d(this,Ke,new Map);a(this,ji).forEach(({selector:e,elements:t})=>{t.push(...document.querySelectorAll(e))})}startListening(){document.addEventListener("touchstart",u(this,Qi,rn).bind(this)),document.addEventListener("touchmove",u(this,Qi,rn).bind(this)),document.addEventListener("touchcancel",u(this,Qi,rn).bind(this)),document.addEventListener("touchend",u(this,Qi,rn).bind(this))}update(e){let t=!1;for(const[s,n]of a(this,Ke).entries()){for(const{bitMask:r,events:o}of a(this,ji))if((n&r)===r)for(const h of o)e.add(h);n&a(X,j).fullScreen&&a(this,Ke).set(s,n&~a(X,j).fullScreen)}return t}};j=new WeakMap,ji=new WeakMap,Ke=new WeakMap,Qi=new WeakSet,rn=function(e){e.preventDefault();for(const t of e.changedTouches)if(e.type==="touchmove"){let s=0;for(const{elements:n,bitMask:r,requiresStart:o}of a(this,ji))!o&&u(this,ca,Ul).call(this,n,t,r)&&(s|=r);a(this,Ke).set(t.identifier,s)}else if(e.type==="touchstart"){let s=0;for(const{elements:n,bitMask:r,events:o}of a(this,ji))u(this,ca,Ul).call(this,n,t,r)&&(s|=r);a(this,Ke).set(t.identifier,s)}else(e.type==="touchend"||e.type==="touchcancel")&&a(this,Ke).delete(t.identifier)},ca=new WeakSet,Ul=function(e,t,s){for(const n of e){const r=n.getBoundingClientRect();if(t.clientX>=r.left-(s&a(X,j).left?r.width:0)&&t.clientX<=r.right+(s&a(X,j).right?r.width:0)&&t.clientY>=r.top-(s&a(X,j).up?r.height:0)&&t.clientY<=r.bottom+(s&a(X,j).down?r.height:0))return!0}return!1},d(X,j,{up:256,down:128,left:64,right:32,a:16,b:8,menu:4,muteUnmute:2,fullScreen:1});let Pl=X;var da,Us;class cp{constructor(e){b(this,"gameInputsSpecialized");b(this,"gameInputGamepad");b(this,"gameButtons");b(this,"buttonFullScreen");b(this,"buttonMuteUnmute");b(this,"buttonDebugToggle");b(this,"buttonFrameByFrameToggle");b(this,"buttonFrameByFrameStep");d(this,da,new Set);d(this,Us,new Set);this.gameInputGamepad=new up({browserType:e.browserType}),this.gameInputsSpecialized=[new Dl,new fp({enableDebugToggle:e.enableDebugToggle,enableFrameByFrameControls:e.enableFrameByFrameControls}),new Pl,this.gameInputGamepad],this.gameButtons=new hp,this.buttonFullScreen=new zt,this.buttonMuteUnmute=new zt,this.buttonDebugToggle=new zt,this.buttonFrameByFrameToggle=new zt,this.buttonFrameByFrameStep=new zt}startListening(){for(const e of this.gameInputsSpecialized)e.startListening()}update(e){a(this,Us).clear();const t=new Set;for(const s of this.gameInputsSpecialized)s.update(t)&&a(this,Us).add(s.inputMethod);return _(this,da,t),e.skipGameButtons||this.gameButtons.update(t),this.buttonFullScreen.update(t.has("full_screen")),this.buttonMuteUnmute.update(t.has("mute_unmute_toggle")),this.buttonDebugToggle.update(t.has("debug_toggle")),this.buttonFrameByFrameToggle.update(t.has("frame_by_frame_toggle")),this.buttonFrameByFrameStep.update(t.has("frame_by_frame_step")),$.updatePressedClasses({up:this.gameButtons.isPressed("up"),down:this.gameButtons.isPressed("down"),left:this.gameButtons.isPressed("left"),right:this.gameButtons.isPressed("right"),a:this.gameButtons.isPressed("a"),b:this.gameButtons.isPressed("b"),menu:this.gameButtons.isPressed("menu"),mute:this.buttonMuteUnmute.isPressed,fullscreen:this.buttonFullScreen.isPressed}),t.size>0}getRecentInputMethods(){return a(this,Us)}getConnectedGamepadTypes(){return this.gameInputGamepad.connectedGamepadTypes()}getEventsCapturedInLastUpdate(){return a(this,da)}}da=new WeakMap,Us=new WeakMap;var Vi,pa,ts,Is,es,We,zs,_a,Ns;const wr=class wr{constructor(e){d(this,Vi,void 0);d(this,pa,void 0);d(this,ts,{updateFn:()=>{},renderFn:()=>{}});d(this,Is,void 0);d(this,es,void 0);d(this,We,0);d(this,zs,0);d(this,_a,5);d(this,Ns,e=>{if(a(this,pa).visibilityState==="hidden"){_(this,es,e),a(this,Vi).call(this,a(this,Ns));return}const t=e-(a(this,es)??e);for(_(this,We,a(this,We)+t),_(this,es,e),_(this,zs,0);a(this,We)>=a(this,Is);)_(this,zs,a(this,zs)+1),a(this,zs)<=a(this,_a)?(a(this,ts).updateFn(),_(this,We,a(this,We)-a(this,Is))):(_(this,We,0),L.warnBeetPx(`Reached the safety limit of ${a(this,_a)} update calls`));const s=Math.floor(Math.min(1e3/t,wr.renderFpsResultCap));a(this,ts).renderFn(s),a(this,Vi).call(this,a(this,Ns))});_(this,Vi,e.rafFn),_(this,pa,e.documentVisibilityStateProvider),_(this,Is,1e3/e.fixedTimestepFps)}start(e){a(this,ts).updateFn=e.updateFn,a(this,ts).renderFn=e.renderFn,_(this,es,void 0),_(this,We,0),a(this,Vi).call(this,a(this,Ns))}};Vi=new WeakMap,pa=new WeakMap,ts=new WeakMap,Is=new WeakMap,es=new WeakMap,We=new WeakMap,zs=new WeakMap,_a=new WeakMap,Ns=new WeakMap,b(wr,"renderFpsResultCap",999);let Il=wr;var ga;const pn=class pn{isFullScreenSupported(){return a(pn,ga)}static create(){return a(pn,ga)?new pp:new dp}};ga=new WeakMap,d(pn,ga,!!(!(typeof document>"u")&&(document.fullscreenEnabled||document.webkitFullscreenEnabled)));let En=pn;class dp extends En{constructor(){super(),document.querySelectorAll($.selectors.controlsFullScreen).forEach(e=>{e.style.display="none"})}isInFullScreen(){return!1}toggleFullScreen(){}}var is,ma,ba,yr,vu,vr,xu;class pp extends En{constructor(){super();d(this,yr);d(this,vr);d(this,is,void 0);d(this,ma,void 0);d(this,ba,void 0);const t=document.querySelector($.selectors.fullScreenSubject);if(!t)throw Error(`Was unable to find a full screen subject by selector '${$.selectors.fullScreenSubject}'`);_(this,is,t);const s=a(this,is).requestFullscreen??a(this,is).webkitRequestFullscreen??(()=>{});_(this,ma,s.bind(a(this,is)));const n=document.exitFullscreen??document.webkitExitFullscreen??(()=>{});_(this,ba,n.bind(document))}isInFullScreen(){return!!(document.fullscreenElement||document.webkitFullscreenElement)}toggleFullScreen(){this.isInFullScreen()?u(this,vr,xu).call(this):u(this,yr,vu).call(this)}}is=new WeakMap,ma=new WeakMap,ba=new WeakMap,yr=new WeakSet,vu=function(){const t=a(this,ma).call(this);typeof t=="object"&&t.catch(s=>{L.errorBeetPx(s)})},vr=new WeakSet,xu=function(){const t=a(this,ba).call(this);typeof t=="object"&&t.catch(s=>{L.errorBeetPx(s)})};function Au(i){return new Promise(e=>{setTimeout(()=>e(),i)})}var xr,Bs,wa;class _p{constructor(e){d(this,xr,Au(750));d(this,Bs,void 0);d(this,wa,void 0);_(this,Bs,document.querySelector($.selectors.startButton)??as(`Unable to find a start button under a selector "${$.selectors.startButton}"`)),_(this,wa,new Promise(t=>{a(this,Bs).addEventListener("click",()=>{e.onStartClicked(),t()})}))}async showStartScreen(){await a(this,xr),$.addLoadedClass(),a(this,Bs).focus(),await a(this,wa),$.addStartedClass()}}xr=new WeakMap,Bs=new WeakMap,wa=new WeakMap;var qe,Ls,ke;const wi=class wi{static enable(){_(this,qe,!0)}static get isActive(){return a(this,qe)?a(this,ke):!1}static get wasJustActivated(){return a(this,qe)?a(this,ke)&&!a(this,Ls):!1}static get wasJustDeactivated(){return a(this,qe)?!a(this,ke)&&a(this,Ls):!1}static update(){if(a(this,qe)){if(wi.wasJustActivated){for(const e of Et.playbacksToPauseOnGamePause)e.pauseByEngine();for(const e of Et.playbacksToMuteOnGamePause)e.muteByEngine()}else if(wi.wasJustDeactivated){for(const e of Et.playbacksToPauseOnGamePause)e.resumeByEngine();for(const e of Et.playbacksToMuteOnGamePause)e.unmuteByEngine()}_(this,Ls,a(this,ke))}}static activate(){_(this,ke,!0)}static deactivate(){_(this,ke,!1)}};qe=new WeakMap,Ls=new WeakMap,ke=new WeakMap,d(wi,qe,!1),d(wi,Ls,!1),d(wi,ke,!1);let kt=wi;var $s;const ds=class ds{savePersistedState(e){window.localStorage.setItem(a(ds,$s),JSON.stringify(e,null,2))}loadPersistedState(){const e=window.localStorage.getItem(a(ds,$s));return e?JSON.parse(e):null}clearPersistedState(){window.localStorage.removeItem(a(ds,$s))}};$s=new WeakMap,d(ds,$s,"game_stored_state");let zl=ds;var Ye,Gs,Ar,ya,va,xa,Zs,Aa,ka,Hs,Sa,Ea,le,Se,Ca,Ta,Js,kr,ku;class gp{constructor(e={}){d(this,kr);d(this,Ye,void 0);d(this,Gs,void 0);b(this,"canvasSize");d(this,Ar,tt.fromCssHex("#000000"));d(this,ya,void 0);b(this,"gameInput");d(this,va,void 0);b(this,"audioApi");b(this,"fullScreen");b(this,"storageApi");d(this,xa,void 0);b(this,"assets");d(this,Zs,void 0);b(this,"drawApi");d(this,Aa,void 0);d(this,ka,!1);b(this,"isInsideDrawOrStartedCallback",!1);d(this,Hs,void 0);d(this,Sa,void 0);d(this,Ea,void 0);d(this,le,0);d(this,Se,0);d(this,Ca,1);d(this,Ta,!1);d(this,Js,!1);var r,o,h,c,l,f,m,g;e.canvasSize??(e.canvasSize="128x128"),e.fixedTimestep??(e.fixedTimestep="60fps"),window.addEventListener("error",p=>{var y;return $.showError(p.message),(y=this.audioApi)==null||y.getAudioContext().suspend().then(()=>{}),!0}),window.addEventListener("unhandledrejection",p=>{var y;$.showError(p.reason),(y=this.audioApi)==null||y.getAudioContext().suspend().then(()=>{})}),(r=e.globalPause)!=null&&r.available&&kt.enable(),Qt.loadFromStorage(),(o=e.debugMode)!=null&&o.available?e.debugMode.forceEnabledOnStart&&(Qt.enabled=!0):Qt.enabled=!1,(h=e.frameByFrame)!=null&&h.available&&((c=e.frameByFrame)!=null&&c.activateOnStart)&&(oi.active=!0),L.debugBeetPx("Engine init params:",e),_(this,Ye,e.assets??[]),a(this,Ye).push(...to.spriteSheetUrls),a(this,Ye).push(...q0.spriteSheetUrls),a(this,Ye).push(...Y0.spriteSheetUrls);const t=e.fixedTimestep==="60fps"?60:e.fixedTimestep==="30fps"?30:as(`Unsupported fixedTimestep: "${e.fixedTimestep}"`);_(this,Gs,H0.detect(navigator.userAgent)),this.canvasSize=e.canvasSize==="64x64"?k(64,64):e.canvasSize==="128x128"?k(128,128):e.canvasSize==="256x256"?k(256,256):as(`Unsupported canvasSize: "${e.canvasSize}"`),this.gameInput=new cp({enableDebugToggle:((l=e.debugMode)==null?void 0:l.available)??!1,enableFrameByFrameControls:((f=e.frameByFrame)==null?void 0:f.available)??!1,browserType:a(this,Gs)}),_(this,va,new Il({fixedTimestepFps:t,rafFn:window.requestAnimationFrame.bind(window),documentVisibilityStateProvider:document})),this.storageApi=new zl;const s=new AudioContext;this.assets=new Td,_(this,xa,new Cd(this.assets,{decodeAudioData:p=>s.decodeAudioData(p)})),this.audioApi=new ki(this.assets,s),_(this,ya,new _p({onStartClicked:()=>{this.audioApi.tryToResumeAudioContextSuspendedByBrowserForSecurityReasons().then(p=>{p&&_(this,Js,!0)})}})),this.fullScreen=En.create();const n=document.querySelector($.selectors.canvas)??as(`Was unable to find <canvas> by selector '${$.selectors.canvas}'`);_(this,Zs,new W0(this.canvasSize,n,a(this,Ar))),this.drawApi=new op({canvas:a(this,Zs),assets:this.assets}),(g=(m=e.debugMode)==null?void 0:m.fpsDisplay)!=null&&g.enabled&&_(this,Aa,new tp(this.drawApi,this.canvasSize,{color:e.debugMode.fpsDisplay.color,placement:e.debugMode.fpsDisplay.placement}))}get frameNumber(){return a(this,le)}get frameNumberOutsidePause(){return a(this,Se)}get renderingFps(){return a(this,Ca)}get detectedBrowserType(){return a(this,Gs)}async init(){return await a(this,xa).loadAssets(a(this,Ye)),{startGame:u(this,kr,ku).bind(this)}}setOnStarted(e){_(this,Hs,e)}setOnUpdate(e){_(this,Sa,e)}setOnDraw(e){_(this,Ea,e)}restart(){var e;_(this,le,0),_(this,Se,0),this.audioApi.restart(),this.drawApi.clearCanvas(X0),Et.playbacksToPauseOnGamePause.clear(),Et.playbacksToMuteOnGamePause.clear(),kt.deactivate(),this.isInsideDrawOrStartedCallback=!0,(e=a(this,Hs))==null||e.call(this),this.isInsideDrawOrStartedCallback=!1}}Ye=new WeakMap,Gs=new WeakMap,Ar=new WeakMap,ya=new WeakMap,va=new WeakMap,xa=new WeakMap,Zs=new WeakMap,Aa=new WeakMap,ka=new WeakMap,Hs=new WeakMap,Sa=new WeakMap,Ea=new WeakMap,le=new WeakMap,Se=new WeakMap,Ca=new WeakMap,Ta=new WeakMap,Js=new WeakMap,kr=new WeakSet,ku=async function(){var e;if(a(this,ka))throw Error("Tried to start a game, but it is already started");_(this,ka,!0),window.BEETPX__IS_PROD&&window.addEventListener("beforeunload",t=>(t.preventDefault(),t.returnValue="","")),_(this,le,0),_(this,Se,0),await a(this,ya).showStartScreen(),this.isInsideDrawOrStartedCallback=!0,(e=a(this,Hs))==null||e.call(this),this.isInsideDrawOrStartedCallback=!1,this.gameInput.startListening(),a(this,va).start({updateFn:()=>{var n;this.gameInput.buttonFullScreen.wasJustPressed&&this.fullScreen.toggleFullScreen(),this.gameInput.buttonMuteUnmute.wasJustPressed&&(this.audioApi.isAudioMuted()?this.audioApi.unmuteAudio():this.audioApi.muteAudio()),this.gameInput.gameButtons.wasJustPressed("menu")&&(kt.isActive?kt.deactivate():kt.activate()),kt.update(),this.gameInput.buttonDebugToggle.wasJustPressed&&(Qt.enabled=!Qt.enabled),this.gameInput.buttonFrameByFrameToggle.wasJustPressed&&(oi.active=!oi.active);const t=!oi.active||this.gameInput.buttonFrameByFrameStep.wasJustPressed;this.gameInput.update({skipGameButtons:!t})&&!a(this,Js)&&this.audioApi.tryToResumeAudioContextSuspendedByBrowserForSecurityReasons().then(r=>{r&&_(this,Js,!0)}),t&&(oi.active&&L.infoBeetPx(`Running onUpdate for frame: ${a(this,le)}`),(n=a(this,Sa))==null||n.call(this),_(this,Ta,!0),_(this,le,a(this,le)>=Number.MAX_SAFE_INTEGER?0:a(this,le)+1),kt.isActive||_(this,Se,a(this,Se)>=Number.MAX_SAFE_INTEGER?0:a(this,Se)+1))},renderFn:t=>{var s,n;_(this,Ca,t),this.isInsideDrawOrStartedCallback=!0,a(this,Ta)&&((s=a(this,Ea))==null||s.call(this),Qt.enabled&&((n=a(this,Aa))==null||n.drawRenderingFps(t))),this.isInsideDrawOrStartedCallback=!1,a(this,Zs).render()}})};function mp(i,e){return i>0?((e==null?void 0:e.onGamePause)==="ignore"?Rt.frameNumber:Rt.frameNumberOutsidePause)%(i*2)<i:!0}function Su(){return[U.of(-1,-1),U.of(0,-1),U.of(1,-1),U.of(1,0),U.of(1,1),U.of(0,1),U.of(-1,1),U.of(-1,0)]}function bp(i,e,t,s,n){for(const r of Su())Rt.draw.text(i,e.add(r),s,{centerXy:n==null?void 0:n.centerXy,scaleXy:n==null?void 0:n.scaleXy});Rt.draw.text(i,e,t,{centerXy:n==null?void 0:n.centerXy,scaleXy:n==null?void 0:n.scaleXy})}function wp(){return[U.of(-1,-1),U.of(1,-1),U.of(1,1),U.of(-1,1)]}function yp(i){if(!(i.length<=0))return i[Math.floor(Math.random()*i.length)]}function vp(i,e){i=i>0?Math.round(i):0;const t=new Array(i*e.length);for(let s=0;s<t.length;s++)t[s]=e[Math.floor(s/i)];return t}var Xe,M,F;const w=class w{static async init(e){L.infoBeetPx(`BeetPx ${window.BEETPX__VERSION} : Initializing…`),_(this,Xe,new gp(e));const{startGame:t}=await a(this,Xe).init();return L.infoBeetPx(`BeetPx ${window.BEETPX__VERSION} : Initialized`),{startGame:t}}static get debug(){return Qt.enabled}static get canvasSize(){return u(this,M,F).call(this).canvasSize}static get frameNumber(){return u(this,M,F).call(this).frameNumber}static get frameNumberOutsidePause(){return u(this,M,F).call(this).frameNumberOutsidePause}static get renderingFps(){return u(this,M,F).call(this).renderingFps}static get detectedBrowserType(){return u(this,M,F).call(this).detectedBrowserType}static get isPaused(){return kt.isActive}static get wasJustPaused(){return kt.wasJustActivated}static get wasJustResumed(){return kt.wasJustDeactivated}static pause(){kt.activate()}static resume(){kt.deactivate()}};Xe=new WeakMap,M=new WeakSet,F=function(e){if(!a(this,Xe))throw Error("Tried to access BeetPx API without calling BeetPx.init(…) first.");return e&&!a(this,Xe).isInsideDrawOrStartedCallback&&L.warnBeetPx(`Used "${e}" outside of either "setOnDraw" or "setOnStarted" callback.`),a(this,Xe)},d(w,M),d(w,Xe,void 0),b(w,"setOnStarted",(...e)=>{var t;return u(t=w,M,F).call(t).setOnStarted(...e)}),b(w,"setOnUpdate",(...e)=>{var t;return u(t=w,M,F).call(t).setOnUpdate(...e)}),b(w,"setOnDraw",(...e)=>{var t;return u(t=w,M,F).call(t).setOnDraw(...e)}),b(w,"restart",(...e)=>{var t;return u(t=w,M,F).call(t).restart(...e)}),b(w,"logDebug",(...e)=>L.debug(...e)),b(w,"logInfo",(...e)=>L.info(...e)),b(w,"logWarn",(...e)=>L.warn(...e)),b(w,"logError",(...e)=>L.error(...e)),b(w,"wasAnyButtonJustPressed",(...e)=>{var t;return u(t=w,M,F).call(t).gameInput.gameButtons.wasAnyJustPressed(...e)}),b(w,"wasButtonJustPressed",(...e)=>{var t;return u(t=w,M,F).call(t).gameInput.gameButtons.wasJustPressed(...e)}),b(w,"wasButtonJustReleased",(...e)=>{var t;return u(t=w,M,F).call(t).gameInput.gameButtons.wasJustReleased(...e)}),b(w,"isAnyButtonPressed",(...e)=>{var t;return u(t=w,M,F).call(t).gameInput.gameButtons.isAnyPressed(...e)}),b(w,"isButtonPressed",(...e)=>{var t;return u(t=w,M,F).call(t).gameInput.gameButtons.isPressed(...e)}),b(w,"getPressedDirection",(...e)=>{var t;return u(t=w,M,F).call(t).gameInput.gameButtons.getPressedDirection(...e)}),b(w,"setButtonRepeating",(...e)=>{var t;return u(t=w,M,F).call(t).gameInput.gameButtons.setButtonRepeating(...e)}),b(w,"getRecentInputMethods",(...e)=>{var t;return u(t=w,M,F).call(t).gameInput.getRecentInputMethods(...e)}),b(w,"getConnectedGamepadTypes",(...e)=>{var t;return u(t=w,M,F).call(t).gameInput.getConnectedGamepadTypes(...e)}),b(w,"getEventsCapturedInLastUpdate",(...e)=>{var t;return u(t=w,M,F).call(t).gameInput.getEventsCapturedInLastUpdate(...e)}),b(w,"isAudioMuted",(...e)=>{var t;return u(t=w,M,F).call(t).audioApi.isAudioMuted(...e)}),b(w,"muteAudio",(...e)=>{var t;return u(t=w,M,F).call(t).audioApi.muteAudio(...e)}),b(w,"unmuteAudio",(...e)=>{var t;return u(t=w,M,F).call(t).audioApi.unmuteAudio(...e)}),b(w,"startPlayback",(...e)=>{var t;return u(t=w,M,F).call(t).audioApi.startPlayback(...e)}),b(w,"startPlaybackLooped",(...e)=>{var t;return u(t=w,M,F).call(t).audioApi.startPlaybackLooped(...e)}),b(w,"startPlaybackSequence",(...e)=>{var t;return u(t=w,M,F).call(t).audioApi.startPlaybackSequence(...e)}),b(w,"mutePlayback",(...e)=>{var t;return u(t=w,M,F).call(t).audioApi.mutePlayback(...e)}),b(w,"unmutePlayback",(...e)=>{var t;return u(t=w,M,F).call(t).audioApi.unmutePlayback(...e)}),b(w,"stopPlayback",(...e)=>{var t;return u(t=w,M,F).call(t).audioApi.stopPlayback(...e)}),b(w,"pausePlayback",(...e)=>{var t;return u(t=w,M,F).call(t).audioApi.pausePlayback(...e)}),b(w,"resumePlayback",(...e)=>{var t;return u(t=w,M,F).call(t).audioApi.resumePlayback(...e)}),b(w,"getAudioContext",(...e)=>{var t;return u(t=w,M,F).call(t).audioApi.getAudioContext(...e)}),b(w,"isFullScreenSupported",(...e)=>{var t;return u(t=w,M,F).call(t).fullScreen.isFullScreenSupported(...e)}),b(w,"isInFullScreen",(...e)=>{var t;return u(t=w,M,F).call(t).fullScreen.isInFullScreen(...e)}),b(w,"toggleFullScreen",(...e)=>{var t;return u(t=w,M,F).call(t).fullScreen.toggleFullScreen(...e)}),b(w,"savePersistedState",(...e)=>{var t;return u(t=w,M,F).call(t).storageApi.savePersistedState(...e)}),b(w,"loadPersistedState",(...e)=>{var t;return u(t=w,M,F).call(t).storageApi.loadPersistedState(...e)}),b(w,"clearPersistedState",(...e)=>{var t;return u(t=w,M,F).call(t).storageApi.clearPersistedState(...e)}),b(w,"getImageAsset",(...e)=>{var t;return u(t=w,M,F).call(t).assets.getImageAsset(...e)}),b(w,"getSoundAsset",(...e)=>{var t;return u(t=w,M,F).call(t).assets.getSoundAsset(...e)}),b(w,"getJsonAsset",(...e)=>{var t;return u(t=w,M,F).call(t).assets.getJsonAsset(...e)}),b(w,"draw",{clearCanvas(e){var t;u(t=w,M,F).call(t,"clearCanvas").drawApi.clearCanvas(e)},setClippingRegion(e,t){var s;return u(s=w,M,F).call(s,"setClippingRegion").drawApi.setClippingRegion(e,t)},removeClippingRegion(){var e;return u(e=w,M,F).call(e,"removeClippingRegion").drawApi.removeClippingRegion()},setCameraXy(e){var t;return u(t=w,M,F).call(t,"setCameraXy").drawApi.setCameraXy(e)},setDrawingPattern(e){var t;return u(t=w,M,F).call(t,"setDrawingPattern").drawApi.setDrawingPattern(e)},pixel(e,t){var s;u(s=w,M,F).call(s,"pixel").drawApi.drawPixel(e,t)},pixels(e,t,s,n){var r;u(r=w,M,F).call(r,"pixels").drawApi.drawPixels(e,t,s,n)},line(e,t,s){var n;u(n=w,M,F).call(n,"line").drawApi.drawLine(e,t,s)},rect(e,t,s){var n;u(n=w,M,F).call(n,"rect").drawApi.drawRect(e,t,s)},rectFilled(e,t,s){var n;u(n=w,M,F).call(n,"rectFilled").drawApi.drawRectFilled(e,t,s)},rectOutsideFilled(e,t,s){var n;u(n=w,M,F).call(n,"rectOutsideFilled").drawApi.drawRectOutsideFilled(e,t,s)},ellipse(e,t,s){var n;u(n=w,M,F).call(n,"ellipse").drawApi.drawEllipse(e,t,s)},ellipseFilled(e,t,s){var n;u(n=w,M,F).call(n,"ellipseFilled").drawApi.drawEllipseFilled(e,t,s)},ellipseOutsideFilled(e,t,s){var n;u(n=w,M,F).call(n,"ellipseOutsideFilled").drawApi.drawEllipseOutsideFilled(e,t,s)},setSpriteColorMapping(e){var t;return u(t=w,M,F).call(t,"setSpriteColorMapping").drawApi.setSpriteColorMapping(e)},sprite(e,t,s){var n;u(n=w,M,F).call(n,"sprite").drawApi.drawSprite(e,t,s)},useFont(e){var t;return u(t=w,M,F).call(t,"useFont").drawApi.useFont(e)},setTextColorMarkers(e){var t;return u(t=w,M,F).call(t,"setTextColorMarkers").drawApi.setTextColorMarkers(e)},measureText(e,t){var s;return u(s=w,M,F).call(s,"measureText").drawApi.measureText(e,t)},text(e,t,s,n){var r;u(r=w,M,F).call(r,"text").drawApi.drawText(e,t,s,n)},takeCanvasSnapshot(){var e;u(e=w,M,F).call(e,"takeCanvasSnapshot").drawApi.takeCanvasSnapshot()}}),b(w,"utils",{assertUnreachable:Nl,booleanChangingEveryNthFrame:mp,clamp:Ks,drawTextWithOutline:bp,identity:Bl,isDefined:wu,lerp:Vr,mod:yi,noop:pl,offset4Directions:wp,offset8Directions:Su,randomElementOf:yp,range:tr,repeatEachElement:vp,throwError:as,trigAtan2:lh,trigCos:oh,trigSin:hh,wait:Au});let Rt=w;const Bt=Rt,T=Rt.draw,Re=Rt.utils;var Ut,ss,Ra,Ee,ns,Ce,je,fs,oe,Me;const io=class io{constructor(e){d(this,je);d(this,oe);d(this,Ut,void 0);d(this,ss,void 0);d(this,Ra,void 0);d(this,Ee,void 0);d(this,ns,void 0);d(this,Ce,void 0);_(this,Ra,e.onGamePause==="ignore"),_(this,Ut,Math.max(0,Math.round(e.frames))),_(this,ss,e.loop),_(this,ns,a(this,je,fs)+e.delayFrames),_(this,Ee,!1),_(this,Ce,null),e.pause&&this.pause()}static for(e){return new io(e)}get t(){return a(this,ss)?a(this,oe,Me)>=0?yi(a(this,oe,Me),a(this,Ut)):0:Ks(0,a(this,oe,Me),a(this,Ut))}get framesLeft(){return a(this,Ut)-this.t}get progress(){return a(this,Ut)>0?this.t/a(this,Ut):1}get hasFinished(){return a(this,oe,Me)>=a(this,Ut)}get hasJustFinished(){return a(this,Ut)>0?a(this,ss)?a(this,oe,Me)>0&&this.t===0:a(this,oe,Me)===a(this,Ut):a(this,ss)?!0:a(this,oe,Me)===0}pause(){a(this,Ee)||(_(this,Ee,!0),_(this,Ce,a(this,je,fs)))}resume(){a(this,Ee)&&(_(this,Ee,!1),_(this,ns,a(this,ns)+(a(this,je,fs)-(a(this,Ce)??0))),_(this,Ce,null))}restart(){_(this,ns,a(this,je,fs)),_(this,Ce,null),_(this,Ee,!1)}};Ut=new WeakMap,ss=new WeakMap,Ra=new WeakMap,Ee=new WeakMap,ns=new WeakMap,Ce=new WeakMap,je=new WeakSet,fs=function(){return a(this,Ra)?Rt.frameNumber:Rt.frameNumberOutsidePause},oe=new WeakSet,Me=function(){return(a(this,Ce)??a(this,je,fs))-a(this,ns)};let cn=io;const Ka=st("#ffa300"),Wa=st("#29adff"),qa=st("#00e436"),xp=st("#ff77a8");class Ap{constructor(){b(this,"gamepadsN",3);b(this,"gamepadTypes",Re.range(this.gamepadsN).map(()=>null));b(this,"buttonsN",20);b(this,"buttons",Re.range(this.buttonsN).map(()=>Re.range(this.gamepadsN).map(()=>null)));b(this,"axesN",7);b(this,"axes",Re.range(this.axesN).map(()=>Re.range(this.gamepadsN).map(()=>null)));document.addEventListener("keydown",e=>{console.table({table:"KEYBOARD EVENT",type:"keydown",code:e.code,ctrlKey:e.ctrlKey,isComposing:e.isComposing,key:e.key,location:e.location,metaKey:e.metaKey,repeat:e.repeat,shiftKey:e.shiftKey})}),document.addEventListener("keyup",e=>{console.table({table:"KEYBOARD EVENT",type:"keyup",code:e.code,ctrlKey:e.ctrlKey,isComposing:e.isComposing,key:e.key,location:e.location,metaKey:e.metaKey,repeat:e.repeat,shiftKey:e.shiftKey})}),window.addEventListener("gamepadconnected",e=>{e.gamepad.index<this.gamepadsN&&(this.gamepadTypes[e.gamepad.index]=el.detect(e.gamepad)),console.table({table:"GAMEPAD EVENT",type:"gamepadconnected",id:e.gamepad.id,index:e.gamepad.index,connected:e.gamepad.connected,"#axes":e.gamepad.axes.length,"#buttons":e.gamepad.buttons.length,timestamp:e.gamepad.timestamp})}),window.addEventListener("gamepaddisconnected",e=>{e.gamepad.index<this.gamepadsN&&(this.gamepadTypes[e.gamepad.index]=null),console.table({table:"GAMEPAD EVENT",type:"gamepaddisconnected",id:e.gamepad.id,index:e.gamepad.index,connected:e.gamepad.connected,"#axes":e.gamepad.axes.length,"#buttons":e.gamepad.buttons.length,timestamp:e.gamepad.timestamp})})}update(){navigator.getGamepads().forEach(e=>{e&&e.index<this.gamepadsN&&(Re.range(this.buttonsN).forEach(t=>{var s,n;this.buttons[t][e.index]=(s=e.buttons[t])!=null&&s.pressed?"pressed":(n=e.buttons[t])!=null&&n.touched?"touched":null}),Re.range(this.axesN).forEach(t=>{this.axes[t][e.index]=e.axes[t]??null}))})}draw(){T.sprite(_u("spritesheet.png")(128,128,160,0),It),this.buttons.forEach((e,t)=>{e.forEach((s,n)=>{s==="pressed"?T.rectFilled(k(17+t%10*10,12+Math.floor(t/10)*20+n*3),k(3,3),n===0?Ka:n===1?Wa:qa):s==="touched"&&T.ellipseFilled(k(17+t%10*10,12+Math.floor(t/10)*20+n*3),k(3,3),n===0?Ka:n===1?Wa:qa)})}),this.axes.forEach((e,t)=>{e.forEach((s,n)=>{if(s!=null){const r=20*s;T.rectFilled(k(48+r,51+t*11+n*3),k(3,3),n===0?Ka:n===1?Wa:qa)}})}),Re.range(this.gamepadsN).forEach(e=>{const t=this.gamepadTypes[e];t&&T.rectFilled(k(97+(t==="xbox"?0:t==="dualsense"?10:20),61+e*3),k(3,3),e===0?Ka:e===1?Wa:qa)}),T.rectFilled(k(117,78+(Bt.detectedBrowserType==="chromium"?0:Bt.detectedBrowserType==="safari"?10:Bt.detectedBrowserType==="firefox_windows"?20:Bt.detectedBrowserType==="firefox_other"?30:40)),k(3,3),xp)}}const z=_u("spritesheet.png"),kp=st("#a8e72e"),Sp=st("#ff77a8"),Ep=st("#f3ef7d"),Cp=st("#125359"),Tp=st("#1d2b53"),Rp=st("#c2c3c7"),Mp=st("#83769c");class Fp{constructor(){b(this,"ps",{k_w:z(5,6,128,0),k_s:z(5,6,136,0),k_up:z(5,6,144,0),k_down:z(5,6,152,0),k_a:z(5,6,128,8),k_d:z(5,6,136,8),k_left:z(5,6,144,8),k_right:z(5,6,152,8),k_c:z(5,6,128,16),k_j:z(5,6,136,16),g_a:z(5,6,144,16),g_y:z(5,6,152,16),k_x:z(5,6,128,24),k_k:z(5,6,136,24),g_b:z(5,6,144,24),g_x:z(5,6,152,24),k_p:z(5,6,144,32),k_esc:z(13,6,128,32),k_enter:z(8,10,149,30),k_m:z(5,6,128,40),k_f:z(5,6,136,40),k_semicolon:z(5,6,152,40),g_dualsense_cross:z(5,6,128,48),g_dualsense_triangle:z(5,6,136,48),g_xbox_menu:z(5,6,144,48),k_coma:z(5,6,152,48),g_dualsense_circle:z(5,6,128,56),g_dualsense_square:z(5,6,136,56),g_ps_menu:z(5,6,144,56),k_period:z(5,6,152,56),g_dpad_left:z(15,16,128,64),g_dpad_right:z(15,16,144,64),g_dpad_up:z(15,16,128,80),g_dpad_down:z(15,16,144,80),g_dpad_up_left:z(15,16,128,96),g_dpad_up_right:z(15,16,144,96),g_dpad_down_left:z(15,16,128,112),g_dpad_down_right:z(15,16,144,112),g_stick_left:z(13,14,288,0),g_stick_right:z(13,14,304,0),g_stick_up:z(13,14,288,16),g_stick_down:z(13,14,304,16),g_stick_up_left:z(13,14,288,32),g_stick_up_right:z(13,14,304,32),g_stick_down_left:z(13,14,288,48),g_stick_down_right:z(13,14,304,48)});b(this,"ip",{up:!1,down:!1,left:!1,right:!1,a:!1,b:!1,menu:!1,muteUnmute:!1,fullScreen:!1,debugToggle:!1,frameByFrameToggle:!1,frameByFrameStep:!1});b(this,"highlightKeyboard",!0)}update(){const{ip:e}=this,t=Bt.getEventsCapturedInLastUpdate();e.up=t.has("button_up"),e.down=t.has("button_down"),e.left=t.has("button_left"),e.right=t.has("button_right"),e.a=t.has("button_a"),e.b=t.has("button_b"),e.menu=t.has("button_menu"),e.muteUnmute=t.has("mute_unmute_toggle"),e.fullScreen=t.has("full_screen"),e.debugToggle=t.has("debug_toggle"),e.frameByFrameToggle=t.has("frame_by_frame_toggle"),e.frameByFrameStep=t.has("frame_by_frame_step"),Bt.getRecentInputMethods().has("keyboard")?this.highlightKeyboard=!0:Bt.getRecentInputMethods().has("gamepad")&&(this.highlightKeyboard=!1)}draw(){const{ip:e,ps:t}=this;T.sprite(z(128,128,0,0),It);let s=T.setSpriteColorMapping(this.highlightKeyboard?Qe.from([[Sp,Cp]]):Qe.from([[Ep,Tp]]));T.setClippingRegion(k(0,0),k(128,3)),T.sprite(z(128,128,0,0),It),T.setClippingRegion(k(126,0),k(126,128)),T.sprite(z(128,128,0,0),It),T.setClippingRegion(k(0,126),k(128,128)),T.sprite(z(128,128,0,0),It),T.setClippingRegion(k(0,0),k(2,128)),T.sprite(z(128,128,0,0),It),T.setClippingRegion(k(64,77),k(64,6)),T.sprite(z(128,128,0,0),It),T.setSpriteColorMapping(s),s=T.setSpriteColorMapping(Qe.from([[Rp,Mp]])),T.setClippingRegion(this.highlightKeyboard?k(110,3):k(3,3),k(15,11)),T.sprite(z(128,128,0,0),It),T.removeClippingRegion(),T.setSpriteColorMapping(s),s=T.setSpriteColorMapping(Qe.from([[kp,null]])),e.up&&(T.sprite(t.k_w,k(21,17)),T.sprite(t.k_up,k(47,17)),T.sprite(t.g_dpad_up,k(74,16)),T.sprite(t.g_stick_up,k(97,16))),e.down&&(T.sprite(t.k_s,k(22,24)),T.sprite(t.k_down,k(47,24)),T.sprite(t.g_dpad_down,k(74,16)),T.sprite(t.g_stick_down,k(97,16))),e.left&&(T.sprite(t.k_a,k(15,24)),T.sprite(t.k_left,k(40,24)),T.sprite(t.g_dpad_left,k(74,16)),T.sprite(t.g_stick_left,k(97,16))),e.right&&(T.sprite(t.k_d,k(29,24)),T.sprite(t.k_right,k(54,24)),T.sprite(t.g_dpad_right,k(74,16)),T.sprite(t.g_stick_right,k(97,16))),e.up&&e.left&&(T.sprite(t.g_dpad_up_left,k(74,16)),T.sprite(t.g_stick_up_left,k(97,16))),e.up&&e.right&&(T.sprite(t.g_dpad_up_right,k(74,16)),T.sprite(t.g_stick_up_right,k(97,16))),e.down&&e.left&&(T.sprite(t.g_dpad_down_left,k(74,16)),T.sprite(t.g_stick_down_left,k(97,16))),e.down&&e.right&&(T.sprite(t.g_dpad_down_right,k(74,16)),T.sprite(t.g_stick_down_right,k(97,16))),e.a&&(T.sprite(t.k_c,k(37,40)),T.sprite(t.k_j,k(49,40)),T.sprite(t.g_a,k(73,40)),T.sprite(t.g_y,k(84,40)),T.sprite(t.g_dualsense_cross,k(100,40)),T.sprite(t.g_dualsense_triangle,k(111,40))),e.b&&(T.sprite(t.k_x,k(37,51)),T.sprite(t.k_k,k(49,51)),T.sprite(t.g_b,k(73,51)),T.sprite(t.g_x,k(84,51)),T.sprite(t.g_dualsense_circle,k(100,51)),T.sprite(t.g_dualsense_square,k(111,51))),e.menu&&(T.sprite(t.k_p,k(6,65)),T.sprite(t.k_esc,k(16,65)),T.sprite(t.k_enter,k(34,61)),T.sprite(t.g_xbox_menu,k(84,65)),T.sprite(t.g_ps_menu,k(100,65))),e.muteUnmute&&T.sprite(t.k_m,k(5,85)),e.fullScreen&&T.sprite(t.k_f,k(5,95)),e.debugToggle&&T.sprite(t.k_semicolon,k(118,100)),e.frameByFrameToggle&&T.sprite(t.k_coma,k(118,110)),e.frameByFrameStep&&T.sprite(t.k_period,k(118,118)),T.setSpriteColorMapping(s)}}let ai=null,ri=null,sn=!1,jr=!1,Ya=!1;Bt.init({canvasSize:"128x128",fixedTimestep:"60fps",debugMode:{available:!0},assets:["spritesheet.png"]}).then(async({startGame:i})=>{Bt.setOnStarted(()=>{ai=new Fp,ri=new Ap,sn=!1,jr=!1,Ya=!1}),Bt.setOnUpdate(()=>{sn?ri==null||ri.update():ai==null||ai.update(),jr=Ya,Ya=Bt.getEventsCapturedInLastUpdate().has("debug_toggle"),jr&&!Ya&&(sn=!sn)}),Bt.setOnDraw(()=>{sn?ri==null||ri.draw():ai==null||ai.draw()}),await i()});
